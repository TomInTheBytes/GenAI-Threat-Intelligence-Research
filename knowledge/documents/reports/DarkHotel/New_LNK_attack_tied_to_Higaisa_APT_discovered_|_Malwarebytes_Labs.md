# Reference for threat actor for "DarkHotel"

**Title**: New LNK attack tied to Higaisa APT discovered | Malwarebytes Labs

**Source**: https://blog.malwarebytes.com/threat-analysis/2020/06/higaisa/

## Content











New LNK attack tied to Higaisa APT discovered | Malwarebytes Labs










































 




 








Skip to content





Search

Search Malwarebytes.com



Search for:








Contact Us

Personal Support
Business Support
Talk to Sales
Contact Press
Partner Programs
Submit Vulnerability


Company

About Malwarebytes
Careers
News & Press


Sign In

MyAccount sign in: manage your personal or Teams subscription >
Cloud Console sign in: manage your cloud business products >
Partner Portal sign in: management for Resellers and MSPs >


 














Personal


< Personal

ProductsMalwarebytes Premium >Malwarebytes Privacy VPN >Malwarebytes Identity Theft Protection >Malwarebytes Browser Guard >Malwarebytes for Teams/small offices >AdwCleaner for Windows >

Find the right productSee our plansInfected already?Clean your device now




SolutionsFree antivirus >Free virus scan & removal >Windows antivirus >Mac antivirus >Android antivirus >iOS security >Chromebook antivirus >
See personal pricingManage your subscriptionVisit our support page 





Business


< Business
BUNDLESCorePrevent and remediate threats and identify vulnerabilitiesAdvancedUtilize threat guidance and patch management plus everything in CoreEliteDeploy Managed Detection and Response plus everything in AdvancedUltimateProtect against categories of malicious websites plus everything in Elite


TECHNOLOGY HIGHLIGHTSManaged Detection & Response (MDR) Deploy fully-managed threat monitoring, investigation, and remediationEndpoint Detection & Response (EDR)Prevent more attacks with security that catches what others missSecurity AdvisorVisualize and optimize your security posture in just minutesFor EducationSecure your students and institution against cyberattacks







Learn more about Security Advisor (available in every bundle) and see the full list of our products and services.
Full technology list >




Pricing



< Pricing
Personal pricingProtect your personal devices and dataSmall office/home office pricingProtect your team’s devices and dataBusiness pricingExplore our award-winning endpoint security products, from EP to EDR to MDR




Partners



< Partners
Explore PartnershipsPartner SolutionsResellersManaged Service ProvidersComputer RepairTechnology PartnersAffiliate PartnersContact Us




Resources


< Resources
Learn About CybersecurityAntivirusMalwareRansomwareMalwarebytes Labs – BlogGlossaryThreat Center


Business ResourcesReviewsAnalyst ReportsCase StudiesPress & News


ReportsThe State of Malware 2023 ReportRead report



Support



< Support
Technical SupportPersonal SupportBusiness SupportPremium ServicesForumsVulnerability DisclosureReport a False Positive


Featured ContentActivate Malwarebytes Privacy on Windows device.See Content Product Videos



 

Free Download




Search
Search

Search Malwarebytes.com



Search for:









































SUBSCRIBE


rss

































 


News
						 | 						Threats

New LNK attack tied to Higaisa APT discovered 
Posted: June 4, 2020
 by Threat Intelligence Team 


This post was authored by Hossein Jazi and Jérôme Segura On May 29th, we identified an attack that we believe is part of a new campaign from an Advanced Persistent Threat actor known as Higaisa. The Higaisa APT is believed to be tied to the Korean peninsula, and was first disclosed by Tencent Security Threat Intelligence Center in early 2019.  The group’s activities go back to at least 2016 and include the use of Trojans such as Gh0st and PlugX, as well as mobile malware. Its targets include government officials and human rights organizations, as well as other entities related to North Korea. In this latest incident, Higaisa used a malicious shortcut file ultimately responsible for creating a multi-stage attack that consists of several malicious scripts, payloads and decoy PDF documents. Distribution The threat actors used a malicious LNK file bundled within an archive file which was most likely distributed via spear-phishing.  We were able to identify two variants of this campaign that possibly have been distributed between May 12th and 31st: “CV_Colliers.rar” “Project link and New copyright policy.rar”  Both RAR archives bundle two malicious LNK files. In the newer variant (CV_Colliers.rar), the LNK files are disguised as a Curriculum Vitae (CV) and International English Language Testing System (IELTS) exam results. The older one (Project link and New copyright policy.rar) seems to target product teams that are using zeplin.io. The following shows the overall process flow when executing the malicious LNK file.   IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address
 At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
    Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.  The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
  svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 JS file  The JavaScript file performs the following commands: Create “d3reEW.exe” in “C:UsersPublicDownloads” and store “cmd /c ipconfig” in it. Execute the dropped “svchast.exe”. Copy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.Add “officeupdate.exe” to scheduled tasks.Send a POST request to a hardcoded URL with “d3reEW.exe” as data.         svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
    JS file  The JavaScript file performs the following commands: Create “d3reEW.exe” in “C:UsersPublicDownloads” and store “cmd /c ipconfig” in it. Execute the dropped “svchast.exe”. Copy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.Add “officeupdate.exe” to scheduled tasks.Send a POST request to a hardcoded URL with “d3reEW.exe” as data.         svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 The list of commands executed by this LNK shortcut is the same as the one reported by Anomali on the Higasia Covid-19 campaign. The only difference is the name of the tmp files and name of certutil.exe which in this new case is “gosia.exe”, while in the March campaign the name was “mosia.exe”. Both LNK files embedded within the archive are executing similar commands with the different Command and Control (C&C) configurations. Running each of them would show a different decoy document.        JS file  The JavaScript file performs the following commands: Create “d3reEW.exe” in “C:UsersPublicDownloads” and store “cmd /c ipconfig” in it. Execute the dropped “svchast.exe”. Copy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.Add “officeupdate.exe” to scheduled tasks.Send a POST request to a hardcoded URL with “d3reEW.exe” as data.         svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 Copy content of the LNK file into “g4ZokyumB2DC4.tmp” in %APPDATA% temp directory. Copy content of “certutil.exe” into “gosia.exe” ( “*ertu*.exe is used to bypass security detection).Look for the base64 blob using “findstr.exe” and write it to “cSi1rouy4.tmp”.Decode content of “cSi1rouy4.tmp” using “gosia.exe -decode” (certutil.exe -decode) and write it to “o423DFDS4.tmp”. Decompress content of “o423DFDS4.tmp” in temp directory along with a decoy PDF document using “expand.exe  -F:*”  (Figure 3) .Copy “66DF3DFG.tmp” and “34fDKfSD38.js” files into “C:UsersPublicDownloads” directory.Execute the JS file by calling Wscript.Open the decoy document.    The list of commands executed by this LNK shortcut is the same as the one reported by Anomali on the Higasia Covid-19 campaign. The only difference is the name of the tmp files and name of certutil.exe which in this new case is “gosia.exe”, while in the March campaign the name was “mosia.exe”. Both LNK files embedded within the archive are executing similar commands with the different Command and Control (C&C) configurations. Running each of them would show a different decoy document.        JS file  The JavaScript file performs the following commands: Create “d3reEW.exe” in “C:UsersPublicDownloads” and store “cmd /c ipconfig” in it. Execute the dropped “svchast.exe”. Copy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.Add “officeupdate.exe” to scheduled tasks.Send a POST request to a hardcoded URL with “d3reEW.exe” as data.         svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 
 LNK file The LNK file contains a list of commands that will be executed upon running, and a blob that is a base64 encoded compressed payload. Here is the list of commands that will be executed:    Copy content of the LNK file into “g4ZokyumB2DC4.tmp” in %APPDATA% temp directory. Copy content of “certutil.exe” into “gosia.exe” ( “*ertu*.exe is used to bypass security detection).Look for the base64 blob using “findstr.exe” and write it to “cSi1rouy4.tmp”.Decode content of “cSi1rouy4.tmp” using “gosia.exe -decode” (certutil.exe -decode) and write it to “o423DFDS4.tmp”. Decompress content of “o423DFDS4.tmp” in temp directory along with a decoy PDF document using “expand.exe  -F:*”  (Figure 3) .Copy “66DF3DFG.tmp” and “34fDKfSD38.js” files into “C:UsersPublicDownloads” directory.Execute the JS file by calling Wscript.Open the decoy document.    The list of commands executed by this LNK shortcut is the same as the one reported by Anomali on the Higasia Covid-19 campaign. The only difference is the name of the tmp files and name of certutil.exe which in this new case is “gosia.exe”, while in the March campaign the name was “mosia.exe”. Both LNK files embedded within the archive are executing similar commands with the different Command and Control (C&C) configurations. Running each of them would show a different decoy document.        JS file  The JavaScript file performs the following commands: Create “d3reEW.exe” in “C:UsersPublicDownloads” and store “cmd /c ipconfig” in it. Execute the dropped “svchast.exe”. Copy “svchhast.exe” into startup directory and rename it as “officeupdate.exe”.Add “officeupdate.exe” to scheduled tasks.Send a POST request to a hardcoded URL with “d3reEW.exe” as data.         svchast.exe Svchast.exe is a small loader that loads the content of the shellcode stored in “66DF3DFG.tmp”.    In fact, this shellcode is a wrapper around the final shellcode. It performs some checks and then calls the final shellcode.   The final shellcode dynamically resolves the imports and allocates memory for the content that will be executed.       Finally it calls “CreateThread” to create a thread within its memory space to make HTTPS requests to its C&C server.     At the time of analysis, the server was down so we weren’t able to clearly identify the ultimate goal of this attack. Chaining techniques for evasion While most malware campaigns use a simple decoy document that typically retrieves a malware payload, more advanced attackers will often try unconventional means to infect their victims. We reproduced this attack in our lab using an email as the infection vector, as we surmise that victims were spear-phished. Malwarebytes (in this case the Nebula business version) stopped the LNK file execution from WinRAR and therefore completely stopped the attack.    IOCs CV_Colliers.rardf999d24bde96decdbb65287ca0986db98f73b4ed477e18c3ef100064bceba6d Project link and New copyright policy.rarc3a45aaf6ba9f2a53d26a96406b6c34a56f364abe1dd54d55461b9cc5b9d9a04 Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnk50d081e526beeb61dc6180f809d6230e7cc56d9a2562dd0f7e01f7c6e73388d9 Tokbox icon – Odds and Ends – iOS – Zeplin.lnk1074654a3f3df73f6e0fd0ad81597c662b75c273c92dc75c5a6bea81f093ef81 International English Language Testing System certificate.pdf.lnkc613487a5fc65b3b4ca855980e33dd327b3f37a61ce0809518ba98b454ebf68b Curriculum Vitae_WANG LEI_Hong Kong Polytechnic University.pdf.lnkdcd2531aa89a99f009a740eab43d2aa2b8c1ed7c8d7e755405039f3a235e23a6 Conversations – iOS – Swipe Icons – Zeplin.lnkc0a0266f6df7f1235aeb4aad554e505320560967248c9c5cce7409fc77b56bd5 C2 domains (ipconfig exfiltration)sixindent[.]epizy[.]comgoodhk[.]azurewebsites[.]netzeplin[.]atwebpages[.]com C2s used by svchast.exe45.76.6[.]149www.comcleanner[.]info MITRE ATT&CK techniques  TacticIDNameDetailsExecutionT1059Command-Line InterfaceStarts CMD.EXE for commands (WinRAR.exe, wscript.exe)  executionT1106Execution through APIApplication (AcroRd32.exe) launched itselfT1053Scheduled TaskLoads the Task Scheduler DLL interface (Officeupdate.exe)T1064ScriptingExecutes scripts (34fDFkfSD38.js)T1204User ExecutionManual execution by user (opening LNK file)PersistenceT1060Registry Run Keys / Startup FolderWrites to a start menu file (Officeupdate.exe)T1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Privilege EscalationT1053Scheduled TaskUses Task Scheduler to run other applications (Officeupdate.exe)Defense EvasionT1064ScriptingExecutes scripts (34fDFkfSD38.js)T1140Deobfuscate/Decode Files or Informationcertutil to decode Base64 binaries, expand.exe to decompress a CAB fileDiscoveryT1012Query RegistryReads the machine GUID from the registryT1082System Information DiscoveryReads the machine GUID from the registryT1016System Network Configuration DiscoveryUses IPCONFIG.EXE to discover IP address 




SHARE THIS ARTICLE
































RELATED ARTICLES





 



News
																	 | 																	Privacy

Facebook Marketplace users’ stolen data offered for sale


February 15, 2024 - Personal data belonging to 200,000 Facebook Marketplace users has been published online, including email addresses and phone numbers.

CONTINUE READING
 0 Comments






 



Cybercrime
																	 | 																	Ransomware
																	 | 																	Threats

How ransomware changed in 2023


February 14, 2024 - In 2023, the CL0P ransomware gang broke the scalability barrier and shook the security world with a series of short, automated campaigns.

CONTINUE READING
 0 Comments






 



News
																	 | 																	Personal

Malwarebytes crushes malware all the time


February 14, 2024 - The PC Security Channel tested Malwarebytes against 2015 files.  Here's how we did.

CONTINUE READING
 0 Comments






 



Exploits and vulnerabilities
																	 | 																	News

Update now! Microsoft fixes two zero-days on February Patch Tuesday


February 14, 2024 - Microsoft has issued patches for 73 security vulnerabilities in its February 2024 Patch Tuesday.

CONTINUE READING
 0 Comments






 



Android
																	 | 																	News
																	 | 																	Personal

TheTruthSpy stalkerware, still insecure, still leaking data


February 13, 2024 - Stalkerware app TheTruthSpy has been hacked for the fourth time, once again leaking the sensitive data it captures.

CONTINUE READING
 0 Comments










ABOUT THE AUTHOR









Threat Intelligence Team













Contributors



Threat Center



Podcast



Glossary



Scams










 

					Cyberprotection for every one.					



FOR PERSONAL
Windows Antivirus
Mac Antivirus
Android Antivirus
Free Antivirus
VPN App (All Devices)
Malwarebytes for iOS
SEE ALL

COMPANY
About Us
Contact Us
Careers
News and Press
Blog
Scholarship
Forums
 

FOR BUSINESS
Small Businesses
Mid-size business
Larger Enterprise
Endpoint Protection
Endpoint Detection & Response
Managed Detection and Response (MDR)

FOR PARTNERS
Managed Service Provider (MSP) Program
Resellers

MY ACCOUNT
Sign In


SOLUTIONS
Rootkit Scanner
Trojan Scanner
Virus Scanner
Spyware Scanner
Password Generator
Anti Ransomware Protection

ADDRESS
One Albert Quay2nd FloorCork T12 X8N6Ireland
3979 Freedom Circle12th FloorSanta Clara, CA 95054


LEARN
Malware
Hacking
Phishing
Ransomware
Computer Virus
Antivirus
What is VPN?
 




 Twitter




 Facebook




 LinkedIn




 Youtube




 Instagram




Cybersecurity info you can’t live without
Want to stay informed on the latest news in cybersecurity? Sign up for our newsletter and learn how to protect your computer from threats.


Email Address



















English


Legal
Privacy
Accessibility
Vulnerability Disclosure
Terms of Service
 
						© 2024 All Rights Reserved						










Select your language








































