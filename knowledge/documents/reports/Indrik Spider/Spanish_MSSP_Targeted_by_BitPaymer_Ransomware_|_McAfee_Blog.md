# Reference for threat actor for "Indrik Spider"

**Title**: Spanish MSSP Targeted by BitPaymer Ransomware | McAfee Blog

**Source**: https://www.mcafee.com/blogs/other-blogs/mcafee-labs/spanish-mssp-targeted-by-bitpaymer-ransomware/

## Content















Spanish MSSP Targeted by BitPaymer Ransomware | McAfee Blog





















































































Products






                                                        All-In-One Protection 



NEW McAfee+ Individual
                                                                    Plans
                                                                
Complete privacy,
                                                                    identity and device protection for individuals. 




NEW McAfee+ Family
                                                                    Plans
                                                                
 Complete privacy,
                                                                    identity and device protection for up to 6 family
                                                                    members. 





Other Products & Services


                                                                Antivirus 
 Scam Protection 

                                                                Virtual Private Network (VPN)
 Mobile Security
 PC
                                                                Optimizer
 TechMaster Concierge
                                                            

                                                                McAfee Assist 



Free Tools & Downloads


                                                                Web Protection
 Free Antivirus Trial
                                                            
 Device Security Scan
                                                            
 Password Generator 








Features





Keep Me Private Online

Personal Data
                                                                Cleanup
Online Account
                                                                Cleanup
VPN (Virtual
                                                                Private Network)
Social Privacy
                                                                Manager



Safeguard My Identity

Identity Monitoring

Credit Monitoring

Security Freeze

                                                                Identity Theft Coverage & Restoration
Password Manager



Protect My Devices


                                                                Antivirus 

                                                                Scam Protection 

                                                                Web Protection 



Protect My Family

 Protection Score
Parental Controls

Family Plans







Resources





Stay Updated

McAfee Blog
Reports and Guides

McAfee on YouTube

Prevent Spam and
                                                                Phishing



Learn More

Learn at McAfee
What is Antivirus?

What is a VPN?
What is Identity
                                                                Theft?



Press & News

McAfee Newsroom
AI News & Scams








About Us





Our Company

Company Overview
Awards &
                                                                Reviews
Investors



Our Efforts

Inclusion &
                                                                Diversity
Integrity &
                                                                Ethics
Public Policy



Join Us

Careers
Life at McAfee
Our Teams
Our Locations







Why McAfee





 Products 



                                            All-In-One Protection

NEW
                                                    McAfee+ Individual Plans 
Complete privacy, identity and device
                                                protection for individuals.


NEW McAfee+
                                                    Family Plans 
Complete privacy, identity and device
                                                protection for up to 6 family members.

Other Products & Services
 Antivirus 
 Scam Protection 
 Virtual Private Network (VPN) 
 Mobile Security 
 PC Optimizer 
 TechMaster Concierge 
 McAfee Assist 
Free Tools & Downloads
 Web Protection 
 Free
                                                Antivirus Trial 
 Device Security Scan 

                                                Password Generator 




                                    Features 


Keep Me Private Online
Personal Data Cleanup
Online Account Cleanup
 VPN (Virtual Private Network) 

                                                Social Privacy Manager 
Safeguard My Identity
Identity Monitoring 
 Credit Monitoring 
Security Freeze 
 Identity Theft Coverage & Restoration
                                            
 Password Manager 
Protect My Devices
 Antivirus 
 Scam Protection 
 Web Protection 
Protect My Family
Protection Score
Parental Controls
Family Plans




                                    Resources 


Stay Updated
 McAfee Blog 
 Reports and Guides 
 McAfee
                                                on YouTube 

                                                Prevent Spam and Phishing 
Learn More
 Learn at
                                                McAfee 
 What is Antivirus? 
 What is a VPN? 
What
                                                is Identity Theft?
Press & News
 McAfee Newsroom 
 AI News & Scams
                                            



 About
                                    Us 


Our Company
Company Overview 
 Awards & Reviews 
 Investors 
Our Efforts
 Inclusion & Diversity 
 Integrity & Ethics 
 Public Policy 
Join Us
 Careers 
 Life at McAfee 
 Our Teams 
Our Locations




                                    Why McAfee 
 Support
                                


Help
Customer Support

Support
                                                Community
 FAQs 
 Contact Us 
Activation
 Activate Retail Card 










Region



Asia Pacific

Australia - English
New Zealand - English

Singapore - English
Malaysia - English
Philippines - English

India - English
대한민국 - 한국어
日本 - 日本語
中国 - 简体中文
香港特別行政區 - 繁體中文
台灣 - 繁體中文

Europe

Česká Republika - Čeština
Danmark - Dansk
Suomi - Suomi
France - Français
Deutschland - Deutsch

Ελλάδα - Ελληνικά
Ireland - English
Magyarország - Magyar

ישראל -
                                                עברית
Italia - Italiano
Nederland - Nederlands

Norge - Bokmål
Polska - Polski
Portugal - Português
Россия - Русский
España - Español
Sverige - Svenska
Suisse - Français
Schweiz - Deutsch
Türkiye - Türkçe
العربية
                                                - العربية
United Kingdom - English


North America

United States - English

Canada - English
Canada - Français

South America

Argentina - Español
Brasil - Português
Chile - Español
Colombia - Español
México - Español
Perú - Español




Sign in




Support 





Help

Customer Support
Support Community
FAQs
Contact Us



Activation

Activate Retail Card



















Asia Pacific

Australia-English
New
                                                                Zealand-English
Singapore-English
Malaysia-English
Philippines-English

India-English
대한민국-한국어
日本-日本語
中国-简体中文
香港特別行政區-繁體中文
台灣-繁體中文



Europe

Česká Republika-Čeština

Danmark-Dansk
Suomi-Suomi
France-Français
Deutschland-Deutsch

Ελλάδα-Ελληνικά
Ireland-English
Magyarország-Magyar

ישראל-עברית

Italia-Italiano
Nederland-Nederlands




 

Norge-Bokmål
Polska-Polski
Portugal-Português
Россия-Русский
España-Español
Sverige-Svenska
Suisse-Français
Schweiz-Deutsch
Türkiye-Türkçe
العربية-العربية

United Kingdom-English




North America

United States-English

Canada-English
Canada-Français



South America

Argentina-Español
Brasil-Português
Chile-Español
Colombia-Español
México-Español
Perú-Español









Sign in
















                                    Blog
Topics



Internet Security
Mobile Security
Family Safety
Privacy & Identity Protection
Security News
Tips & Tricks




At McAfee



McAfee News
Executive Perspectives
McAfee Labs
Life at McAfee
Hackable? Podcast






  







English



Portuguese (BR)



Spanish



French(FR)



German



Italian



Japanese



French(CA)



Portuguese (PT)



Spanish (MX)








  










Blog
Topics  



Internet Security
Mobile Security
Family Safety
Privacy & Identity Protection
Security News
Tips & Tricks




At McAfee  



McAfee News
Executive Perspectives
McAfee Labs
Life at McAfee
Hackable? Podcast










. 






 


Portuguese (BR)
Spanish
French(FR)
German
Italian
Japanese
French(CA)
Portuguese (PT)
Spanish (MX)















 

 


Blog Other Blogs McAfee Labs Spanish MSSP Targeted by BitPaymer Ransomware 
 





Spanish MSSP Targeted by BitPaymer Ransomware







ATR Operational Intelligence Team


Nov 08, 2019


   8  MIN READ 


 




Co-authored by Marc RiveroLopez
Initial Discovery
This week the news hit that several companies in Spain were hit by a ransomware attack. Ransomware attacks themselves are not new but, by interacting with one of the cases in Spain, we want to highlight in this blog how well prepared and targeted an attack can be and how it appears to be customized specifically against its victims.
In general, ransomware attacks are mass-spread attacks where adversaries try to infect many victims at the same time and cash out quickly. However, this has significantly changed over the past two years where more and more ransomware attacks are targeting high-value targets in all kinds of sectors.
Victims are infected with a different type of malware before the actual ransomware attack takes place. It looks like adversaries are using the infection base to select or purchase the most promising victims for further exploitation and ransomware, in a similar way to how the sale of Remote Desktop Access on underground forums or private Telegram channels is being used for victim selection for ransomware attacks.
In the following paragraphs, we will take you step by step through the modus operandi of the attack stages and most important techniques used and mapped against the MITRE ATT&CK Framework.
The overall techniques observed in the campaign and flow visualization:

Technical Analysis
The overall campaign is well known in the industry and the crew behind it came back to the scene reusing some of the TTPs observed one year ago and adding new ones like: privilege escalation, lateral movement and internal reconnaissance.

Patient 0 – T1189 Drive-by Compromise
The entry point for these types of campaigns starts with a URL that points the user to a fake website (in case the website is compromised) or a legitimate page (in case they decided to use a pay-per-install service) using social engineering techniques; the user gets tricked to download the desired application that will use frameworks like Empire or similar software to download and install next stage malware which, in this case, is Dridex.
First infection – T1090 Connection Proxy
These types of attacks are not limited to one type of malware; we have observed it being used by:

Azorult
Chthonic
Dridex

It is currently unclear why one would select one malware family above the other, but these tools allow for remote access into a victim’s network. This access can then be used by the actor as a launchpad to further exploit the victim’s network with additional malware, post-exploitation frameworks or the access can be sold online.
For quite some time now, Dridex’s behavior has changed from its original form. Less Dridex installs are linked to stealing banking info and more Dridex infections are becoming a precursor to a targeted ransomware attack.
This change or adaptation is something we have observed with other malware families as well.
For this campaign, the Dridex botnet used was 199:

Information Harvesting – T1003 Credential Dumping
From the infection, one or multiple machines are infected, and the next step is to collect as many credentials as they can to perform lateral movement. We observed the use of Mimikatz to collect (high privileged) credentials and re-use them internally to execute additional software in the Active Directory servers or other machines inside the network.
The use of Mimikatz is quite popular, having been observed in the modus operandi of more than 20 different threat actors.
Lateral Movement – T1086 PowerShell
The use of PowerShell helps attackers to automate certain things once they are in a network. In this case, we observed how Empire was used for different sock proxy PowerShell scripts to pivot inside the network:

Extracting information about the IP found in the investigation, we observed that the infrastructure for the Dridex C2 panels and this proxy sock was shared.

PowerShell was also used to find specific folders inside the infected systems:

A reason for an attacker to use a PowerShell based framework like Empire, is the use of different modules, like invoke-psexec or invoke-mimikatz, that can execute remote processes on other systems, or get credentials from any of the systems where it can run Mimikatz. When deployed right, these modules can significantly increase the speed of exploitation.
Once the attackers collected enough high privileged accounts and got complete control over the Active Directory, they would then distribute and execute ransomware on the complete network as the next step of their attack, in this case BitPaymer.
Ransomware Detonation – T1486 Data Encrypted for Impact
BitPaymer seemed to be the final objective of this attack. The actors behind BitPaymer invest time to know their victims and build a custom binary for each which includes the leet-speek name of the victim as the file extension for the encrypted files, i.e. “financials.<name_of_victim>”.
In the ransomware note, we observed the use of the company name too:

Observations

One of the remote proxy servers used in the operation shares the same infrastructure as one of the C2 panels used by Dridex.
We observed how a Dridex infection served as a launch point for an extensive compromise and BitPaymer ransomware infection.
Each binary of Bitpaymer is specially prepared for every single target, including the extension name and using the company name in the ransomware note.
Certain Dridex botnet IDs are seen in combination with targeted BitPaymer infections.
Companies must not ignore indicators of activity from malware like Dridex, Azorult or NetSupport; they could be a first indicator of other malicious activity to follow.
It is still unclear how the fake update link arrived at the users but in similar operations, SPAM campaigns were most likely used to deliver the first stage.

McAfee Coverage
Based on the indicators of compromise found, we successfully detect them with the following signatures:

RDN/Generic.hbg
Trojan-FRGC!7618CB3013C3
RDN/Generic.dx

The C2 IPs are tagged as a malicious in our GTI.
McAfee ATD Sandbox Detonation
Advanced Threat Detection (ATD) is a specialized appliance that identifies sophisticated and difficult to detect threats by executing suspicious malware in an isolated space, analyzing its behavior and assessing the impact it can have on an endpoint and on a network.
For this specific case, the ATD sandbox showcases the activity of Bitpaymer in a system:

We observe the use of icacls and takeown to change permissions inside the system and the living off the land techniques are commonly used by different type of malware.
ATD Sandbox extracted behavior signatures observing Bitpaymer detonation in the isolated environment:

Having the opportunity to detonate malware in this environment could give indicators about the threat types and their capabilities.
McAfee Real Protect
Analysis into the samples garnered from this campaign would have been detected by Real Protect. Real Protect is designed to detect zero-day malware in near real time by classifying it based on behavior and static analysis. Real Protect uses machine learning to automate classification and is a signature-less, small client footprint while supporting both offline mode and online mode of classification. Real Protect improves detection by up to 30% on top of .DAT and McAfee Global Threat Intelligence detections, while producing actionable threat intelligence.

YARA RULE
We have a YARA rule available on our ATR GitHub repository to detect some of the versions of BitPaymer ransomware.
IOCs

3ab42ca8ce81f9df0c4f7cd807528c5dd0fb5108
4862fbb188285586218cd96e69a2e4436827d2fe
c1ad6c3ab06fc527c048cd15c6fc701b5a74a900
1d778359ab155cb190b9f2a7086c3bcb4082aa195ff8f754dae2d665fd20aa05
628c181e6b9797d8356e43066ae182a45e6c37dbee28d9093df8f0825c342d4c
bd327754f879ff15b48fc86c741c4f546b9bbae5c1a5ac4c095df05df696ec4f
0f630aaf8b5c4e958445ec0c2d5ec47e
9b982fa4b42813279426449ddd6a1dbe
c46ad4159c90bc11d6d94a28458553d7

A special thanks to John Fokker and Christiaan Beek for their assistance with this blog.
 








Stay Updated
Follow us to stay updated on all things McAfee and on top of the latest consumer and mobile security threats.










ATR Operational Intelligence Team



                    McAfee’s Advanced Threat Research Operational Intelligence team operates globally around the clock, keeping watch of the latest cyber campaigns and actively tracking the most impactful cyber threats.                    

 
 
 


    More from     McAfee Labs








MoqHao evolution: New variants start automatically right after installation
Authored by Dexter Shin  MoqHao is a well-known Android malware family associated with the Roaming Mantis threat...


Feb 07, 2024    |      7  MIN READ









Generative AI: Cross the Stream Where it is Shallowest
The explosive growth of Generative AI has sparked many questions and considerations not just within tech circles,...


Feb 07, 2024    |      5  MIN READ









From Email to RAT: Deciphering a VB Script-Driven Campaign
Authored by Preksha Saxena and Yashvi Shah McAfee Labs has been tracking a sophisticated VBS campaign characterized...


Jan 17, 2024    |      10  MIN READ









Stealth Backdoor “Android/Xamalicious” Actively Infecting Devices
Authored by Fernando Ruiz  McAfee Mobile Research Team identified an Android backdoor implemented with Xamarin, an open-source...


Dec 22, 2023    |      14  MIN READ









Shielding Against Android Phishing in Indian Banking
Authored by Neil Tyagi and Fernando Ruiz In a digitally evolving world, the convenience of banking through...


Dec 20, 2023    |      8  MIN READ









PDF Phishing: Beyond the Bait
By Lakshya Mathur & Yashvi Shah  Phishing attackers aim to deceive individuals into revealing sensitive information for...


Dec 04, 2023    |      6  MIN READ









Beneath the Surface: How Hackers Turn NetSupport Against Users
NetSupport malware variants have been a persistent threat, demonstrating adaptability and evolving infection techniques. In this technical...


Nov 27, 2023    |      12  MIN READ









Fake Android and iOS apps steal SMS and contacts in South Korea
Authored by Dexter Shin Most people have smartphones these days which can be used to easily search...


Nov 15, 2023    |      10  MIN READ









Unmasking AsyncRAT New Infection Chain
Authored by Lakshya Mathur & Vignesh Dhatchanamoorthy AsyncRAT, short for “Asynchronous Remote Access Trojan,” is a sophisticated...


Nov 03, 2023    |      7  MIN READ









Exploring Winrar Vulnerability (CVE-2023-38831)
Authored by Neil Tyagi On 23 August 2023, NIST disclosed a critical RCE vulnerability CVE-2023-38831. It is...


Sep 19, 2023    |      8  MIN READ









Agent Tesla’s Unique Approach: VBS and Steganography for Delivery and Intrusion
Authored by Yashvi Shah Agent Tesla functions as a Remote Access Trojan (RAT) and an information stealer...


Sep 08, 2023    |      13  MIN READ









Peeling Back the Layers of RemcosRat Malware
Authored by Preksha Saxena McAfee labs observed a Remcos RAT campaign where malicious VBS files were delivered...


Aug 29, 2023    |      9  MIN READ






 
 
 
 


Back to top











 

















































Corporate
                                                                                    Headquarters 6220 America Center
                                                                                    Drive San Jose, CA 95002
                                                                                    USA

























                                                                            Products

McAfee+™
                                                                                IndividualMcAfee+™
                                                                                FamilyMcAfee® Total
                                                                                ProtectionMcAfee®
                                                                                AntivirusMcAfee® Safe
                                                                                ConnectMcAfee® PC
                                                                                OptimizerMcAfee®
                                                                                TechMasterMcAfee® Mobile
                                                                                Security


























                                                                            Resources

AntivirusFree
                                                                                    DownloadsParental
                                                                                    ControlsMalware
FirewallBlogsActivate
                                                                                    Retail CardMcAfee
                                                                                    Labs


























                                                                            Support

Customer
                                                                                    ServiceFAQsRenewalsSupport
                                                                                     Community


























                                                                            About

About
                                                                                    McAfeeCareersContact
                                                                                    UsNewsroomInvestorsLegal
                                                                                    TermsYour
                                                                                    Privacy ChoicesSystem
                                                                                    RequirementsSitemap






















  United States / English Copyright © 2024
                                        McAfee, LLC

Copyright © 2024 McAfee, LLC




United
                                                        States / English









 












































