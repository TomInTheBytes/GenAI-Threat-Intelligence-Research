# Reference for threat actor for "Magic Hound, APT 35, Cobalt Illusion, Charming Kitten"

**Title**: APT35 ‘Charming Kitten' discovered in a pre-infected environment | Darktrace Blog

**Source**: https://www.darktrace.com/en/blog/apt-35-charming-kitten-discovered-in-a-pre-infected-environment/

## Content
APT35 ‘Charming Kitten' discovered in a pre-infected environment | Darktrace Blog























New Innovations in Cloud Security - October 26thJoin the broadcastCustomer PortalNewsPartnersOverviewTechnology PartnersIntegrationsPartner PortalBecome a partnerFeatured PartnersMicrosoftAWSMcLarenCompanyOverviewCareersInvestorsLeadershipFederalAcademyLegalContact usContactProductsCustomersAI Research CentreBlogResources

ProductsDaRKTRACEPREVENT™Harden security inside and outDaRKTRACEDETECT™See attacks instantlyDaRKTRACERESPOND™Disarm within secondsDaRKTRACEHEAL™Be ready, recover quicklyCore coverageCloudEmailAppsEndpointZero TrustNetworkOTDiscover Darktrace/CloudNew innovations have dramatically enhanced Darktrace's ability to secure your cloud in real time.IntegrationsDarktrace is designed with an open architecture that makes it the perfect complement to your existing infrastructure and products.Explore integrationsCustomersDarktrace in actionDarktrace customers protect their organizations with the Cyber AI Loop.View customersJOIN 8,800+ companies using darktraceWe could immediately understand how Darktrace would improve our security posture from day one, and how valuable the technology would be. No other tool can detect threats as fast.Paul Berryman,Head of Information Technology, The YMCA NSWRESEARCH CENTREAI ResearchWe examine how AI can be applied to real-world problems to find new paths forwardAI Research CentreInnovating Cyber Recovery - Key to Cyber ResilienceRapid Process-Chain Anomaly Detection Using a Multistage ClassifierSorting long lists of file names by relevance and sensitive contentResearch unlocks the unknowns; it also helps shed light on what we are collectively up against.Jack Stockdale OBE, CTO, DarktraceBlogDarktrace BlogDarktrace experts weigh in on the cyber landscapeAll BlogsInside the SOCSeven Cyber Security Predictions for 2024 Catching CoinLoader: Decrypting the Malware Hijacking Networks for Cryptomining OperationsREsourcesDarktrace LibraryEventsWebinarsGlossaryAll ResourcesNavigating a New Threat Landscape: Breaking Down the AI Kill ChainWhite PaperBlogNewsroomCompanyCustomer PortalPartnersGet a DemoContact usStart free trialProductsProducts OverviewDarktrace PREVENT™Darktrace DETECT™Darktrace RESPOND™Darktrace HEAL™Core coverageCloudAppsEmailEndpointZero TrustOTNetworkIntegrationsExplore IntegrationsCustomersAI Research CentreResourcesResource OverviewWebinarsEventsDatasheetsWhite Papers BlogCustomer PortalNewsPartnersOverviewTechnology PartnersIntegrationsPartner PortalMicrosoftAWSMcLarenCompanyOverviewCareersInvestorsLeadershipFederalLegalContact usGET A DEMOSee why 9,000+ companies trust DarktraceEmailFirst NameLast NameOrganizationJob TitlePhone NumberCountryStateOrganization Size50 employees or fewer51 to 250 employees251 to 500 employees501 to 1,000 employees1,001 to 5,000 employeesMore than 5,000 employeesYes, I would like to receive marketing emails from Darktrace about their offerings. For more information, please see our Privacy Notice.Thanks, your request has been receivedA member of our team will be in touch with you shortly.YOU MAY FIND INTERESTINGFive Key Takeaways from Black Hat 2023Hives & Frankensteins: The Half-Year Threat ReportOops! Something went wrong while submitting the form.Blog‍Threat FindsAPT35 ‘Charming Kitten' discovered in a pre-infected environment22Apr 202122Apr 2021This blog discusses how Darktrace discovered a stealthy pre-existing APT35 infection in a customer environment.What is APT35?APT35, sometimes referred to as Charming Kitten, Imperial Kitten, or Tortoiseshell, is a notorious cyber-espionage group which has been active for nearly 10 years. Famous for stealing scripts from HBO’s Game of Thrones in 2017 and suspected of interfering in the U.S. presidential election last year, it has launched extensive campaigns against organizations and officials across North America and the Middle East. Public attribution has associated APT35 with an Iran-based nation state threat actor.Darktrace regularly detects attacks by many known threat actors including Evil Corp and APT41, alongside large amounts of malicious but uncategorized activity from sophisticated attack groups. As Cyber AI doesn’t rely on pre-defined rules, signatures, or threat intelligence to detect cyber-attacks, it often detects new and previously unknown threats.This blog post examines a real-world instance of APT35 activity in an organization in the EMEA region. Darktrace observed this activity last June, but due to ongoing investigations, details are only now being released with the wider community. It represents an interesting case for the value of self-learning AI in two key ways:Identifying ‘low and slow’ attacks: How do you spot an attacker that is lying low and conducts very little detectable activity?Detecting pre-existing infections without signatures: What if a threat actor is already inside the system when Cyber AI is activated?Advanced Persistent Threats (APTs) lying lowAPT35 had already infected a single corporate device, likely via a spear phishing email, when Cyber AI was deployed in the company’s digital estate for the first time.The infected device exhibited no other signs of malicious activity beyond continued command and control (C2) beaconing, awaiting instructions from the attackers for several days. This is what we call ‘lying low’ – where the hacker stays present within a system, but remains under the radar, avoiding detection either intentionally, or because they’re focusing on another victim while being content with backdoor access into the organization.Either way, this is a nightmare scenario for a security team and any security vendor: an APT which has established a foothold and is lying in wait to continue their attack – undetected.Finding the infected deviceWhen Darktrace’s AI was first activated, it spent five business days learning the unique ‘patterns of life’ for the organization. After this initial, short learning period, Darktrace immediately flagged the infected device and the C2 activity.Although the breach device had been beaconing since before Darktrace was implemented, Cyber AI automatically clusters devices into ‘peer groups’ based on similar behavioral patterns, enabling Darktrace to identify the continued C2 traffic coming from the device as highly unusual in comparison to the wider, automatically identified peer group. None of its behaviorally close neighbors were doing anything remotely similar, and Darktrace was therefore able to determine that the activity was malicious, and that it represented C2 beaconing.Darktrace detected the APT35 C2 activity without the use of any signatures or threat intelligence on multiple levels. Responding to the alerts, the internal security team quickly isolated the device and verified with the Darktrace system that no further reconnaissance, lateral movement, or data exfiltration had taken place.APT35 ‘Charming Kitten’ analysisOnce the C2 was detected, Cyber AI Analyst immediately began analyzing the infected device. The Cyber AI Analyst only highlights the most severe incidents in any given environment and automates many of the typical level one and level two SOC tasks. This includes reviewing all alerts, investigating the scope and nature of each event, and reducing time to triage by 92%.Figure 1: Similar Cyber AI Analyst report observing C2 communicationsNumerous factors made the C2 activity stand out strongly to Darktrace. Combining all those small anomalies, Darktrace was able to autonomously prioritize this behavior and classify it as the most significant security incident in the week.Figure 2: Example list of C2 detections for an APT35 attackSome of the command and control destinations were known to threat intelligence and open-source intelligence (OSINT) – for instance, the domain cortanaservice[.]com is a known C2 domain for APT35.However, the presence of a known malicious domain does not guarantee detection. In fact, the organization had a very mature security stack, yet they failed to discover the existing APT35 infection until Darktrace was activated in their environment.Assessing the impact of the intrusionOnce an intrusion has been identified, it is important to understand the extent of it – such as whether lateral movement is occurring and what connectivity the infected device has in general. Asset management is never perfect, so it can be very hard for organizations to determine what damage a compromised device is capable of inflicting.Darktrace presents this information in real time, and from a bird’s-eye perspective, making the assessment very simple. It immediately highlights which subnet the device is located in and any further context.Figure 3: Darktrace’s Threat Visualizer displaying the connectivity of a deviceBased on this information, the organization confirmed that it was a corporate device that had been infected by APT35. As Darktrace shows any credentials associated with the device, a quick assessment could be made of potentially compromised accounts.Figure 4: Similar and associated credentials of a deviceLuckily, only a single local user account was associated with the device.The exact level of privileges and connectivity which the infected device had, as well as the extent to which the intrusion might have spread from the initially infected device, was still uncertain. By looking at the device’s event log, this became rapidly clear within minutes.Filtering first for internal connections only (excluding any connections going to the Internet) gave a good idea of the level of connectivity of the device. A cursory glance showed that the device did indeed have some level of internal connectivity. It made DNS requests to the internal domain controller and was making successful NetBIOS connections over ports 135 and 139 internally.By filtering further in the event log, it quickly became clear that in this time the device had not used any administrative channels, such as RDP, SSH, Telnet, or SMB. This is a strong indicator that no lateral movement over common channels had taken place.It is more difficult to assess whether the device was performing any other suspicious activity, like stealthy reconnaissance or staging data from other internal devices. Darktrace provided another capability to assess this quickly – filtering the device’s network connections to show only unusual or new connections.Figure 5: Event device log filtered to show unusual connections onlyDarktrace assesses each individual connection for every entity observed in context, using its unsupervised machine learning to evaluate how unusual a given connection is. This could be a single new failed internal connection attempt, indicating stealthy reconnaissance, or a connection over SMB at an unusual time to a new internal destination, implying lateral movement or data staging.By filtering for only unusual or new connections, Darktrace’s AI produces further leads that can be pursued extremely quickly, thanks to the context and added visibility.No further suspicious internal connections were observed, strengthening the hypothesis that APT35 was lying low at that time.Unprecedented but not unpreventableDarktrace’s 24/7 monitoring service, Proactive Threat Notifications, would have alerted on and escalated the incident. Darktrace RESPOND would have responded autonomously and enforced normal activity for the device, preventing the C2 traffic without interrupting regular business workflows.It is impossible to predefine where the next attack will come from. APT35 is just one of the many sophisticated threat actors on the scene, and with such a diverse and volatile threat landscape, unsupervised machine learning is crucial in spotting and defending against anomalies, no matter what form they take.This case study helps illustrate how Darktrace detects pre-existing infections and ‘low and slow’ attacks, and further shows how Darktrace can be used to quickly understand the scope and extent of an intrusion.Learn how Cyber AI Analyst detected APT41 two weeks before public attributionShortened list of C2 detections over four days on the infected device:Compromise / Sustained TCP Beaconing Activity To Rare EndpointCompromise / Beaconing Meta ModelCompromise / Beaconing Activity To External RareCompromise / SSL Beaconing To Rare DestinationCompromise / Slow Beaconing To External RareCompromise / High Volume of Connections with Beacon ScoreCompromise / Unusual Connections to Rare Lets EncryptCompromise / Beacon for 4 DaysCompromise / Agent BeaconObserved C2 destinations:Cortanaservice[.]com, port 443, beacon intervals at 100 seconds‍Like this and want more?Receive the latest blog in your inboxThank you! Your submission has been received!Oops! Something went wrong while submitting the form.NEWSLETTERLike this and want more?Stay up to date on the latest industry news and insights. Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.You can unsubscribe at any time. Privacy PolicyINSIDE THE SOCDarktrace cyber analysts are world-class experts in threat intelligence, threat hunting and incident response, and provide 24/7 SOC support to thousands of Darktrace customers around the globe. Inside the SOC is exclusively authored by these experts, providing analysis of cyber incidents and threat trends, based on real-world experience in the field.AUTHORABOUT ThE AUTHORMax HeinemeyerChief Product OfficerMax is a cyber security expert with over a decade of experience in the field, specializing in a wide range of areas such as Penetration Testing, Red-Teaming, SIEM and SOC consulting and hunting Advanced Persistent Threat (APT) groups. At Darktrace, Max is closely involved with Darktrace’s strategic customers & prospects. He works with the R&D team at Darktrace, shaping research into new AI innovations and their various defensive and offensive applications. Max’s insights are regularly featured in international media outlets such as the BBC, Forbes and WIRED. Max holds an MSc from the University of Duisburg-Essen and a BSc from the Cooperative State University Stuttgart in International Business Information Systems.Book a 1-1 meeting with one of our expertsGet in touchshare this articleNEWSletterStay up to date on the latest industry news and insights.You can unsubscribe at any time. Privacy PolicyThank you! Your submission has been received!Oops! Something went wrong while submitting the form.CATEGORIESMcLarenPREVENTRESPONDCloudRansomwareInside the SOCThought LeadershipCryptoEmailThreat FindsOTUSE CASESATHAdvanced Threat HuntingDLData LeaksPRODUCT SPOTLIGHTDaRKTRACEDETECTTM™See attacks instantly.DaRKTRACERESPONDTM™Disarm within secondsCOre coverageNo items found.RELATED BLOGSPulling back the curtain on Grief ransomwareHow AI uncovered Outlaw’s secret crypto-mining operationCyber Security Threat Trends of 2023: Analysis of the Last Six Months N-Day vulnerabilities: minimizing the risk with Self-Learning AITrending blogs1Three Ways AI Secures OT & ICS from Cyber Attacks  Jan 9, 20242Attacks are Getting Personal, but Cyber Security is NotDec 13, 20233The Implications of NIS2 on Cyber Security and AIDec 5, 20234$70 Million in Cyber Security Funding for Electric Cooperatives & UtilitiesNov 22, 20235Securing the Cloud Starts By Understanding ItNov 1, 2023More in this seriesNo items found.Blog‍No items found.Seven Cyber Security Predictions for 2024 13Feb 20242024 Cyber Threat PredictionsAfter analyzing the observed threats and trends that have affected customers across the Darktrace fleet in the second half of 2023, the Darktrace Threat Research team have made a series of predictions. These assessments highlight the threats that are expected to impact Darktrace customers and the wider threat landscape in 2024.  1. Initial access broker malware, especially loader malware, is likely to be a prominent threat.  Initial access malware such as loaders, information stealers, remote access trojans (RATs), and downloaders, will probably remain some of the most relevant threats to most organizations, especially when noted in the context that many are interoperable, tailorable Malware-as-a-Service (MaaS) tools.  These types of malware often serve as a gateway for threat actors to compromise a target network before launching subsequent, and often more severe, attacks. Would-be cyber criminals are now able to purchase and deploy these malware without the need for technical expertise.  ‍2. Infrastructure complexity will increase SaaS attacks and leave cloud environments vulnerable. The increasing reliance on SaaS solutions and platforms for business operations, coupled with larger attack surfaces than ever before, make it likely that attackers will continue targeting organizations’ cloud environments with account takeovers granting unauthorized access to privileged accounts. These account hijacks can be further exploited to perform a variety of nefarious activities, such as data exfiltration or launching phishing campaigns.  It is paramount for organizations to not only fortify their SaaS environments with security strategies including multifactor authentication (MFA), regular monitoring of credential usage, and strict access control, but moreover augment SaaS security using anomaly detection.  ‍3. The prevalence and evolution of ransomware will surge. The Darktrace Threat Research team anticipates a surge in Ransomware-as-a-Service (RaaS) attacks, marking a shift away from conventional ransomware. The uptick in RaaS observed in 2023 evidences that ransomware itself is becoming increasingly accessible, lowering the barrier to entry for threat actors. This surge also demonstrates how lucrative RaaS is for ransomware operators in the current threat landscape, further reinforcing a rise in RaaS.  This development is likely to coincide with a pivot away from traditional encryption-centric ransomware tactics towards more sophisticated and advanced extortion methods. Rather than relying solely on encrypting a target’s data for ransom, malicious actors are expected to employ double or even triple extortion strategies, encrypting sensitive data but also threatening to leak or sell stolen data unless their ransom demands are met.   4. Threat actors will continue to rely on living-off-the-land techniques. With evolving sophistication of security tools and greater industry adoption of AI techniques, threat actors have focused more and more on living-off-the-land. The extremely high volume of vulnerabilities discovered in 2023 highlights threat actors’ persistent need to compromise trusted organizational mechanisms and infrastructure to gain a foothold in networks. Although inbox intrusions remain prevalent, the exploitation of edge infrastructure has demonstrably expanded compared to previously endpoint-focused attacks. Given the prevalence of endpoint evasion techniques and the high proportion of tactics utilizing native programs, threat actors will likely progressively live off the land, even utilizing new techniques or vulnerabilities to do so, rather than relying on unidentified malicious programs which evade traditional detection.  5. The “as-a-Service” marketplace will contribute to an increase in multi-phase compromises. With the increasing “as-a-Service” marketplaces, it is likely that organizations will face more multi-phase compromises, where one strain of malware is observed stealing information and that data is sold to additional threat actors or utilized for second and/or third-stage malware or ransomware.  This trend builds on the concept of initial access brokers but utilizes basic browser scraping and data harvesting to make as much profit throughout the compromise process as possible. This will likely result in security teams observing multiple malicious tools and strains of malware during incident response and/or multi-functional malware, with attack cycles and kill chains morphing into less linear and more abstract chains of activity. This makes it more essential than ever for security teams to apply an anomaly approach to stay ahead of asymmetric threats.  6. Generative AI will let attackers phish across language barriers. Classic phishing scams play a numbers game, targeting as many inboxes as possible and hoping that some users take the bait, even if there are spelling and grammar errors in the email. Now, Generative AI has reduced the barrier for entry, so malicious actors do not have to speak English to produce a convincing phishing email.  In 2024, we anticipate this to extend to other languages and regions. For example, many countries in Asia have not yet been greatly impacted by phishing. Yet Generative AI continues to develop, with improved data input yielding improved output. More phishing emails will start to be generated in various languages with increasing sophistication.    7. AI regulation and data privacy rules will stifle AI adoption.  AI regulation, like the European Union’s AI Act and NIS2, is starting to be implemented around the world. As policies continue to come out about AI and data privacy, practical and pragmatic AI adoption becomes more complex.  Businesses will likely have to take a second look at AI they are adopting into their tech stacks to consider what may happen if a tool is suddenly deprecated because it is no longer fit for purpose or loses the approvals in place. Many will also have to use completely different supply chain evaluations from their usual ones based on developing compliance registrars. This increased complication may make businesses reticent to adopt innovative AI solutions as legislation scrambles to keep up.   Learn more about observed threat trends and future predictions in the 2023 End of Year Threat Report Continue readingAbout the authorThe Darktrace Threat Research TeamBlog‍Inside the SOCCatching CoinLoader: Decrypting the Malware Hijacking Networks for Cryptomining Operations08Feb 2024About Loader MalwareLoader malware was a frequent topic of conversation and investigation within the Darktrace Threat Research team throughout 2023, with a wide range of existing and novel variants affecting a significant number of Darktrace customers, as detailed in Darktrace’s inaugural End of Year Threat Report. The multi-phase nature of such compromises poses a significant threat to organizations due to the need to defend against multiple threats at the same time. CoinLoader, a variant of loader malware first observed in the wild in 2018 [1], is an example of one of the more prominent variant of loaders observed by Darktrace in 2023, with over 65 customers affected by the malware. Darktrace’s Threat Research team conducted a deep dive investigation into the patterns of behavior exhibited by devices infected with CoinLoader in the latter part of 2023, with compromises observed in Europe, the Middle East and Africa (EMEA), Asia-Pacific (APAC) and the Americas.The autonomous threat detection capabilities of Darktrace DETECT™ allowed for the effective identification of these CoinLoader infections whilst Darktrace RESPOND™, if active, was able to quickly curtail attacker’s efforts and prevent more disruptive, and potentially costly, secondary compromises from occurring.What is CoinLoader?Much like other strains of loader, CoinLoader typically serves as a first stage malware that allows threat actors to gain initial access to a network and establish a foothold in the environment before delivering subsequent malicious payloads, including adware, botnets, trojans or pay-per-install campaigns.CoinLoader is generally propagated through trojanized popular software or game installation archive files, usually in the rar or zip formats. These files tend can be easily obtained via top results displayed in search engines when searching for such keywords as "crack" or "keygen" in conjunction with the name of the software the user wishes to pirate [1,2,3,4]. By disguising the payload as a legitimate programme, CoinLoader is more likely to be unknowingly downloaded by endpoint users, whilst also bypassing traditional security measures that trust the download.It also has several additional counter-detection methods including using junk code, variable obfuscation, and encryption for shellcode and URL schemes. It relies on dynamic-link library (DLL) search order hijacking to load malicious DLLs to legitimate executable files. The malware is also capable of performing a variety of checks for anti-virus processes and disabling endpoint protection solutions.In addition to these counter-detection tactics, CoinLoader is also able to prevent the execution of its malicious DLL files in sandboxed environments without the presence of specific DNS cache records, making it extremely difficult for security teams and researchers to analyze. In 2020 it was reported that CoinLoader compromises were regularly seen alongside cryptomining activity and even used the alias “CoinMiner” in some cases [2]. Darktrace’s investigations into CoinLoader in 2023 largely confirmed this theory, with around 15% of observed CoinLoader connections being related to cryptomining activity.Cryptomining malware consumes large amounts of a hijacked (or cryptojacked) device's resources to perform complex mathematical calculations and generate income for the attacker all while quietly working in the background. Cryptojacking can lead to high electricity costs, device slow down, loss of functionality, and in the worst case scenario can be a potential fire hazard. Darktrace Coverage of CoinLoaderIn September 2023, Darktrace observed several cases of CoinLoader that served to exemplify the command-and-control (C2) communication and subsequent cryptocurrency mining activities typically observed during CoinLoader compromises. While the initial infection method in these cases was outside of Darktrace’s purview, it likely occurred via socially engineered phishing emails or, as discussed earlier, trojanized software downloads. Command-and-Control ActivityCoinLoader compromises observed across the Darktrace customer base were typically identified by encrypted C2 connections over port 433 to rare external endpoints using self-signed certificates containing "OU=IT,O=MyCompany LLC,L=San Francisco,ST=California,C=US" in their issue fields.All observed CoinLoader C2 servers were associated with the ASN of MivoCloud, a Virtual Private Server (VPS) hosting service (AS39798 MivoCloud SRL). It had been reported that Russian-state sponsored threat actors had previously abused MivoCloud’s infrastructure in order to bypass geo-blocking measures during phishing attacks against western nations [5].Darktrace observed that the majority of CoinLoader infrastructure utilized IP addresses in the 185.225.0.0/19 range and were associated with servers hosted in Romania, with just one instance of an IP address based in Moldova. The domain names of these servers typically followed the naming pattern ‘*[a-d]{1}[.]info’, with 'ams-updatea[.]info’, ‘ams-updateb[.]info’, ‘ams-updatec[.]info’, and ‘ams-updated[.]info’ routinely identified on affected networks.Researchers found that CoinLoader typically uses DNS tunnelling in order to covertly exchange information with attacker-controlled infrastructure, including the domains ‘candatamsnsdn[.]info’, ‘mapdatamsnsdn[.]info’, ‘rqmetrixsdn[.]info’ [4].While Darktrace did not observe these particular domains, it did observer similar DNS lookups to a similar suspicous domain, namely ‘ucmetrixsdn[.]info’, in addition to the aforementioned HTTPS C2 connections.Cryptomining Activity and Possible Additional ToolingAfter establishing communication channels with CoinLoader servers, affected devices were observed carrying out a range of cryptocurrency mining activities. Darktrace detected devices connecting to multiple MivoCloud associated IP addresses using the MinerGate protocol alongside the credential “x”, a MinerGate credential observed by Darktrace in previous cryptojacking compromises, including the Sysrv-hello botnet.Figure 1: Darktrace DETECT breach log showing an alerted mining activity model breach on an infected device.Figure 2: Darktrace's Cyber AI Analyst providing details about unusual repeated connections to multiple endpoints related to CoinLoader cryptomining.In a number of customer environments, Darktrace observed affected devices connected to endpoints associated with other malware such as the Andromeda botnet and the ViperSoftX information stealer. It was, however, not possible to confirm whether CoinLoader had dropped these additional malware variants onto infected devices.On customer networks where Darktrace RESPOND was enabled in autonomous response mode, Darktrace was able to take swift targeted steps to shut down suspicious connections and contain CoinLoader compromises. In one example, following DETECT’s initial identification of an affected device connecting to multiple MivoCloud endpoints, RESPOND autonomously blocked the device from carrying out such connections, effectively shutting down C2 communication and preventing threat actors carrying out any cryptomining activity, or downloading subsequent malicious payloads. The autonomous response capability of RESPOND provides customer security teams with precious time to remove infected devices from their network and action their remediation strategies.Figure 3: Darktrace RESPOND autonomously blocking CoinLoader connections on an affected device.Additionally, customers subscribed to Darktrace’s Proactive Threat Notification (PTN) service would be alerted about potential CoinLoader activity observed on their network, prompting Darktrace’s Security Operations Center (SOC) to triage and investigate the activity, allowing customers to prioritize incidents that require immediate attention.Conclusion By masquerading as free or ‘cracked’ versions of legitimate popular software, loader malware like CoinLoader is able to indiscriminately target a large number of endpoint users without arousing suspicion. What’s more, once a network has been compromised by the loader, it is then left open to a secondary compromise in the form of potentially costly information stealers, ransomware or, in this case, cryptocurrency miners.While urging employees to think twice before installing seemingly legitimate software unknown or untrusted locations is an essential first step in protecting an organization against threats like CoinLoader, its stealthy tactics mean this may not be enough.In order to fully safeguard against such increasingly widespread yet evasive threats, organizations must adopt security solutions that are able to identify anomalies and subtle deviations in device behavior that could indicate an emerging compromise. The Darktrace suite of products, including DETECT and RESPOND, are well-placed to identify and contain these threats in the first instance and ensure they cannot escalate to more damaging network compromises. Credit to: Signe Zaharka, Senior Cyber Security Analyst, Paul Jennings, Principal Analyst ConsultantAppendixDarktrace DETECT Model Detections Anomalous Connection/Multiple Connections to New External TCP PortAnomalous Connection/Multiple Failed Connections to Rare EndpointAnomalous Connection/Rare External SSL Self-SignedAnomalous Connection/Repeated Rare External SSL Self-SignedAnomalous Connection/Suspicious Self-Signed SSLAnomalous Connection/Young or Invalid Certificate SSL Connections to RareAnomalous Server Activity/Rare External from ServerCompromise/Agent Beacon (Long Period)Compromise/Beacon for 4 DaysCompromise/Beacon to Young EndpointCompromise/Beaconing Activity To External RareCompromise/High Priority Crypto Currency MiningCompromise/High Volume of Connections with Beacon ScoreCompromise/Large Number of Suspicious Failed ConnectionsCompromise/New or Repeated to Unusual SSL PortCompromise/Rare Domain Pointing to Internal IPCompromise/Repeating Connections Over 4 DaysCompromise/Slow Beaconing Activity To External RareCompromise/SSL Beaconing to Rare DestinationCompromise/Suspicious File and C2 Compromise/Suspicious TLS Beaconing To Rare ExternalDevice/ Anomalous Github DownloadDevice/ Suspicious DomainDevice/Internet Facing Device with High Priority AlertDevice/New Failed External ConnectionsIndicators of Compromise (IoCs)IoC - Hostname C2 Serverams-updatea[.]infoams-updateb[.]infoams-updatec[.]infoams-updated[.]infocandatamsna[.]infocandatamsnb[.]infocandatamsnc[.]infocandatamsnd[.]infomapdatamsna[.]infomapdatamsnb[.]infomapdatamsnc[.]infomapdatamsnd[.]infores-smarta[.]infores-smartb[.]infores-smartc[.]infores-smartd[.]inforqmetrixa[.]inforqmetrixb[.]inforqmetrixc[.]inforqmetrixd[.]infoucmetrixa[.]infoucmetrixb[.]infoucmetrixc[.]infoucmetrixd[.]infoany-updatea[.]icu‍IoC - IP Address - C2 Server185.225[.]16.192185.225[.]16.61185.225[.]16.62185.225[.]16.63185.225[.]16.88185.225[.]17.108185.225[.]17.109185.225[.]17.12185.225[.]17.13185.225[.]17.135185.225[.]17.14185.225[.]17.145185.225[.]17.157185.225[.]17.159185.225[.]18.141185.225[.]18.142185.225[.]18.143185.225[.]19.218185.225[.]19.51194.180[.]157.179194.180[.]157.185194.180[.]158.55194.180[.]158.56194.180[.]158.62194.180[.]158.635.252.178[.]7494.158.246[.]124‍IoC - IP Address - Cryptocurrency mining related endpoint185.225.17[.]114185.225.17[.]118185.225.17[.]130185.225.17[.]131185.225.17[.]132185.225.17[.]142‍IoC - SSL/TLS certificate issuer information - C2 server certificate exampleemailAddress=admin@example[.]ltd,CN=example[.]ltd,OU=IT,O=MyCompany LLC,L=San Francisco,ST=California,C=USemailAddress=admin@'res-smartd[.]info,CN=res-smartd[.]info,OU=IT,O=MyCompany LLC,L=San Francisco,ST=California,C=USCN=ucmetrixd[.]info,OU=IT,O=MyCompany LLC,L=San Francisco,ST=California,C=US‍MITRE ATT&CK Mapping ‍INITIAL ACCESS Exploit Public-Facing Application - T1190Spearphishing Link - T1566.002 Drive-by Compromise - T1189‍COMMAND AND CONTROL Non-Application Layer Protocol - T1095Non-Standard Port - T1571External Proxy - T1090.002Encrypted Channel - T1573Web Protocols - T1071.001Application Layer Protocol - T1071DNS - T1071.004 Fallback Channels - T1008Multi-Stage Channels - T1104‍PERSISTENCE Browser ExtensionsT1176‍RESOURCE DEVELOPMENTWeb Services - T1583.006Malware - T1588.001‍COLLECTIONMan in the Browser - T1185‍IMPACTResource Hijacking - T1496References1. https://www.avira.com/en/blog/coinloader-a-sophisticated-malware-loader-campaign2. https://asec.ahnlab.com/en/17909/ 3. https://www.cybereason.co.jp/blog/cyberattack/5687/4. https://research.checkpoint.com/2023/tunnel-warfare-exposing-dns-tunneling-campaigns-using-generative-models-coinloader-case-study/ 5. https://securityboulevard.com/2023/02/three-cases-of-cyber-attacks-on-the-security-service-of-ukraine-and-nato-allies-likely-by-russian-state-sponsored-gamaredon/Continue readingAbout the authorSigne ZaharkaSenior Cyber Security AnalystGood news for your business.Bad news for the bad guys.Start your free trialStart your free trialFlexible deliveryCloud-based deployment.Fast installJust 1 hour to set up – and even less for an email security trial.Choose your journeyTry out Self-Learning AI wherever you most need it — including cloud, network or email.No commitmentFull access to the Darktrace Threat Visualizer and three bespoke Threat Reports, with no obligation to purchase.EmailFirst NameLast NameOrganizationJob TitlePhone NumberCountryStateOrganization Size50 employees or fewer51 to 250 employees251 to 500 employees501 to 1,000 employees1,001 to 5,000 employeesMore than 5,000 employeesYes, I would like to receive marketing emails from Darktrace about their offerings.For more information, please see our Privacy Notice.Thanks, your request has been receivedA member of our team will be in touch with you shortly.YOU MAY FIND INTERESTINGFive Key Takeaways from Black Hat 2023Hives & Frankensteins: The Half-Year Threat ReportOops! Something went wrong while submitting the form.Get a demoFlexible deliveryYou can either install it virtually or with hardware.Fast installJust 1 hour to set up – and even less for an email security trial.Choose your journeyTry out Self-Learning AI wherever you most need it — including cloud, network or email.No commitmentFull access to the Darktrace Threat Visualizer and three bespoke Threat Reports, with no obligation to purchase.NameEmailOrganizationJob TitlePhone NumberCountryStateOrganization Size50 employees or fewer51 to 250 employees251 to 500 employees501 to 1,000 employees1,001 to 5,000 employeesMore than 5,000 employeesYes, I would like to receive marketing emails from Darktrace about their offerings.For more information, please see our Privacy Notice.Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Evolving threats call for evolved thinking™ProductsDarktrace PREVENTDarktrace DETECTDarktrace RESPONDDarktrace HEALCore CoverageCloudAppsEmailEndpointZero TrustNetworkOTAI Research CentreOverviewCompanyCompany OverviewNewsInvestorsCareersPartnersPartners OverviewTechnology PartnersIntegrationsResourcesAll ResourcesBlogEventsWebinarsGlossaryLegalPrivacy PolicyCookie PolicyModern Slavery Act StatementPublic Tax StrategyVulnerability Disclosure PolicyCopyright © 2023 - 2024 Darktrace Holdings Limited. All rights reserved. Background design inspired by Rik Oostenbroek.Sitemap






Check out this article by Darktrace: APT35 ‘Charming Kitten' discovered in a pre-infected environment

