# Reference for threat actor for "Kimsuky, Velvet Chollima"

**Title**: CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) - ASEC BLOG

**Source**: https://asec.ahnlab.com/en/49295/

## Content


















CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) - ASEC BLOG





































































 

Malware Information
AhnLab Detection
Statistics
Response Guide
AhnLab
 














Posted By yeeun  , March 13, 2023 

CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) 
AhnLab Security Emergency response Center (ASEC) has recently discovered a CHM malware which is assumed to have been created by the Kimsuky group. This malware type is the same as the one covered in the following ASEC blog posts and the analysis report on the malware distributed by the Kimsuky group, its goal being the exfiltration of user information.

Analysis Report on Malware Distributed by the Kimsuky Group – Oct 20, 2022
APT Attack Being Distributed as Windows Help File (*.chm) – Mar 17, 2022
Malicious Help File Disguised as Missing Coins Report and Wage Statement  (*.chm) – May 11, 2022

The CHM file has been compressed and is being distributed as an email attachment. The first email that is sent pretends to be an interview request about matters related to North Korea. If the email recipient accepts the interview, then a password-protected compressed file is sent as an attachment. Not only is this email pretending to be a North Korea-related interview identical to the one previously analyzed, but it also follows the same format of sending the malicious file only when a recipient replies to the email.

Malware Disguised as Normal Documents (Kimsuky) – Feb 03, 2023
Word File Provided as External Link When Replying to Attacker’s Email  (Kimsuky) – July 26, 2022



Figure 1. Distributed email



Figure 2. Original email



Figure 3. Inside the compressed file

When the InterviewQuestionnaire(***).chm file is executed, a help document with actual questions appears as shown below, making it difficult for users to realize that the file is malicious.


Figure 4. CHM disguised as a questionnaire

The CHM holds a malicious script, and, like the CHM malware covered before, it uses a shortcut object (ShortCut). The shortcut object is called through the Click method and the command in Item1 is executed. The command executed through ‘InterviewQuestionnaire(***).chm’ is as follows.

Executed Command
cmd, /c echo [Encoded Command] > “%USERPROFILE%\Links\Document.dat & start /MIN certutil -decode “%USERPROFILE%\Links\Document.dat” “%USERPROFILE%\Links\Document.vbs” & start /MIN REG ADD HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Document /t REG_SZ /d “%USERPROFILE%\Links\Document.vbs” /f’



Figure 5. Malicious Script within CHM

Thus, the encoded command is saved to %USERPROFILE%\Links\Document.dat when the CHM is executed. The command that has been decoded by Certutil is saved to %USERPROFILE%\Links\Document.vbs. The threat actor also registered Document.vbs to the Run key (HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run) to ensure the malicious script would run persistently. Ultimately, Document.vbs executes the PowerShell script in hxxp://mpevalr.ria[.]monster/SmtInfo/demo.txt.


Figure 6. (Top) A portion of Document.vbs’s code / (Bottom) A portion of the vbs code uncovered in a past report

The URL that Document.vbs connects to is currently unavailable, but a script assumed to have been downloaded from this address has been found. The confirmed script file is responsible for intercepting a user’s key inputs before saving them in a certain file and sending that file to the threat actor. In addition to reading the caption of the currently running ForegroundWindow and keylogging, it periodically checks the clipboard contents and saves them to the %APPDATA%\Microsoft\Windows\Templates\Pages_Elements.xml file. Afterward, it sends this file to hxxp://mpevalr.ria[.]monster/SmtInfo/show.php.


Figure 7. (Top) A portion of demo.txt / (Bottom) A portion of the PowerShell script code from a past report

As can be seen from Figure 6 and Figure 7, Document.vbs (VBS script file) and demo.txt (PowerShell script file) have the same format as the malware that was analyzed in the ‘Analysis Report on Malware Distributed by the Kimsuky Group’ published on ATIP last year. With this in mind, users should take extreme caution as the Kimsuky group appears to be distributing phishing emails with malware strains in various forms like Word files and CHM.
[File Detection]
Dropper/CHM.Generic (2023.03.07.00)
Data/BIN.Encoded (2023.03.07.00)
Downloader/VBS.Agent.SC186747 (2023.03.07.00)
Trojan/PowerShell.Agent.SC186246 (2023.02.09.00)
[Behavior Detection]
Execution/MDP.Cmd.M4230
[IOC]
MD5
726af41024d06df195784ae88f2849e4 (chm)
0f41d386e30e9f5ae5be4a707823fd78 (dat)
89c0e93813d3549efe7274a0b9597f6f (vbs)
9f560c90b7ba6f02233094ed03d9272e
C2
hxxp://mpevalr.ria[.]monster/SmtInfo/demo.txt
hxxp://mpevalr.ria[.]monster/SmtInfo/show.php
Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.



Categories:Malware Information 
Tagged as:chm,Kimsuky 




Netcat Attack Cases Targeting MS-SQL Servers (LOLBins) 

Mallox Ransomware Being Distributed in Korea 







5
2
votes
Article Rating

 





 Subscribe




 Login 




Notify of 


new follow-up comments
new replies to my comments








 







 


Label












{}
[+]

 















Name*





Email





Website






[Important] Consent to Collection and Use of Personal Information


Purpose: Identify the contact information of user who left a comment and respond to inquiries on our blog posts.
Personal Information We Collect: Name of user and organization, Email address
Period of Retention: We store personal information for 3 months. Then, we delete and destroy personal information without delay.

 



I agree to AhnLab’s collection and use of personal information.




















Δ 










 


Label












{}
[+]

 















Name*





Email





Website






[Important] Consent to Collection and Use of Personal Information


Purpose: Identify the contact information of user who left a comment and respond to inquiries on our blog posts.
Personal Information We Collect: Name of user and organization, Email address
Period of Retention: We store personal information for 3 months. Then, we delete and destroy personal information without delay.

 



I agree to AhnLab’s collection and use of personal information.




















Δ 






29 Comments                    









 Inline Feedbacks                    
View all comments











CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) - Ciberdefensa



    11 months ago













[…] post CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) appeared first on ASEC […]






0






Reply













CHM malware – Yet Another News Aggregator Channel



    11 months ago













[…] FORRÁS […]






0






Reply













Researchers Reveal New Malware Distribution Techniques - The Cyberweb



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Researchers Reveal New Malware Distribution Techniques



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Researchers Reveal New Malware Distribution Techniques - Cyberstache.com



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Researchers Reveal New Malware Distribution Techniques - Cryptonounce.com



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













L'arsenal en évolution de ScarCruft : des chercheurs révèlent de nouvelles techniques de distribution de logiciels malveillants - Teknomers Nouvelles



    10 months ago













[…] se répandre auprès d’autres groupes affiliés à la Corée du Nord, avec l’ASEC découvrir une campagne de phishing orchestrée par Kimsuky pour distribuer une porte dérobée chargée de […]






0






Reply













Researchers Reveal New Malware Distribution Techniques -



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Cyber Security



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft’s Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques – Auto Translate News



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC  uncovering a phishing campaign orchestrated by  Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Researchers Reveal New Malware Distribution Techniques – b0x



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft’s Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques – Cyber Social Hub



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













El arsenal en evolución de ScarCruft: los investigadores revelan nuevas técnicas de distribución de malware - Teknomers Noticias



    10 months ago













[…] también parece estar ganando terreno en otros grupos afiliados a Corea del Norte, como ASEC. descubriendo una campaña de phishing orquestada por Kimsuky para distribuir una puerta trasera responsable de […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Lite Jade



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimusky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques – Sentria



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Můj Linux - #Debian, #xUbuntu, #Servery



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Researchers Reveal New Malware Distribution Techniques – Ady DeeJay :: Professional Freelancer



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Tech News



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft’s Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Shackle Media



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft’s Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - SPIXNET C2S



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Digital Creations LLC



    10 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques - Domedigita



    9 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply













Emulating Kimsuky's Espionage Operations - AttackIQ



    9 months ago













[…] first attack graph is primarily based on a series of attacks reported by AhnLab in March 2023, May 2022, and March 2022. This infection chain focuses on the use of Compiled HTML Help (CHM) […]






0






Reply













Kimsuky Group Using Meterpreter to Attack Web Servers - ASEC BLOG



    8 months ago













[…] malicious file attachments to emails in MS Office document files[2],  OneNote [3], or CHM [4]file formats. Kimsuky group usually uses social engineering attacks like the aforementioned spear […]






0






Reply













Kimsuky | Ongoing Campaign Using Tailored Reconnaissance Toolkit - The Network Company | Cyber Security | IT Services | Network Security



    8 months ago













[…] approach of delivering malware through CHM files, such as keylogging and clipboard content theft malware. In line with their modus operandi, Kimsuky distributes the RandomQuery variant we observed through […]






0






Reply













Kimsuky - Italia | Campagna in corso utilizzando il toolkit di ricognizione su misura - Matrice Digitale



    8 months ago













[…] coerente del gruppo di distribuire malware attraverso i file CHM, come il keylogging e il malware per il furto di contenuti negli appunti. In linea con il loro modus operandi, Kimsuky […]






0






Reply













Similar AhnLab Response Cases Regarding Korea-US Joint Cyber Security Advice - Ciberdefensa



    8 months ago













[…] Mar. 8, 2023 CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) Link […]






0






Reply













Kimsuky: North Korean hacker group attacks human rights activists and defectors - SPIXNET C2S



    8 months ago













[…] it an ideal target for threat actors wanting to pose as legitimate. The attached document is a  CHM file stored in a password-protected archive. The document is entitled “Difficulties in the […]






0






Reply













ScarCruft's Evolving Arsenal: Researchers Reveal New Malware Distribution Techniques



    7 months ago













[…] malware appears to be catching on with other North Korea-affiliated groups as well, with ASEC uncovering a phishing campaign orchestrated by Kimsuky to distribute a backdoor responsible for harvesting […]






0






Reply




 













Archives Archives

Select Month
 February 2024 
 January 2024 
 December 2023 
 November 2023 
 October 2023 
 September 2023 
 August 2023 
 July 2023 
 June 2023 
 May 2023 
 April 2023 
 March 2023 
 February 2023 
 January 2023 
 December 2022 
 November 2022 
 October 2022 
 September 2022 
 August 2022 
 July 2022 
 June 2022 
 May 2022 
 April 2022 
 March 2022 
 February 2022 
 January 2022 
 December 2021 
 November 2021 
 October 2021 
 September 2021 
 August 2021 
 July 2021 
 June 2021 
 May 2021 
 April 2021 
 March 2021 
 February 2021 
 January 2021 
 December 2020 
 November 2020 
 September 2020 
 August 2020 
 July 2020 
 June 2020 
 May 2020 
 April 2020 
 March 2020 
 February 2020 
 December 2019 
 November 2019 
 October 2019 
 September 2019 
 August 2019 
 June 2019 
 May 2019 
 April 2019 
 March 2019 
 February 2019 
 January 2019 
 November 2018 
 July 2018 
 April 2018 
 February 2018 


FOLLOW US


LinkedIn   


X   


RSS Feed   









footer(en) 220, Pangyoyeok-ro, Bundang-gu, Seongnam-si, Gyeonggi-do, Korea | Privacy & Security© AhnLab, Inc. All rights reserved.family site


한국 (한국어)
Global (English)
日本 (日本語)
 




wpDiscuzInsert 









 




















































































Loading Comments...



 


Write a Comment...




Email



Name



Website















































































































































































































































