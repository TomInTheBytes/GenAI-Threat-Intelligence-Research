# Reference for threat actor for "Kimsuky, Velvet Chollima"

**Title**: Malware Disguised as HWP Document File (Kimsuky) - ASEC BLOG

**Source**: https://asec.ahnlab.com/en/54736/

## Content


















Malware Disguised as HWP Document File (Kimsuky) - ASEC BLOG





































































 

Malware Information
AhnLab Detection
Statistics
Response Guide
AhnLab
 














Posted By yeeun  , June 23, 2023 

Malware Disguised as HWP Document File (Kimsuky) 
AhnLab Security Emergency response Center (ASEC) has recently confirmed malware, which was previously distributed in CHM and OneNote file formats, being distributed as an executable. Considering that the words used in the malware and the executed script code are similar to that of previously analyzed codes, it is suspected that the same threat group (Kimsuky) is also the creator of this malware.

Analysis Report on Malware Distributed by the Kimsuky Group – Oct 20, 2022
OneNote Malware Disguised as Compensation Form (Kimsuky) – Mar 24, 2023
CHM Malware Disguised as North Korea-related Questionnaire (Kimsuky) – Mar 13, 2023
Kimsuky’s Attack Attempts Disguised as Press Releases of Various Topics – May 25, 2022
APT Attack Attempts Disguised as North Korea-Related Paper Requirements (Kimsuky) – Feb 22, 2022

The identified malware is distributed as a compressed file which contains a readme.txt along with an executable disguised with an HWP document file extension.

Figure 1. Inside the compressed file
The readme.txt file contains the following message which prompts users to open the malicious EXE file (Personal Data Leakage Details.hwp.exe). The malicious EXE file was compiled with .NET and uses the HWP document icon to disguise itself to appear like a document file. Multiple spaces were also inserted into the file name to prevent the file extension from being fully visible.

Figure 2. readme.txt file and executable
The above EXE file contains a PowerShell command encoded in Base64. Thus, when the file is executed, this command is decoded and saved as update.vbs in the %APPDATA% folder. The generated update.vbs file is then executed through PowerShell.

Figure 3. Code within the executable
The following message box is then generated, rendering it difficult for users to realize that malicious behaviors are being performed. The message contains North Korean dialect as shown in Figure 4 below.

Figure 4. Created message box
The created update.vbs file contains obfuscated commands. Decoding this reveals a code that downloads and executes an additional script from hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=1.

Figure 5. Contents of update.vbs
Both the script present in the above URL and the subsequent scripts executed perform functions such as user credential leakage and keylogging, which are consistent with the findings in the <Analysis Report on Malware Distributed by the Kimsuky Group>. The identified URL and features of the created file are as follows.
URL and FilenameFeatureupdate.vbs– Changes a certain registry– Runs the script hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=1hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=1– Changes a certain registry– Creates OfficeAppManifest_v[Min]_[Hr]_[Day][Month].xml and registers it as a service– Runs the script hxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=1OfficeAppManifest_v[Min]_[Hr]_[Day][Month].xml– Runs the script hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=6hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=6– Runs the script hxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=5hxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=5– Keylogger– Transmits keylogging data to hxxp://well-story.co[.]kr/adm/inc/js/show.phphxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=1– Collects user PC information– Transmits the collected information to hxxp://well-story.co[.]kr/adm/inc/js/show.phpTable 1. Features of the scripts found on a certain URL and the generated files
The information collected at this stage also matches those of the aforementioned report.

Figure 6. List of exfiltrated information confirmed in the <Analysis Report on Malware Distributed by the Kimsuky Group>
Given the continuous detection of this malware type being distributed, users are advised to exercise extra caution. Users should always verify the file extension when opening email attachments and refrain from executing files received from unknown sources.
[File Detection]
Dropper/Win.Agent.C5441936 (2023.06.16.02)Trojan/VBS.Kimsuky (2023.03.21.03)Trojan/PowerShell.Obfuscated (2023.03.14.00)Trojan/PowerShell.KeyLogger (2023.05.09.00)
[IOC]
MD58133c5f663f89b01b30a052749b5a988 (exe)91029801f6f3a415392ccfee8226be67 (script)73174c9d586531153a5793d050a394a8 (script)f05991652398406655a6a5eebe3e5f3a (script)ec1b518541228072eb75463ce15c7bce (script)
URLhxxp://well-story.co[.]kr/adm/inc/js/list.php?query=1hxxp://well-story.co[.]kr/adm/inc/js/list.php?query=6hxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=1hxxp://well-story.co[.]kr/adm/inc/js/lib.php?idx=5hxxp://well-story.co[.]kr/adm/inc/js/show.php
Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and detailed analysis information.


Categories:Malware Information 
Tagged as:Kimsuky 




RedEyes Group Wiretapping Individuals (APT37) 

ASEC Weekly Phishing Email Threat Trends (June 11th, 2023 – June 17th, 2023) 







4
3
votes
Article Rating

 





 Subscribe




 Login 




Notify of 


new follow-up comments
new replies to my comments








 







 


Label












{}
[+]

 















Name*





Email





Website






[Important] Consent to Collection and Use of Personal Information


Purpose: Identify the contact information of user who left a comment and respond to inquiries on our blog posts.
Personal Information We Collect: Name of user and organization, Email address
Period of Retention: We store personal information for 3 months. Then, we delete and destroy personal information without delay.

 



I agree to AhnLab’s collection and use of personal information.




















Δ 










 


Label












{}
[+]

 















Name*





Email





Website






[Important] Consent to Collection and Use of Personal Information


Purpose: Identify the contact information of user who left a comment and respond to inquiries on our blog posts.
Personal Information We Collect: Name of user and organization, Email address
Period of Retention: We store personal information for 3 months. Then, we delete and destroy personal information without delay.

 



I agree to AhnLab’s collection and use of personal information.




















Δ 






1 Comment                    









 Inline Feedbacks                    
View all comments











Warning Against Distribution of Malware Impersonating a Public Organization (LNK) - Ciberdefensa



    3 months ago













[…] The malware’s operation method and C2 format are similar to those in previously published posts, [1] [2] allowing us to assume that the same threat actor is behind this […]






0






Reply




 













Archives Archives

Select Month
 February 2024 
 January 2024 
 December 2023 
 November 2023 
 October 2023 
 September 2023 
 August 2023 
 July 2023 
 June 2023 
 May 2023 
 April 2023 
 March 2023 
 February 2023 
 January 2023 
 December 2022 
 November 2022 
 October 2022 
 September 2022 
 August 2022 
 July 2022 
 June 2022 
 May 2022 
 April 2022 
 March 2022 
 February 2022 
 January 2022 
 December 2021 
 November 2021 
 October 2021 
 September 2021 
 August 2021 
 July 2021 
 June 2021 
 May 2021 
 April 2021 
 March 2021 
 February 2021 
 January 2021 
 December 2020 
 November 2020 
 September 2020 
 August 2020 
 July 2020 
 June 2020 
 May 2020 
 April 2020 
 March 2020 
 February 2020 
 December 2019 
 November 2019 
 October 2019 
 September 2019 
 August 2019 
 June 2019 
 May 2019 
 April 2019 
 March 2019 
 February 2019 
 January 2019 
 November 2018 
 July 2018 
 April 2018 
 February 2018 


FOLLOW US


LinkedIn   


X   


RSS Feed   









footer(en) 220, Pangyoyeok-ro, Bundang-gu, Seongnam-si, Gyeonggi-do, Korea | Privacy & Security© AhnLab, Inc. All rights reserved.family site


한국 (한국어)
Global (English)
日本 (日本語)
 




wpDiscuzInsert 









 




















































































Loading Comments...



 


Write a Comment...




Email



Name



Website















































































































































































































































