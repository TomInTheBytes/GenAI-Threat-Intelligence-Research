# Reference for threat actor for "Roaming Mantis"

**Title**: MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play | McAfee Blog

**Source**: https://www.mcafee.com/blogs/other-blogs/mcafee-labs/moqhao-related-android-spyware-targeting-japan-and-korea-found-on-google-play/

## Content















MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play | McAfee Blog





















































































Products






                                                        All-In-One Protection 



NEW McAfee+ Individual
                                                                    Plans
                                                                
Complete privacy,
                                                                    identity and device protection for individuals. 




NEW McAfee+ Family
                                                                    Plans
                                                                
 Complete privacy,
                                                                    identity and device protection for up to 6 family
                                                                    members. 





Other Products & Services


                                                                Antivirus 
 Scam Protection 

                                                                Virtual Private Network (VPN)
 Mobile Security
 PC
                                                                Optimizer
 TechMaster Concierge
                                                            

                                                                McAfee Assist 



Free Tools & Downloads


                                                                Web Protection
 Free Antivirus Trial
                                                            
 Device Security Scan
                                                            
 Password Generator 








Features





Keep Me Private Online

Personal Data
                                                                Cleanup
Online Account
                                                                Cleanup
VPN (Virtual
                                                                Private Network)
Social Privacy
                                                                Manager



Safeguard My Identity

Identity Monitoring

Credit Monitoring

Security Freeze

                                                                Identity Theft Coverage & Restoration
Password Manager



Protect My Devices


                                                                Antivirus 

                                                                Scam Protection 

                                                                Web Protection 



Protect My Family

 Protection Score
Parental Controls

Family Plans







Resources





Stay Updated

McAfee Blog
Reports and Guides

McAfee on YouTube

Prevent Spam and
                                                                Phishing



Learn More

Learn at McAfee
What is Antivirus?

What is a VPN?
What is Identity
                                                                Theft?



Press & News

McAfee Newsroom
AI News & Scams








About Us





Our Company

Company Overview
Awards &
                                                                Reviews
Investors



Our Efforts

Inclusion &
                                                                Diversity
Integrity &
                                                                Ethics
Public Policy



Join Us

Careers
Life at McAfee
Our Teams
Our Locations







Why McAfee





 Products 



                                            All-In-One Protection

NEW
                                                    McAfee+ Individual Plans 
Complete privacy, identity and device
                                                protection for individuals.


NEW McAfee+
                                                    Family Plans 
Complete privacy, identity and device
                                                protection for up to 6 family members.

Other Products & Services
 Antivirus 
 Scam Protection 
 Virtual Private Network (VPN) 
 Mobile Security 
 PC Optimizer 
 TechMaster Concierge 
 McAfee Assist 
Free Tools & Downloads
 Web Protection 
 Free
                                                Antivirus Trial 
 Device Security Scan 

                                                Password Generator 




                                    Features 


Keep Me Private Online
Personal Data Cleanup
Online Account Cleanup
 VPN (Virtual Private Network) 

                                                Social Privacy Manager 
Safeguard My Identity
Identity Monitoring 
 Credit Monitoring 
Security Freeze 
 Identity Theft Coverage & Restoration
                                            
 Password Manager 
Protect My Devices
 Antivirus 
 Scam Protection 
 Web Protection 
Protect My Family
Protection Score
Parental Controls
Family Plans




                                    Resources 


Stay Updated
 McAfee Blog 
 Reports and Guides 
 McAfee
                                                on YouTube 

                                                Prevent Spam and Phishing 
Learn More
 Learn at
                                                McAfee 
 What is Antivirus? 
 What is a VPN? 
What
                                                is Identity Theft?
Press & News
 McAfee Newsroom 
 AI News & Scams
                                            



 About
                                    Us 


Our Company
Company Overview 
 Awards & Reviews 
 Investors 
Our Efforts
 Inclusion & Diversity 
 Integrity & Ethics 
 Public Policy 
Join Us
 Careers 
 Life at McAfee 
 Our Teams 
Our Locations




                                    Why McAfee 
 Support
                                


Help
Customer Support

Support
                                                Community
 FAQs 
 Contact Us 
Activation
 Activate Retail Card 










Region



Asia Pacific

Australia - English
New Zealand - English

Singapore - English
Malaysia - English
Philippines - English

India - English
대한민국 - 한국어
日本 - 日本語
中国 - 简体中文
香港特別行政區 - 繁體中文
台灣 - 繁體中文

Europe

Česká Republika - Čeština
Danmark - Dansk
Suomi - Suomi
France - Français
Deutschland - Deutsch

Ελλάδα - Ελληνικά
Ireland - English
Magyarország - Magyar

ישראל -
                                                עברית
Italia - Italiano
Nederland - Nederlands

Norge - Bokmål
Polska - Polski
Portugal - Português
Россия - Русский
España - Español
Sverige - Svenska
Suisse - Français
Schweiz - Deutsch
Türkiye - Türkçe
العربية
                                                - العربية
United Kingdom - English


North America

United States - English

Canada - English
Canada - Français

South America

Argentina - Español
Brasil - Português
Chile - Español
Colombia - Español
México - Español
Perú - Español




Sign in




Support 





Help

Customer Support
Support Community
FAQs
Contact Us



Activation

Activate Retail Card



















Asia Pacific

Australia-English
New
                                                                Zealand-English
Singapore-English
Malaysia-English
Philippines-English

India-English
대한민국-한국어
日本-日本語
中国-简体中文
香港特別行政區-繁體中文
台灣-繁體中文



Europe

Česká Republika-Čeština

Danmark-Dansk
Suomi-Suomi
France-Français
Deutschland-Deutsch

Ελλάδα-Ελληνικά
Ireland-English
Magyarország-Magyar

ישראל-עברית

Italia-Italiano
Nederland-Nederlands




 

Norge-Bokmål
Polska-Polski
Portugal-Português
Россия-Русский
España-Español
Sverige-Svenska
Suisse-Français
Schweiz-Deutsch
Türkiye-Türkçe
العربية-العربية

United Kingdom-English




North America

United States-English

Canada-English
Canada-Français



South America

Argentina-Español
Brasil-Português
Chile-Español
Colombia-Español
México-Español
Perú-Español









Sign in
















                                    Blog
Topics



Internet Security
Mobile Security
Family Safety
Privacy & Identity Protection
Security News
Tips & Tricks




At McAfee



McAfee News
Executive Perspectives
McAfee Labs
Life at McAfee
Hackable? Podcast






  







English



Portuguese (BR)



Spanish



French(FR)



German



Italian



Japanese



French(CA)



Portuguese (PT)



Spanish (MX)








  










Blog
Topics  



Internet Security
Mobile Security
Family Safety
Privacy & Identity Protection
Security News
Tips & Tricks




At McAfee  



McAfee News
Executive Perspectives
McAfee Labs
Life at McAfee
Hackable? Podcast










. 






 


Portuguese (BR)
Spanish
French(FR)
German
Italian
Japanese
French(CA)
Portuguese (PT)
Spanish (MX)















 

 


Blog Other Blogs McAfee Labs MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play 
 





MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play







Chanung Pak


Aug 07, 2019


   7  MIN READ 


 




The McAfee mobile research team has found a new type of Android malware for the MoqHao phishing campaign (a.k.a. XLoader and Roaming Mantis) targeting Korean and Japanese users. A series of attack campaigns are still active, mainly targeting Japanese users. The new spyware has very different payloads from the existing MoqHao samples. However, we found evidence of a connection between the distribution method used for the existing campaign and this new spyware. All the spyware we found this time pretends to be security applications targeting users in Japan and Korea. We discovered a phishing page related to DNS Hijacking attack, designed to trick the user into installing the new spyware, distributed on the Google Play store.
Fake Japanese Security Apps Distributed on Google Play
We found two fake Japanese security applications. The package names are com.jshop.test and com.jptest.tools2019. These packages were distributed on the Google Play store. The number of downloads of these applications was very low. Fortunately, the spyware apps had been immediately removed from the Google Play store, so we acquired the malicious bullets thanks to the Google Android Security team.

Figure 1. Fake security applications distributed on Google Play
This Japanese spyware has four command and control functions. Below is the server command list used with this spyware. The spyware attempts to collect device information like IMEI and phone number and steal SMS/MMS messages on the device. These malicious commands are sent from a push service of Tencent Push Notification Service.

Figure 2. Command registration into mCommandReceiver
Table 1. The command lists

*1 Not implemented correctly due to the difference from the functionality guessed from the command name
We believe that the cybercriminal included minimal spyware features to bypass Google’s security checks to distribute the spyware on the Google Play store, perhaps with the intention of adding additional functionality in future updates, once approved.
Fake Korean Police Apps
Following further investigation, we found other very similar samples to the above fake Japanese security applications, this time targeting Korean users. A fake Korean police application disguised itself as an anti-spyware application. It was distributed with a filename of cyber.apk on a host server in Taiwan (that host has previously been associated with malicious phishing domains impersonating famous Japanese companies). It used the official icon of the Korean police application and a package name containing ‘kpo’, along with references to com.kpo.scan and com.kpo.help, all of which relate to the Korean police.

Figure 3. This Korean police application icon was misappropriated
The Trojanized package was obfuscated by the Tencent packer to hide its malicious spyware payload. Unlike the existing samples used in the MoqHao campaign, where the C&C server address was simply embedded in the spyware application; MoqHao samples hide and access the control server address via Twitter accounts.
The malware has very similar spyware functionality to the fake Japanese security application. However, this one features many additional commands compared to the Japanese one. Interestingly, the Tencent Push Service is used to issue commands to the infected user.

Figure 4. Tencent Push Service
The code and table below show characteristics of the server command and content list.

Figure 5. Command registration into mCommandReceiver
Table 2. The command lists

*1 Seems to be under construction due to the difference from the functionality guessed from the command name
There are several interesting functions implemented in this spyware. To execute an automated phone call function on a default calling application, KAutoService class has an implementation to check content in the active window and automatically click the start call button.

Figure 6. KAutoSevice class clicks start button automatically in the active calling application
Another interesting function attempts to disable anti-spam call applications (e.g. whowho – Caller ID & Block), which warns users if it is suspicious in the case of incoming calls from an unknown number. The disable function of these call security applications in the spyware allows cyber criminals to make a call without arousing suspicion as no alert is issued from the anti-spam call apps, thus increasing the success of social engineering.

Figure 7. Disable anti-spam-call applications

Figure 8. Disable anti-spam-call applications
Table 3. List of disabled anti-spam call applications

Connection with Active MoqHao Campaigns
The malware characteristics and structures are very different from the existing MoqHao samples. We give special thanks to @ZeroCERT and @ninoseki, without who we could not have identified the connection to the active MoqHao attack and DNS hijacking campaigns. The server script on the phishing website hosting the fake Chrome application leads victims to a fake Japanese security application on the Google Play store (https://play.google.com/store/apps/details?id=com.jptest.tools2019) under specific browser conditions.

Figure 9. The server script redirects users to a fake security application on Google Play (Source: @ninoseki)
There is a strong correlation between both the fake Japanese and Korean applications we found this time. This malware has common spy commands and shares the same crash report key on a cloud service. Therefore, we concluded that both pieces of spyware are connected to the ongoing MoqHao campaigns.
Conclusion
We believe that the spyware aims to masquerade as a security application and perform spy activities, such as tracking device location and eavesdropping on call conversations. It is distributed via an official application store that many users trust. The attack campaign is still ongoing, and it now features a new Android spyware that has been created by the cybercriminals. McAfee is working with Japanese law enforcement agencies to help with the takedown of the attack campaign. To protect your privacy and keep your data from cyber-attacks, please do not install apps from outside of official application stores. Keep firmware up to date on your device and make sure to protect it from malicious apps by installing security software on it.
McAfee Mobile Security detects this threat as Android/SpyAgent and alerts mobile users if it is present, while protecting them from any data loss. For more information about McAfee Mobile Security, visit https://www.mcafeemobilesecurity.com
Appendix – IOCs
Table 4. Fake Japanese security application IOCs 
 
Table 5. Fake Korean police application IOCs

 








Stay Updated
Follow us to stay updated on all things McAfee and on top of the latest consumer and mobile security threats.










Chanung Pak



                    Chanung is a Security Researcher on McAfee's Mobile Research Team. Previously focused on finding new vulnerabilities in both software and hardware. He specializes in mobile threats and malware, and focuses...                    

 
 
 


    More from     McAfee Labs








MoqHao evolution: New variants start automatically right after installation
Authored by Dexter Shin  MoqHao is a well-known Android malware family associated with the Roaming Mantis threat...


Feb 07, 2024    |      7  MIN READ









Generative AI: Cross the Stream Where it is Shallowest
The explosive growth of Generative AI has sparked many questions and considerations not just within tech circles,...


Feb 07, 2024    |      5  MIN READ









From Email to RAT: Deciphering a VB Script-Driven Campaign
Authored by Preksha Saxena and Yashvi Shah McAfee Labs has been tracking a sophisticated VBS campaign characterized...


Jan 17, 2024    |      10  MIN READ









Stealth Backdoor “Android/Xamalicious” Actively Infecting Devices
Authored by Fernando Ruiz  McAfee Mobile Research Team identified an Android backdoor implemented with Xamarin, an open-source...


Dec 22, 2023    |      14  MIN READ









Shielding Against Android Phishing in Indian Banking
Authored by Neil Tyagi and Fernando Ruiz In a digitally evolving world, the convenience of banking through...


Dec 20, 2023    |      8  MIN READ









PDF Phishing: Beyond the Bait
By Lakshya Mathur & Yashvi Shah  Phishing attackers aim to deceive individuals into revealing sensitive information for...


Dec 04, 2023    |      6  MIN READ









Beneath the Surface: How Hackers Turn NetSupport Against Users
NetSupport malware variants have been a persistent threat, demonstrating adaptability and evolving infection techniques. In this technical...


Nov 27, 2023    |      12  MIN READ









Fake Android and iOS apps steal SMS and contacts in South Korea
Authored by Dexter Shin Most people have smartphones these days which can be used to easily search...


Nov 15, 2023    |      10  MIN READ









Unmasking AsyncRAT New Infection Chain
Authored by Lakshya Mathur & Vignesh Dhatchanamoorthy AsyncRAT, short for “Asynchronous Remote Access Trojan,” is a sophisticated...


Nov 03, 2023    |      7  MIN READ









Exploring Winrar Vulnerability (CVE-2023-38831)
Authored by Neil Tyagi On 23 August 2023, NIST disclosed a critical RCE vulnerability CVE-2023-38831. It is...


Sep 19, 2023    |      8  MIN READ









Agent Tesla’s Unique Approach: VBS and Steganography for Delivery and Intrusion
Authored by Yashvi Shah Agent Tesla functions as a Remote Access Trojan (RAT) and an information stealer...


Sep 08, 2023    |      13  MIN READ









Peeling Back the Layers of RemcosRat Malware
Authored by Preksha Saxena McAfee labs observed a Remcos RAT campaign where malicious VBS files were delivered...


Aug 29, 2023    |      9  MIN READ






 
 
 
 


Back to top











 

















































Corporate
                                                                                    Headquarters 6220 America Center
                                                                                    Drive San Jose, CA 95002
                                                                                    USA

























                                                                            Products

McAfee+™
                                                                                IndividualMcAfee+™
                                                                                FamilyMcAfee® Total
                                                                                ProtectionMcAfee®
                                                                                AntivirusMcAfee® Safe
                                                                                ConnectMcAfee® PC
                                                                                OptimizerMcAfee®
                                                                                TechMasterMcAfee® Mobile
                                                                                Security


























                                                                            Resources

AntivirusFree
                                                                                    DownloadsParental
                                                                                    ControlsMalware
FirewallBlogsActivate
                                                                                    Retail CardMcAfee
                                                                                    Labs


























                                                                            Support

Customer
                                                                                    ServiceFAQsRenewalsSupport
                                                                                     Community


























                                                                            About

About
                                                                                    McAfeeCareersContact
                                                                                    UsNewsroomInvestorsLegal
                                                                                    TermsYour
                                                                                    Privacy ChoicesSystem
                                                                                    RequirementsSitemap






















  United States / English Copyright © 2024
                                        McAfee, LLC

Copyright © 2024 McAfee, LLC




United
                                                        States / English









 












































