# Reference for threat actor for "TA2552"

**Title**: TA2552 Uses OAuth Access Token Phishing to Exploit Read-Only Risks | Proofpoint US

**Source**: https://www.proofpoint.com/us/blog/threat-insight/ta2552-uses-oauth-access-token-phishing-exploit-read-only-risks

## Content































































TA2552 Uses OAuth Access Token Phishing to Exploit Read-Only Risks | Proofpoint US









      Skip to main content
    







Products
Solutions
Partners
Resources
Company











English (Americas)
English (Europe, Middle East, Africa)
English (Asia-Pacific)
Español
Deutsch
Français
Italiano
Português
日本語
한국어



Login

Support Log-in
Digital Risk Portal
Email Fraud Defense
ET Intelligence
Proofpoint Essentials
Sendmail Support Log-in


Contact






Aegis Threat Protection PlatformDisarm BEC, phishing, ransomware, supply chain threats and more.
Sigma Information Protection PlatformDefend your data from careless, compromised and malicious users.
Identity Threat Defense PlatformPrevent identity risks, detect lateral movement and remediate identity threats in real time.
Intelligent Compliance PlatformReduce risk, control costs and improve data visibility to ensure compliance.
Premium ServicesLeverage proactive expertise, operational continuity and deeper insights from our skilled experts.





Email Security and Protection
Email Protection
Email Fraud Defense
Secure Email Relay
Threat Response Auto-Pull
Sendmail Open Source
Essentials for Small Business

Advanced Threat Protection
Targeted Attack Protection in Email
Threat Response
Emerging Threats Intelligence

Security Awareness Training
Assess
Change Behavior
Evaluate


Information Protection
Enterprise Data Loss Prevention (DLP)
Insider Threat Management
Intelligent Classification and Protection
Endpoint Data Loss Prevention (DLP)
Email Data Loss Prevention (DLP)
Email Encryption
Data Discover

Cloud Security
Isolation
Cloud App Security Broker
Web Security


Identity Threat Detection and Response
Spotlight
Shadow


Compliance and Archiving
Automate
Capture
Patrol
Track
Archive
Discover
Supervision


Premium Services
Managed Email Threat Protection
Managed Information Protection
Managed Security Awareness
Managed Abuse Mailbox
Recurring Consultative Services
Technical Account Managers
Threat Intelligence Services
People-Centric Security Program






  New threat protection solution bundles with flexible deployment options 
  AI-powered protection against BEC, ransomware, phishing, supplier risk and more with inline+API or MX-based deployment
Learn More






Solutions by Topic


Combat Email and Cloud ThreatsProtect your people from email and cloud threats with an intelligent and holistic approach.
Change User BehaviorHelp your employees identify, resist and report attacks before the damage is done.
Combat Data Loss and Insider RiskPrevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats.
Modernize Compliance and ArchivingManage risk and data retention needs with a modern compliance and archiving solution.
Protect Cloud AppsKeep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk.


Prevent Loss from RansomwareLearn about this growing threat and stop attacks by securing today’s top ransomware vector: email.
Secure Microsoft 365Implement the very best security and compliance solution for your Microsoft 365 collaboration suite.
Defend Your Remote Workforce with Cloud EdgeSecure access to corporate resources and ensure business continuity for your remote workers.
Authenticate Your EmailProtect your email deliverability with DMARC.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.




Solutions by Industry

Federal Government
State and Local Government
Higher Education
Financial Services
Healthcare
Mobile Operators
Internet Service Providers
Small and Medium Businesses






Partner Programs


Channel PartnersBecome a channel partner. Deliver Proofpoint solutions to your customers and grow your business.
Archive Extraction PartnersLearn about Proofpoint Extraction Partners.
Global System Integrator (GSI) and Managed Service Provider (MSP) PartnersLearn about our global consulting and services partners that deliver fully managed and integrated solutions.


Technology and Alliance PartnersLearn about our relationships with industry-leading firms to help protect your people, data and brand.
Social Media Protection PartnersLearn about the technology and alliance partners in our Social Media Protection Partner program.
Proofpoint Essentials Partner ProgramsSmall Business Solutions for channel partners and MSPs.




Partner Tools

Become a Channel Partner
Channel Partner Portal








Resource LibraryFind the information you're looking for in our library of videos, data sheets, white papers and more.
BlogKeep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
PodcastsLearn about the human side of cybersecurity. Episodes feature insights from experts and executives.
New Perimeters MagazineGet the latest cybersecurity insights in your hands – featuring valuable knowledge from our own industry experts.


Threat GlossaryLearn about the latest security threats and how to protect your people, data, and brand.
EventsConnect with us at events to learn how to protect your people and data from ever‑evolving threats.
Customer StoriesRead how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
WebinarsBrowse our webinar library to learn about the latest threats, trends and issues in cybersecurity.




Security Hubs

Get free research and resources to help you protect against threats, build a security culture, and stop ransomware in its tracks.

Threat Hub
CISO Hub
Cybersecurity Awareness Hub
Ransomware Hub
Insider Threat Management Hub









About ProofpointProofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.
CareersStand out and make a difference at one of the world's leading cybersecurity companies.


News CenterRead the latest press releases, news stories and media highlights about Proofpoint.
Privacy and TrustLearn about how we handle data and make commitments to privacy and other regulations.
Environmental, Social, and GovernanceLearn about our people-centric principles and how we implement them to positively impact our global community.




Support

Access the full range of Proofpoint support services.
Learn More











 




BlogThreat Insight
                                    TA2552 Uses OAuth Access Token Phishing to Exploit Read-Only Risks
                              

 












TA2552 Uses OAuth Access Token Phishing to Exploit Read-Only Risks





Share with your network!








 September 29, 2020


                The Proofpoint Threat Research Team
  
        

 Since January 2020, Proofpoint researchers have tracked an actor abusing Microsoft Office 365 (O365) third-party application (3PA) access, with suspected activity dating back to August 2019. The actor, known as TA2552, uses well-crafted Spanish language lures that leverage a narrow range of themes and brands. The lures entice users to click a link in the message, taking them to the legitimate Microsoft third-party apps consent page. There they are prompted to grant a third-party application read-only user permissions to their O365 account via OAuth2 or other token-based authorization methods. TA2552 seeks access to specific account resources like the user’s contacts and mail. Requesting read-only permissions for such account resources could be used to conduct account reconnaissance, silently steal data, or to intercept password reset messages from other accounts such as those at financial institutions. While organizations with global presence have received messages from this group, they appear to choose recipients who are likely Spanish speakers. 
Attack Technique Overview 
The campaigns from TA2552 follow a similar attack flow. Upon clicking the link in the message, the recipient is redirected to the authentic Microsoft third-party application consent page at login.microsoftonline.com and asked to grant or deny the requested permissions. If the browser is not already authenticated to O365, the user is prompted to authenticate. If consent is granted, the third-party application will be allowed to access the currently authenticated O365 account. The list of permissions we have observed in these campaigns allows read-only access to items such as the user's contacts, profile, and mail. Even if consent is denied, the browser is still redirected to an attacker-controlled page, giving the actor the opportunity to present more attack techniques to the visitor.

Figure 1: Overview of attack flow 
The consent URL used during the OAuth authorization flow has a predictable structure. Values of interest are indicated in Figure 2.  

Figure 2: Relevant components of a consent URL 
Through some campaigns, we have observed the same phish URLs leading to consent URLs with different values for client_id, redirect_uri, and scope options. Some campaigns have used multiple phish URLs. Samples listed below should not be considered representative of the complete list of 3PA IDs and URLs used by this actor over time. 
Message Overview 
In addition to the lures, there are several important components to the attacks described below. Below each message sample, we’ve included several relevant attributes: 
OAuth Access Token Phish Lure Theme: Branding or entity being impersonated. 
OAuth Access Token Phish URL Sample: Sample of the URL linked in the message body. 
ClientID Sample: Sample of the observed client_id value from consent URLs. 
Consent redirect URL Sample: A sample of the redirect_uri value from observed consent URLs where the user’s browser is sent post-consent, regardless of the user’s choice to consent or not. The request may contain an authorization code if the user chooses to consent, or an error code if the consent request was denied.  
Scope values observed in consent URL: A sample of the scope value from the consent URL. It describes the permissions requested by the third-party application  
Impersonation of the Servicio de Administración Tributaria (SAT), Mexico’s tax authority, is a common message theme for this actor. When SAT is used in the phish lure, the email suggests that the recipient needs to update their contact information and is presented with what appears to be a link to do so (Figures 3, 4). Some subjects, like “Аcսse dе Сіta - Aсlaracіоոes 2020. (Acknowledgment of Appointment – Clarifications 2020.),” make use of non-ASCII characters, possibly to evade simple spam filters (Figure 3). 

Figure 3: Mexican tax authority lure 
OAuth Access Token Phish Lure Theme: update your information with SAT of Mexico 
OAuth Access Token Phish URL Sample: hxxp://akglass[.]in/menu/redirect.php 
ClientID Sample: 13f33779-fe8e-4f64-8252-79e8ec962fb4 
Consent redirect URL Sample: hxxps://www-registros-apps-mx.e18220[.]com/1/autoriza.php 
Scope values observed in consent URL: User.Read, User.ReadBasic.All, Contacts.Read, Contacts.Read.Shared, People.Read

Figure 4: Mexican tax authority lure with accurate branding 
OAuth Access Token Phish Lure Theme: update your information with SAT of Mexico 
OAuth Access Token Phish URL Sample: hxxps://app452-sat-mx.i3720[.]xyz/leap/983.php 
ClientID Sample: 4f641680-a8cd-4f96-8181-08efaf2563b1 
Consent redirect URL Sample: hxxps://www-registros-appsmx-sat.x030720[.]xyz/regs/autoriza.php 
Scope values observed in consent URL: User.Read, Contacts.Read, Contacts.Read.Shared, People.Read, Mail.Read 
Mexican tax- and government-themed messages are regularly observed with this actor, though they have occasionally deviated from this messaging and impersonated popular consumer brands. In July, we observed this actor’s lures impersonating Netflix Mexico (Figure 5) and Amazon Prime Mexico (Figures 6, 7). 

Figure 5: Netflix Mexico lure offering 6 free months of service 
OAuth Access Token Phish Lure Theme: Netflix Mexico free trial 
OAuth Access Token Phish URL Sample: hxxps://485online.rs10720[.]xyz/xPsY 
ClientID Sample: d76c652c-7ba7-4205-8666-059985a0ec54 
Consent redirect URL Sample: hxxps://www-netfflix-registros.i10720[.]xyz/regs/autoriza.php 
Domain reused in Amazon Prime free trial phish below 
Scope values observed in consent URL: User.Read, Contacts.Read, Contacts.Read.Shared, People.Read, Mail.Read

Figure 6: Amazon Prime Mexico lure offering 6 months of free service

Figure 7: 3PA consent request, featuring H&M branding incongruent with the Amazon Prime lure 
Phish Lure Theme: Amazon Prime Mexico free trial 
OAuth Access Token Phishing URL Sample: hxxps://printstockphoto[.]com/img/01/redirect.html 
ClientID Sample: f6b5e94d-f5d8-4f4e-9a68-4c06aa2e4cba 
Consent redirect URL Sample: hxxps://apps-registros-mx.is15720[.]xyz/1/auth.php 
Notable brand mismatch between the email lure (Amazon Prime) and the consent page (H&M) 
	 
Third-Party Applications and Permission Risks 
It’s important to understand the scope and risk of permissions requested by the third-party apps linked in these messages. The official consent page presents a list of permissions requested by the third-party application (Figure 8 is an example). 

Figure 8: Itemized permission list for a third-party application 
All permissions we’ve observed requested thus far have been read-only. While that might seem relatively benign, even allowing an actor read access to a user’s inbox and contacts can have significant regulatory and privacy consequences. The minimal permissions requested by these apps also likely help them appear inconspicuous if an organization’s O365 administrator audits connected apps for their users’ accounts. The apps don’t request many permissions, and those they do might not appear particularly far-reaching, allowing them to blend in with other benign apps. 

Figure 9: Commonly observed requested permissions  
Contacts.Read and People.Read could be used for email address harvesting. Obtaining email addresses in this way can help ensure addresses are valid and active. 
User.Read can help an actor determine potential value of an account, or the value of compromising the user’s other accounts. 
Mail.Read allows an actor to read a user’s mail, potentially offering a more subtle manner of collecting credentials. If an actor completes the ‘forgot password’ flow on a site connected to the email address and a password reset link is sent via email, they could effectively steal the account. This also assumes that the user’s account does not have multifactor authentication measures independent of the readable account’s inbox enabled. 
Infrastructure and Hosting 
The phish URL in the lure is usually a compromised site that takes the recipient to the official O365 login page if they’re not authenticated. Once signed into their O365 account, the user is redirected to the official O365 consent process that prompts them to grant permissions to the actor’s application. The domains that catch the OAuth tokens are often registered via Namecheap and hosted on Cloudflare. 
Conclusion 
Threat actors often find creative ways to harvest information. In these attacks, TA2552 doesn't rely on techniques like more traditional credential phishing or dropping malware on a system. Instead, they gain permissions to view the content and activity of resources available through a user’s O365 account. The departure from such traditional techniques gives this actor an advantage, as users likely aren’t trained to spot or inspect suspicious applications. Even read-only access comes with considerable risk. The ability to perform reconnaissance on an O365 account supplies an actor with valuable information that can later be weaponized in business email compromise (BEC) attacks or account takeovers.  
IOCs  
Phish URL Domains: 
The actor has used a blend of what appear to be compromised sites and custom domains.  
casperinfosystem[.]com 
ultimatetravel[.]in 
nivedafoundation[.]org 
calyss[.]in 
mucla[.]in 
akglass[.]in 
i3720[.]xyz 
rs10720[.]xyz 
photobalkan[.]com 
printstockphoto[.]com 
ccgdm[.]org 
al-thawiya[.]com 
dev.tvs[.]st 
ClientIDs: 
13f33779-fe8e-4f64-8252-79e8ec962fb4 
4f641680-a8cd-4f96-8181-08efaf2563b1 
d76c652c-7ba7-4205-8666-059985a0ec54 
2c8cd500-52d3-4b88-8d0b-1f8ad8a3b714 
1ed6cd93-7682-4584-9e1e-f9251f056cbd 
2385bb0e-b757-4b1c-830b-c5076d1c8ca2 
41b33fb0-7a42-4f9a-a649-62fa456e85ea 
6337785c-1c50-4b4f-befa-9b70b9fd78ad 
81f521a0-8db3-42cc-a3ff-9756474c7d14 
a04f33b3-efee-4d74-93ce-59b157381c0b 
a972fde8-6e7a-41bb-9c63-d3cc6c0603fe 
ab6df806-cd0e-462d-af11-3c51bccc6ba3 
b8d51b1a-f464-4ab4-ac0d-9d8dc190cb9e 
f6b5e94d-f5d8-4f4e-9a68-4c06aa2e4cba 
Redirect URL Domains: 
x030720[.]xyz 
e10220[.]com 
xs1920[.]xyz 
i10720[.]xyz 
e1920[.]xyz 
is15720[.]xyz 
e29120[.]com 
rr020920[.]xyz 
e180320[.]xyz 
e18220[.]com 
i5320[.]xyz 
r25820[.]xyz 
ex171019[.]com 
16720s[.]xyz 
e18220[.]com 







Previous Blog Post


Next Blog Post







Subscribe to the Proofpoint Blog

























About


Overview
Why Proofpoint
Careers
Leadership Team
News Center
Nexus Platform
Privacy and Trust




Threat Center


Threat Hub
Cybersecurity Awareness Hub
Ransomware Hub
Threat Glossary
Threat Blog








Products


Email Security & Protection
Advanced Threat Protection
Security Awareness Training
Cloud Security
Archive & Compliance
Information Protection
Product Bundles




Resources


White Papers
Webinars
Data Sheets
Events
Customer Stories
Blog
Free Trial








Connect


+1-408-517-4710
Contact Us
Office Locations
Request a Demo




Support


Support Login
Support Services
IP Address Blocked?
















Facebook
Twitter
linkedin
Youtube





English (US)
English (UK)
English (AU)
Español
Deutsch
Français
Italiano
Português
日本語
한국어





© 2024. All rights reserved.
            Terms and conditions
Privacy Policy
Sitemap

 







 

















