# Reference for threat actor for "APT 4, Maverick Panda, Wisp Team"

**Title**: Sykipot variant hijacks DOD and Windows smart cards

**Source**: https://cybersecurity.att.com/blogs/labs-research/sykipot-variant-hijacks-dod-and-windows-smart-cards

## Content



Sykipot variant hijacks DOD and Windows smart cards













































































					View all AT&T Business Products ⟶
				









Blog

Contact

Support























 
 

Contact us



 











 

Products & Services






Secure your Business Our managed security services team detects cyber threats early and provide coordinated defences for fast and effective responses



Modernize Network Security
The next generation of security is here





Distributed Denial of Service
Domain Name System
Firewall
Cloud Access Security Broker
Zero-Trust Network Access
Secure Access Service Edge




Secure Remote Access
Secure Remote Gateway
Enterprise Traffic Protector
Software-Defined Wide Area Networking
Web Application and API Protection







Managed Detection and Response
Make security operations more efficient





Managed Endpoint Security with Sentinel One
Managed Threat Detection and Response
Managed Vulnerability Program​
Incident Readiness
Incident Response







Extended Detection and Response
With the USM Anywhere open XDR platform





USM Anywhere
Cybersecurity XDR for MSSPs
TDR for Government
AlienApps/Integrations







Endpoint Management
Manage and secure your endpoint devices





SentinelOne
Ivanti (MobileIron)
VMware Workspace ONE®
IBM MaaS360
Lookout Mobile Endpoint Security
McAfee Endpoint Protection
Samsung Knox








Mitigate Risk & InnovateOur experienced advisors help you to manage your environment, identify areas of cyber risk, and protect your critical assets



Consulting Services
Reduce risk and improve security posture





Cyber as a Service
Risk Advisory
Cyber Operations







Research
Learn critical cybersecurity trends





Insights Report Hub
Insights Report Media Coverage
Insights Report Resources
Get the latest Insights Report







Threat Intelligence
Unlock timely, tactical threat intelligence





AT&T Alien Labs
AT&T Alien Labs Open Threat Exchange














Solutions






EnvironmentProtect your environment, address your cyber risks head on



5G
Advance 5G security solutions for robust defense 







5G
Learn more 










Cloud Security
Adopt public cloud services safely







Cloud Security
Learn more 










Mobility and IoT
Prepare for security requirements for new technologies







Mobility and IOT
Learn more 










Network Security
Manage multiple network access points







Network Security
Learn more 










Remote Workforce
Provide highly secure access from any device







Remote Workforce
Learn more 











IndustrySecure digital and business transformation



Financial Services
Secure digital transformation in finance







Financial
Learn more 










Healthcare
Protect patient data and reduce threats







Healthcare
Learn more 










Manufacturing
Design secure IoT solution for a smarter supply chain







Manfacturing
Learn more 










Retail
Create modern customer experiences without the risk







Retail
Learn more 











Security Use CasesLearn how to do better security



Secure Access Service Edge
Improve network performance, lower cost and complexity







Secure Access Service Edge
Learn more 










Secure Web Gateway
Filter and inspect outbound user traffic







Secure Web Gateway
Learn more 










SIEM Platform Solutions
Take advantage of an all-in-one solution









SIEM Platform Solutions
Learn more 










XDR
Protect, detect, and respond at scale to threats







XDR
Learn more 










Zero Trust
Embed a Zero Trust model to your network architecture







Zero Trust
Learn more 











ComplianceAchieve compliance goals faster



HIPPA
Safeguard electronic protected health information









The perfect Rx for HIPAA compliance
Learn more 










PCI DSS
Simplify PCI DSS compliance









PCI DSS compliance solutions
Learn more 










ISO 27001
Secure the global standard for information security









ISO 27001 compliance
Learn more 










SOC 2
Streamline your audit process 









SOC 2 compliance
Learn more 

















Partners





Channel PartnersPowered by our award-winning USM Anywhere platform, our partner programs help you deliver essential security for customers 



All Partner Programs
Why become a channel partner




MSSP Program
Become an AT&T Cybersecurity MSSP




Reseller Program
Become an AT&T Cybersecurity solution provider




Professional Services
Get expert help with your implementation and optimization




Partner Portal Login
Get access to our private members area





Technology PartnersWorking with the World's leading security providers, we provide best-in-class services that ensure better business outcomes for customers.



OTX Partners
Discover our Open Threat Exchange partners




Managed Security Partners
Learn about our managed security partners










Resources





Product ResourcesLearn about our products & services portfolio and discover how we protect your organization.



Product Briefs
Read about our products & services





Product Brief
            

Help keep employees connected and protected virtually anywhere

                    
                Learn more 





View all Product Briefs 









Solution Briefs
Learn about the solutions we offer





Solution Brief
            

Protect external-facing services against DDoS attacks and keep your business running

                    
                Learn more 





View all Solution Briefs 









Videos
Watch and learn about what we do 





video

AT&T Cybersecurity Training Portal (ACT)

                    
                Learn more 





View all Videos 









Customer Stories
Find out how we solve customer problems





Customer Story
            

AT&T Cybersecurity Helps 28 Agencies in Contra Costa Centralize and Increase

                    
                Learn more 





View all Customer Stories 









Free Trial
Test drive USM Anywhere





Security ResourcesBroaden your security knowledge to strenghten your cyber resiliency and mitigate risks.



Analyst Reports
Understand today's security landscape





Analyst Report
            

Strong third-party test results confirm AT&T Cybersecurity as XDR leader

                    
                Learn more 





View all Analyst Reports 









Blogs
Read the latest coverage on security matters





Blog: Security Essentials
            

2024: Practical cyber action plan- Survive and thrive

                    
                Learn more 





View all Blogs 









eBooks
Deep dive into complex security topics





ebook

Zero Trust Security

                    
                Learn more 





View all eBooks 









Webcasts
Listen to our team of security experts





webcast

2023 AT&T Cybersecurity Insights Report: Focus on Transportation

                    
                Learn more 





View all Webcasts 









White Papers
Learn more about cyber solutions





White Paper
            

Navigating Network Security Modernization

                    
                Learn more 





View all White Papers 










Customer ResourcesDoing business with us? Access critical customer information at the touch of a button.



Support Overview
Access area for all support queries




Success Center
Find answers to USM questions 




Certification
Become security certified 




Documentation
Discover technical support documentation




Training
Get expert instruction and hands-on practice








Product Resources

Customer Stories
Product Briefs
Solution Briefs
Use Cases
Free Trial



Security Resources

Analyst Reports
Blogs
eBooks
Videos
Webcasts
White Papers



Customer Resources

Success Center
Certification
Customer Success
Documentation
Professional Services
Support Overview
Training



Browse by Topic

Incident Response
Intrusion Detection
Partner: MSSP & Reseller
Regulatory Compliance
Security Operations Center
SIEM & Log Management 
Threat Detection
Threat Intelligence







AT&T Alien Labs


Contact


Support




Get price




Products & Services



Solutions



Partners



Resources









 




Back
Secure your Business


Modernize Network Security 
Managed Detection and Response
Extended Detection and Response 
Endpoint Management


Mitigate Risk & Innovate


Consulting Services
Research
Threat Intelligence





Back to Products & Services
Modernize Network Security


Distributed Denial of Service
Domain Name System
Firewall
Cloud Access Security Broker
Zero-Trust Network Access
Secure Access Service Edge
Secure Remote Access
Secure Remote Gateway
Enterprise Traffic Protector
Software-Defined Wide Area Networking
Web Application and API Protection




Back to Products & Services
Managed Detection and Response


Managed Endpoint Security with Sentinel One
Managed Threat Detection and Response
Managed Vulnerability Program​
Incident Readiness
Incident Response




Back to Products & Services
Extended Detection and Response


USM Anywhere
Cybersecurity XDR for MSSPs
TDR for Government
AlienApps/Integrations




Back to Products & Services
Endpoint Management


SentinelOne
Ivanti (MobileIron)
VMware Workspace ONE®
IBM MaaS360
Lookout Mobile Endpoint Security
McAfee Endpoint Protection
Samsung Knox





Back to Products & Services
Consulting Services


Cyber as a Service
Risk Advisory
Cyber Operations




Back to Products & Services
Research


Insights Report Hub
Insights Report Media Coverage
Insights Report Resources
Get the latest Insights Report




Back to Products & Services
Consulting Services


AT&T Alien Labs
AT&T Alien Labs Open Threat Exchange






Back
Environment


5G
Cloud Security
Mobility and IoT
Network Security
Remote Workforce


Industry


Financial Services
Healthcare
Manufacturing
Retail


Security Use Cases


Secure Access Service Edge
Secure Web Gateway
SIEM Platform Solutions
XDR
Zero Trust


Compliance


HIPPA
PCI DSS
ISO 27001
SOC 2





Back
Channel Partners


All Partner Programs
MSSP Program
Reseller Program
Professional Services
Partner Portal Login


Technology Partners


OTX Partners
Managed Security Partners





Back
Product Resources


Product Briefs
Solution Briefs
Videos
Customer Stories
Free Trial


Security Resources


Analyst Reports
Blogs
eBooks
Webcasts
White Papers


Customer Resources


Support Overview
Success Center
Certification
Documentation
Training














Categories:

All
							blogs
Security essentials
AT&T Alien
							Labs research








Categories 

All
								blogs
Security essentials
AT&T
								Alien Labs research























AT&T Cybersecurity






Blog





Sykipot variant hijacks DOD and Windows smart cards
January 12, 2012  | 
									Jaime Blasco


Defenses of any sort, virtual or physical, are a means of forcing your attacker to attack you on your terms, not theirs. As we build more elaborate defenses within information security, we force our attacker’s hand. For instance, in many cases, implementing multi-factor authentication systems just forces the attacker to go after that system directly to achieve their goals. Take the breach at RSA, for example. It has been attributed to attackers who needed the SecurID information to go after their real targets in the defense industry.
As we discussed, this malware has been used to launch targeted attacks via “spear phishing” campaigns against targets mainly in the US, since around 2007. According to our research, these attacks originate from servers in China with what appears to be the purpose of obtaining information from the defense sector: the same sector that makes extensive use of PC/SC x509 Smartcards for authentication.
Smartcards have a long history of usage in the Defense Sector, for both physical and information access management, and historically have merely forced attackers to route around the smartcard authentication system through other, more vulnerable attack vectors.
It should come as no surprise, then, that we recently discovered a variant of Sykipot with some new, interesting features that allow it to effectively hijack DOD and Windows smart cards. This variant, which appears to have been compiled in March 2011, has been seen in dozens of attack samples from the past year.
Like we have shown with previous Sykipot attacks, the attackers use a spear phishing campaign to get their targets to open a PDF attachment which then deposits the Sykipot malware onto their machine (the attackers here took advantage of a zero-day exploit in Adobe). Then, unlike previous strains, the malware uses a keylogger to steal PINs for the cards. When a card is inserted into the reader, the malware then acts as the authenticated user and can access sensitive information. The malware is controlled by the attackers from the command & control center.
Here is more detail on the attack:
Smartcard access
The ﬁrst one is that it creates a new thread with a keylogger routine. The code is very basic, it stores the window name and the keys pressed under a ﬁle named MSF5F0.dat on an unencrypted format, example:
Title:Internet Explorer
www.google.es
Title:My Computer
It uses the WIN32 APIʼs functions [GetKeyState, GetAsyncKeyState,
GetForegroundWindow, GetWindowTextA].
It also saves the information contained in the clipboard using the native functions:
OpenClipboard, GetClipboardDataand CloseClipboard.
This code is very similar to other pieces of APTʼs like:
http://contagiodump.blogspot.com/2010/07/apt-activity-monitor-keylogger.html
Apart from this we found two more modules that attracted our attention. The ﬁrst one is capable of listing all the certificates that are stored on the windows key store:

This next routine is called if the command “cl” is present on the conﬁg ﬁle fetched from the C&C.

When you insert a smart card into a reader attached to a Windows computer, the certiﬁcate on the smart card is registered to the local certiﬁcate store on the client computer.
The second one is even more interesting:


It loads:
C:Program FilesActivIdentityActivClientcpkcs201.dll
(a module that handles some of the functions related with ActivIdentityʼs ActivClient solution.)
ActivClient is a smart card-based PKI authentication solution for compliance with:

U.S. Government Smart Card Interoperability Specifications GSC-IS 2.1
U.S. General Services Administration (GSA) Basic Services Interface (BSI)

(In fact it is one of the platforms used to support the Department of Defense common access card - DoD CAC)
This routine is called if the command “cm” is present on the conﬁg ﬁle fetched from the C&C:
 

 
So, the modus operandi of the attackers is listing the certificates present on the victimʼs
computer included the smartcards, stealing the PIN using the keylogger module and then
use this information to log onto remote resources protected with certificates/smartcards.
 

 
To log onto protected resources they have implemented the command “krundll”, if the C&C sends that command, the victim receives a new dll that implements the required code to login using the certiﬁcate and the stolen PIN. This DLL implements the “LoginFunc” and “GetFunc”. These methods will contain all the code depending on the application used:
 
 
Summary
We have seen how the attackers are implementing different techniques to bypass two-factor authentication with smartcard/PIN to access protected resources on the victimʼs network. By capturing the PIN for the smartcard and binding the certificate, malware can silently use the card to authenticate to secure resources, so long as the card remains physically present in the card reader. This is similar to what Mandiant described on the 2011 M-Trends report as a “Smart Card Proxy”. While trojans that have targeted smartcards are not new, there is obvious siginficance to the targeting of a particular smartcard system in wide deployment by the US DoD and other government agencies, particularly given the nature of the information the attackers seem to be targeting for exfiltration.
Implications
As defenses get better, attackers will continue to change their tactics to adapt, and as seen here, will hijack the very systems designed to provide more security, if necessary. An interesting by-product of this malware’s necessity of having the card physically present is that attackers can only leverage it for secure authentication to target systems, during times that the user them is physically present at the workstation, making unauthorized activity that much more difficult to discern from legitimate usage. Although smart cards are designed to provide a two factor system of ‘chip and pin’, again we see that true two-factor authentication is not possible without a physical component that is not accessible digitally.






Share this with others





Tags: 


















Featured resources


INSIGHTS REPORT

AT&T Cybersecurity Insights™ Report 2023:
Edge Ecosystem

Learn more ⟶


SELF ASSESSMENT

Benchmark your cybersecurity maturity

Explore ⟶













Get price
Free trial








From the Blog




Bindu Sundaresan and Nick Simmons
Feb 15, 2024


2024: Practical cyber action plan- Survive and thrive

Explore All Blog Posts
            ›


Twitter
LinkedIn
Youtube




Who We Are

Alien Labs
Careers
Contact Us



News

Newsroom
Events
Blogs



Partners

Partner Programs
Partner Portal





Products

AT&T Managed Threat Detection and Response
USM Anywhere
XDR for MSSPs
Open Threat Exchange (OTX)
OSSIM



Solutions

Cloud Security Monitoring
Threat Detection
Intrusion Detection
SIEM platform solutions
Vulnerability
                Assessment





Resources

Resources
Blogs
Customer Reference Guide



Customer Success

Support & Services
Success Center
Documentation Center
Training
Certification



Contact us




© Copyright 2024

Privacy Policy
Website Terms of Use
GDPR
Cookie Policy
Your Privacy Choices







We use cookies to provide you with a great user experience. By using our website, you agree to our Privacy Policy and Website Terms of Use.
















