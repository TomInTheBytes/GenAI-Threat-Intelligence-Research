# Reference for threat actor for "UNC2447"

**Title**: UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat | Mandiant

**Source**: https://www.fireeye.com/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html

## Content
UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat | Mandiant   Skip to main content Mandiant is now part of Google Cloud. Learn More.         Platform   Solutions   Intelligence   Services   Resources   Company Mandiant AdvantageExplore our multi-vendor XDR platform, delivering Mandiant products and integrating with a range of leading security operations technology.Explore the platformarrow_forward Who's targeting you   Attack Surface Management Map your external environment   Breach Analytics for Chronicle Know what we know when we know it   Security Validation Validate controls are working properly   Threat Intelligence Access latest intel from the frontlines   Digital Threat Monitoring Visibility into deep, dark, and open web   Managed Defense Managed detection and response Mandiant SolutionsSolve your toughest cyber security challenges with combinations of products and services.Featured solutionsarrow_forwardBy use casearrow_forwardBy industryarrow_forward  Featured solutions   Proactive Exposure Management New!Reduce exposures before adversaries act   Government New!Protect national services and agencies   Digital Risk ProtectionPrioritize and focus on threats that matter   RansomwareIncrease resilience against ransomware and multifaceted extortion   Know Who is Targeting YouPrioritize threats that matter most   Know What Is ExposedIdentify attack surface exposures   Know If You Are PreparedTest and measure your cyber defense program   Know If You Have Been BreachedDetect and respond to breach activity quickly and effectively   Use Case   RansomwareIncrease resilience against multifaceted extortion   Cyber Risk ManagementAdvance your business approach to cyber security   Digital Risk ProtectionPrioritize and focus on threats that matter   Industrial ControlsStrengthen OT and ICS security   Insider ThreatsUncover and manage internal vulnerabilities   Skills GapClose gaps with training and access to expertise   Private Industry   Finance New!Extend your security posture and operationalize resilience   Manufacturing New!Protect against cyber security threats to maintain business continuity   Government   Election SecurityFocus on Election Infrastructure Protection   Government  New!Protect natural services and agencies Mandiant ServicesMitigate threats, reduce risk, and get back to business with the help of leading experts.Learn morearrow_forwardView all services (47)arrow_forward Schedule a consultation   Featured categories   Cyber Security Transformation Establish and activate cyber defenses   Incident Response Tackle breaches confidently   Strategic Readiness Increase resilience to risk   Technical Assurance Test your security program   Expertise On Demand Access to Mandiant Experts   Training   Browse courses Browse on-demand and live training   Mandiant Academy Train your teams to protect effectively Cyber Threat IntelligenceMandiant specializes in cyber threat intelligence, offering products, services, and more to support our mission to defend against cyber crime. Intelligence resourcesarrow_forward  Products   Threat Intelligence Access latest intel from the frontlines   Digital Threat Monitoring visibility into deep, dark, and open web   Services   Intelligence capability development build a comprehensive threat intelligence program   Intelligence Training Develop practical application skills   Executive Briefings Get live, interactive briefings from the frontlines   Advanced Intelligence Access Hire a dedicated analyst for your needs Resource CenterGet the latest insights from cyber security experts at the frontlines of threat intelligence and incident responseM-Trends 2023 reportarrow_forwardmWISEarrow_forward View all resourcesarrow_forward   Resource types   Mandiant Blog Expert perspectives and industry news   Podcasts Interviews, hot topics, and more   Customer Stories Case studies and customer testimonials   Reports Research from the frontlines   Webinars Livestreams and pre-recorded speaker events   Insights Cyber security concepts, methods, and more   Events Upcoming conferences and collaboration   Infographics Visualization of security research and process   Datasheets Information on Mandiant offerings and more   eBooks High-impact cyber security guides   White Papers Cyber security insights and technical expertise CompanyLearn more about us and our mission to help organizations defend against cyber crime.Learn morearrow_forward Contact us   Careers Life at Mandiant and open roles   Media Center Press releases and news mentions   Partners Ecosystem and resources   Elevate Empowering women in cyber security   Mandiant Gives Back Our commitment to a better future              Sign in to Advantage  en  expand_more   English Français Deutsch Italiano 日本 한국어 EspañolGet Started        Search   Submit search form    Search   Submit search form  PlatformMandiant Advantage OverviewSecurity ValidationAttack Surface ManagementThreat IntelligenceDigital Threat MonitoringManaged DefenseSolutionsProactive Exposure ManagementGovernmentRansomwareKnow Who is Targeting YouKnow What Is ExposedKnow If You Are PreparedKnow If You Have Been BreachedCyber Risk ManagementDigital Risk ProtectionOT/ICS SecurityInsider ThreatsCyber Security Skills GapFinanceManufacturingElection SecurityIntelligenceIntelligence resourcesThreat IntelligenceDigital Threat MonitoringIntelligence Capability DevelopmentIntelligence TrainingExecutive BriefingsAdvanced Intelligence AccessServicesServices OverviewIncident ResponseStrategic ReadinessCyber Security TransformationTechnical AssuranceView all Services (48)Mandiant AcademyFind a CourseExpertise On DemandResourcesResourcesMandiant BlogsCustomer StoriesWebinarsEventsPodcastsReportsInsightsDatasheetsInfographicsWhite PaperseBooksCompanyAbout MandiantCareersMedia CenterPartnersElevateMandiant Gives BackMobile Footer SectionSee what’s new at MandiantGet startedIncident Response HelpContact SalesSupportBlogTop Incident Response Contact sales Support   BlogSupportContact usreport_problemIncident Response Assistance   Breadcrumb Home UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat   Threat Research UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial ThreatTyler McLellan, Justin Moore, Raymond Leong Apr 29, 202115 min read |    Last updated: Nov 24, 2022 RansomwareUncategorized Groups (UNC Groups)Threat ResearchZero Day ThreatsMandiant has observed an aggressive financially motivated group, UNC2447, exploiting one SonicWall VPN zero-day vulnerability prior to a patch being available and deploying sophisticated malware previously reported by other vendors as SOMBRAT. Mandiant has linked the use of SOMBRAT to the deployment of ransomware, which has not been previously reported publicly.UNC2447 monetizes intrusions by extorting their victims first with FIVEHANDS ransomware followed by aggressively applying pressure through threats of media attention and offering victim data for sale on hacker forums. UNC2447 has been observed targeting organizations in Europe and North America and has consistently displayed advanced capabilities to evade detection and minimize post-intrusion forensics.Mandiant has observed evidence of UNC2447 affiliated actors previously using RAGNARLOCKER ransomware. Based on technical and temporal observations of HELLOKITTY and FIVEHANDS deployments, Mandiant suspects that HELLOKITTY may have been used by an overall affiliate program from May 2020 through December 2020, and FIVEHANDS since approximately January 2021.BackgroundIn November 2020, Mandiant created UNC2447, an uncategorized group observed using the novel WARPRISM PowerShell dropper to install BEACON at two Mandiant Managed Defense clients. Mandiant Managed Defence quicky neutralized these intrusions and did not observe attempts to deploy ransomware.In January and February 2021, Mandiant Consulting observed a novel rewrite of DEATHRANSOM—dubbed FIVEHANDS—along with SOMBRAT at multiple victims that were extorted. During one of the ransomware intrusions, the same WARPRISM and BEACON samples previously clustered under UNC2447 were observed. Mandiant was able to forensically link the use of WARPRISM, BEACON, SOMBRAT and FIVEHANDS to the same actor.Mandiant suspects that HELLOKITTY activity in late-2020 may be related to the overall affiliate program and that usage shifted to FIVEHANDS ransomware beginning in January 2021.In April 2021, Mandiant observed a private FIVEHANDS TOR chat using a HELLOKITTY favicon (Figure 1).Figure 1: FIVEHANDS Hello Kitty iconWhen affiliate-based ransomware is observed by Mandiant, uncategorized clusters are assigned based on the infrastructure used, and in the case of UNC2447 were based on the SOMBRAT and Cobalt Strike BEACON infrastructure used across 5 intrusions between November 2020 and February 2021. Generally, Mandiant uses caution even with novel malware such as SOMBRAT and WARPRISM and clusters each use rigorously according to all observed activity. For more information on uncategorized threats, refer to our post, "DebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors."SonicWall SMA 100 Series Appliance VulnerabilityCVE-2021-20016 is a critical SQL injection vulnerability that exploits unpatched SonicWall Secure Mobile Access SMA 100 series remote access products. A remote, unauthenticated attacker could submit a specially crafted query in order to exploit the vulnerability. Successful exploitation would grant an attacker the ability to access login credentials (username, password) as well as session information that could then be used to log into a vulnerable unpatched SMA 100 series appliance. This vulnerability only impacted the SMA 100 series and was patched by SonicWall in February 2021. For more information on this vulnerability, please refer to SonicWall PSIRT advisory SNWLID-2021-0001.WARPRISMWARPRISM is a PowerShell dropper that has been observed by Mandiant delivering SUNCRYPT, BEACON, and MIMIKATZ. WARPRISM is used to evade endpoint detection and will load its payload directly into memory. WARPRISM may be used by multiple groups.FOXGRABBERFOXGRABBER is a command line utility used to harvest FireFox credential files from remote systems. It contains the PDB path: C:\Users\kolobko\Source\Repos\grabff\obj\Debug\grabff.pdb. FOXGRABBER has also been observed in DARKSIDE ransomware intrusions.BEACON Malleable ProfilesIn the initial stages of an intrusion, UNC2447 uses the Cobalt Strike BEACON HTTPSSTAGER implant for persistence to communicate with command-and-control (C2) servers over HTTPS and has been observed using ‘chches_APT10’ and ‘Havex’ Malleable profiles.UNC2447 ToolboxDuring the recon and exfiltration stage of intrusions, UNC2447 has been observed using the following tools: ADFIND, BLOODHOUND, MIMIKATZ, PCHUNTER, RCLONE, ROUTERSCAN, S3BROWSER, ZAP and 7ZIP. UNC2447 may tamper with windows security settings, firewall rules, and antivirus protection.SOMBRAT OverviewSOMBRAT was first reported by Blackberry Cylance in November 2020 as "The CostaRicto Campaign: Cyber-Espionage Outsourced" as a potential espionage-for-hire criminal group. Mandiant has now observed SOMBRAT alongside FIVEHANDS ransomware intrusions.The SOMBRAT backdoor is packaged as a 64-bit Windows executable. It communicates with a configurable command and control (C2) server via multiple protocols, including DNS, TLS-encrypted TCP, and potentially WebSockets. Although the backdoor supports dozens of commands, most of them enable the operator to manipulate an encrypted storage file and reconfigure the implant. The backdoor's primary purpose is to download and execute plugins provided via the C2 server. In contrast to the SOMBRAT version published in November 2020, Mandiant observed additional obfuscation and armoring to evade detection, this SOMBRAT variant has been hardened to discourage analysis. Program metadata typically included by the compiler has been stripped and strings have been inlined and encoded via XOR-based routines.The SOMBRAT LauncherThis SOMBRAT backdoor variant must be deployed alongside four additional resources that serve as launchers. They are typically installed to the hardcoded directory path `C:\ProgramData\Microsoft`. path: `C:\programdata\Microsoft\WwanSvc.bat` - launcher for `WwanSvc.txt`path: `C:\programdata\Microsoft\WwanSvc.txt` - decoder and launcher for `WwanSvc.c`path: `C:\programdata\Microsoft\WwanSvc.c` - decoder and launcher for `WwanSvc.b`path: `C:\programdata\Microsoft\WwanSvc.a` - XOR keypath: `C:\programdata\Microsoft\WwanSvc.b` - encoded SOMBRAT backdoorpath: `%TEMP%\<possibly unique random name>` - encrypted storage filepath: `%TEMP%\<possibly unique random name _<integer>` - encrypted storage filepath: `C:\ProgramData\<possibly unique random name ` - encrypted configuration fileOther variations of the filenames were observed such as ntuser and wapsvc.SOMBRAT Technical DetailsThe SOMBRAT backdoor is written in modern C++ and implemented as a collection of "plugins" that interoperate with one another. There are five plugins distributed with this variant: `core`, `network`, `storage`, `taskman`, and `debug` (the `config` plugin described by Blackberry is not present). The core plugins communicate with the C2 server via messages sent over a common networking layer; each plugin supports its own set of messages, and the backdoor protocol can be extended by dynamically loaded plugins.The `core` plugin coordinates state tracking, such as network connectivity, and dynamic plugin loading and unloading. The `network` plugin configures the networking layer used to communicate with the C2 server, for example enabling the operator to switch between DNS and TCP protocols. The `storage` plugin exposes logical operations, such as read and write, for an encrypted file used to store plugins, resources, and arbitrary data. The `taskman` plugin enables the operator to list and kill processes on the compromised system. Finally, the `debuglog` plugin supports a single command to records debug messages.Given that the core plugins do not enable an operator directly execute arbitrary commands or reconfigure the system, the primary function of the SOMBRAT backdoor is to load plugins provided via the C2 server. These plugins may be shellcode or DLL modules to be dynamically loaded. The C2 server may instruct the backdoor to load the plugins directly or persist them into the encrypted storage file, where they may subsequently be reloaded, such as after upgrading the backdoor.Figure 2: Malware author mark “No one is perfect except me.”SOMBRAT evades forensic analysis by patching the process memory used to record command line arguments. It replaces the initial command line with the base filename of the program executable, removing any arguments. This means that investigators that inspect a process listing via memory forensics will see the innocuous-looking command line `powershell.exe` rather than references to the uncommon filename such as `WwanSvc.c`.SOMBRAT Network CommunicationsThe SOMBRAT backdoor can communicate with its C2 server using both DNS and a proxy-aware, TLS-encrypted stream protocol. By default, the backdoor uses the DNS protocol; however, this can be reconfigured by the C2 server. Mandiant observed the domains feticost[.]com and celomito[.]com used for DNS C2 communications.When the backdoor communicates via its DNS protocol, it constructs and resolves FQDNs, interpreting the DNS results to extract C2 messages. The authoritative DNS server embeds data within the IP address field of DNS A record results and within the Name Administrator field of DNS TEXT record results. By making many requests to unique subdomains of the C2 domain, the backdoor can slowly transmit information a few bytes at a time.Ransomware SimilaritiesBeginning in October 2020, Mandiant observed samples of a customized version of DEATHRANSOM. This newly modified version removed the language check feature (Figure 3 shows the language check of DEATHRANSOM).Figure 3: Language check from Fortinet blogHELLOKITTY ransomware—used to target Polish video game developer CD Projekt Red—is reportedly built from DEATHRANSOM.HELLOKITTY is named after a mutex named ‘HELLOKITTYMutex,’ used when the malware executable is launched (see Figure 4).Figure 4: HELLOKITTY mutex shown in Process ExplorerCEMIG (Companhia Energética de Minas Gerais), a Brazilian electric power company, revealed on Facebook in late December 2020 that it was a victim of HELLOKITTY cyber attack.In January 2021, Mandiant observed a new ransomware deployed against a victim and assigned the name FIVEHANDS.Analysis of FIVEHANDS revealed high similarity to DEATHRANSOM, sharing several features, functions, and coding similarities. Absent in FIVEHANDS is a language check, similar to HELLOKITTYBoth DEATHRANSOM and FIVEHANDS drops a ransom note in all non-excluded directoriesTechnical Comparison of FIVEHANDS, HELLOKITTY and DEATHRANSOMDEATHRANSOM is written in C while the other two families are written in C++. DEATHRANSOM uses a distinct series of do/while loops to enumerate through network resources, logical drives, and directories. It also uses QueueUserWorkItem to implement thread pooling for its file encryption threads.HELLOKITTY is written in C++, but reimplements a significant portion of DEATHRANSOM's functionality using similar loop operations and thread pooling via QueueUserWorkItem. The code structure to enumerate network resources, logical drives, and perform file encryption is very similar. Additionally, HELLOKITTY and DEATHRANSOM share very similar functions to check for the completion status of their encryption threads before exiting.FIVEHANDS is written in C++ and although high level functionality is similar, the function calls and code structure to implement the majority of the functionality is written differently. Also, instead of executing threads using QueueUserWorkItem, FIVEHANDS uses IoCompletionPorts to more efficiently manage its encryption threads. FIVEHANDS also uses more functionality from the C++ standard template library (STL) than does HELLOKITTY.Deletion of Volume Shadow CopiesDEATHRANSOM, HELLOKITTY, and FIVEHANDS use the same code to delete volume shadow copies via WMI by performing the query select * from Win32_ShadowCopy and then deleting each instance returned by its id.Encryption OperationsEach of these three malware families utilizes a similar encryption scheme. An asymmetric public key is either hard-coded or generated. A unique symmetric key is generated for each encrypted file.After each file is encrypted, the asymmetric key will encrypt the symmetric key and append it to the encrypted file. Additionally, a unique four byte magic value is appended to the end of the encrypted file. The malware checks for these magic bytes to ensure it does not encrypt a previously encrypted file again.DEATHRANSOM and HELLOKITTY implement the file encryption operations using a very similar code structure and flow.FIVEHANDS implements its file encryption with a differing code structure and uses different embedded encryption libraries.In addition to the symmetric key, HELLOKITTY and FIVEHANDS also encrypts file metadata with the public key and appends this to the encrypted file.DEATHRANSOM generates an RSA key pair while HELLOKITTY and FIVEHANDS use an embedded RSA or NTRU public key.DEATHRANSOM EncryptionDEATHRANSOM creates an RSA-2048 public and private key pair. Using an Elliptic-curve Diffie–Hellman (ECDH) routine implemented with Curve25519, it computes a shared secret using two input values: 1) 32 random bytes from a RtlGenRandom call and 2) a hardcoded 32 byte value (attacker's public key). It also create a Curve25519 public key. The shared secret is SHA256 hashed and used as the key to Salsa20 encrypt the RSA public and private keys.The RSA public key is used to encrypt the individual symmetric keys that are used to encrypt each file. A Base64 encoded version of the encrypted RSA keys and the victim’s Curve25519 public key is included in the ransom note, providing the threat actors the information needed to decrypt the victim's files.For the symmetric key, DEATHRANSOM calls RtlGenRandom to generate 32 random bytes. This is the 32 byte key used to AES encrypt each file. After the file is encrypted, the AES key is encrypted with the public RSA key and appended to the file.DEATHRANSOM lastly appends the four magic bytes of AB CD EF AB at the end of the encrypted file and uses this as a check to ensure that it does not encrypt an already encrypted file.The analyzed DEATHRANSOM sample used for comparison does not change the file extension.HELLOKITTY EncryptionHELLOKITTY contains an embedded RSA-2048 public key. This public key is SHA256 hashed and used as the victim ID within the ransom note. This RSA pubic key is also used to encrypt each file's symmetric key.For the symmetric key, HelloKitty generates a 32 byte seed value based on the CPU timestamp. A Salsa20 key is generated and encrypts a second 32 byte seed value. The encrypted result is XOR’d with the first seed, resulting in a 32 byte key used to AES encrypt each file.After each file is encrypted, the original file size, magic value of DE C0 AD BA, and AES key are encrypted with the public RSA key and appended to the file. HELLOKITTY and FIVEHANDS appends this additional metadata to the encrypted file, while DEATHRANSOM does not.Lastly it appends the four magic bytes DA DC CC AB to the end of the encrypted file.Depending on the version, HELLOKITTY may or may not change the file extension.Other samples of HELLOKITTY have used an embedded NTRU public key instead of RSA.FIVEHANDS EncryptionFIVEHANDS uses an embedded NTRU public key. This NTRU key is SHA512 hashed and the first 32 bytes are used as the victim ID within the ransom note. This NTRU pubic key is also used to encrypt each file's symmetric key.For the symmetric key, FIVEHANDS uses an embedded generation routine to produce 16 random bytes used for an AES key to encrypt each file.After each file is encrypted, the original file size, magic value of DE C0 AD BA, and AES key are encrypted with the public NTRU key and appended to the file.The four magic bytes DB DC CC AB are appended to the end of the encrypted file.FIVEHANDS includes additional code not found in DEATHRANSOM and HELLOKITTY to use the Windows Restart Manager to close a file currently in use so that it can be unlocked and successfully encrypted.The encrypted file extension is changed to .crypt  extensionFIVEHANDS's encryption flow and sequence is very different from the other two, partially because it incorporates asynchronous I/O requests and uses different embedded encryption libraries.FIVEHANDS Encrypted DropperOne significant change between DEATHRANSOM and FIVEHANDS is the use of a memory-only dropper, which upon execution, expects a command line switch of -key followed by the key value necessary to perform decryption of its payload. The payload is stored and encrypted with AES-128 using an IV of “85471kayecaxaubv”. The decrypted FIVEHANDS payload is immediately executed after decryption. To date, Mandiant has only observed encrypted droppers with a common imphash of 8517cf209c905e801241690648f36a97.CLI argumentsFIVEHANDS can receive a CLI argument for a path, this limits the ransomware's file encryption activities to the specified directory. DEATHRANSOM and HELLOKITTY do not accept CLI arguments.Locale and Mutex checksDEATHRANSOM performs language ID and keyboard layout checks. If either of these match Russian, Kazakh, Belarusian, Ukrainian or Tatar it exits. Neither HELLOKITTY or FIVEHANDS perform language ID or keyboard checks.HELLOKITTY performs a mutex check while the other two do not perform mutex checks.File ExclusionsDEATHRANSOM and HELLOKITTY both exclude the same directories and files:programdata, $recycle.bin, program files, windows, all users, appdata, read_me.txt, autoexec.bat, desktop.ini, autorun.inf, ntuser.dat, iconcache.db, bootsect.bak, boot.ini, ntuser.dat.log, or thumbs.db.The exclusions for FIVEHANDS are more extensive and contain additional files and directories to ignore.Additional DifferencesDEATHRANSOM makes an external HTTPS connection to download a file. Neither HELLOKITTY or FIVEHANDS initiate network connections.HELLOKITTY contains code to set the victims wallpaper to a ransom related image. The other samples do not have this functionalityDifferent versions of DEATHRANSOM and HELLOKITTY are known to change the file extensionDifferent versions of HELLOKITTY are known to check for specific processes to terminate.FeatureFIVEHANDSHELLOKITTYDEATHRANSOMProgramming LanguageC++C++CSymmetric EncryptionAES 128AES 256AES 256Asymmetric EncryptionEmbedded NTRU KeyEmbedded RSA or NTRU KeyCurve25519 ECDH and RSA key creationSame directory and file name exclusionsNoYesYesAccepts CLI ArgumentsYesNoNoNetwork ConnectionsNoNoYesLocale CheckNoNoYesMutex CheckNoYesNoBytes Appended to Encrypted FilesDB DC CC ABDA DC CC ABAB CD EF ABTable 1: Ransomware feature comparisonConclusionMandiant observed SOMBRAT and FIVEHANDS ransomware by the same group since January 2021. While similarities between HELLOKITTY and FIVEHANDS are notable, ransomware may be used by different groups through underground affiliate programs. Mandiant will assign an uncategorized cluster based on multiple factors including infrastructure used during intrusions and as such, not all SOMBRAT or FIVEHANDS ransomware intrusions may have been conducted by UNC2447. WARPRISM and FOXGRABBER have been used in SUNCRYPT and DARKSIDE ransomware demonstrating additional complexity and sharing between different ransomware affiliate programs.IndicatorsSOMBRAT UNC244787c78d62fd35bb25e34abb8f4caace4a6382d48fae675084d30ccb69b4664cbb (31dcd09eb9fa2050aadc0e6ca05957bf unxored)SOMBRAT Launchercf1b9284d239928cce1839ea8919a7af (wwansvc.a XOR key)4aa3eab3f657498f52757dc46b8d1f11 (wwansvc.c)1f6495ea7606a15daa79be93070159a8 (wwansvc.bat)31dcd09eb9fa2050aadc0e6ca05957bf (wwansvc.b)edf567bd19d09b0bab4a8d068af15572 (wwansvc.b)a5b26931a1519e9ceda04b4c997bb01f (wwansvc.txt)f0751bef4804fadfe2b993bf25791c49 (4aa3eab3f657498f52757dc46b8d1f11 unxored)87c78d62fd35bb25e34abb8f4caace4a (edf567bd19d09b0bab4a8d068af15572 unxored)SOMBRAT domainsCelomito[.]com (unc2447)Feticost[.]com (unc2447)Cosarm[.]comPortalcos[.]comFIVEHANDS39ea2394a6e6c39c5d7722dc996daf05f568229e696c0e82abb35ec73d162d5eFIVEHANDS Encrypted Dropper6c849920155f48d4b4aafce0fc49eb5b22d35005e926fe29379cb07b810a607557824214710bc0cdb22463571a72afd087c0b190e3b4ab9214e10a2d1c1821531b0b9e4cddcbcb02affe9c8124855e5846ecc24ef6d20f3eaf71ff37610d57d11a79b6d169aac719c9323bc3ee4a8361a64d79eba40229ae9aaebbd73938b985HELLOKITTY136bd70f7aa98f52861879d7dca03cf206ce6cd8bde756265f95fcf4eecadbe9af568e8a6060812f040f0cb0fd6f5a7bd96adf82f061b1a6c80699364a1e3208DEATHRANSOMc50ab1df254c185506ab892dc5c8e24bWARPRISMc925822c6d5175c30ba96388b07e9e16 (unc2447)c171bcd34151cbcd48edbce13796e0edd87fcd8d2bf450b0056a151e9a116f72f739977004981fbe4a54bc68be18ea79e18b27f75c95b4d50bfcbcd00a5bd6c5df6e6b3e53cc713276a03cce8361ae0f1cd03c0d00f7bfa7ca73f7d73677d8f88071f66d64395911a7aa0d2057b9b00dc12a96e9c50db5f8b0b3b5f9f3f134f0e39184eacba2b05aaa529547abf41d2b09a05a2212bd2c0fe0e2881401fbff178226d7615532f32eca8c04ac0d41a9fda01a2ba3ae9f50a5aa8a5e349289108229e53b32d5b4aae6d9a3b3c81648653ca809068b052bc209d0ab13f6c5c8b4e7BEACON UNC244764.227.24[.]12 Havex Profile January 2021157.230.184[.]142  chches_ APT10 Profile November 2020-January 202174c688a22822b2ab8f18eafad2271cac7d6e57cbc112ebd3d3c95d3c73451a38FOXGRABBER4d3d3919dda002511e03310c49b7b47fFireEye DetectionsFireEye Network SecurityFireEye Email SecurityFireEye Detection On DemandFireEye Malware AnalysisFireEye Malware File Protect FIVEHANDSFE_Loader_Win32_Generic_162FE_Ransomware_Win32_FIVEHANDS_1Malware.Binary.exeRansomware.Win.Generic.MVXSOMBRATFE_Backdoor_Win64_SOMBRAT_1Backdoor.Win.SOMBRATMalware.Binary.exeBackdoor.Win.SOMBRAT.MVXFEC_Trojan_PS1_Generic_7FEC_Trojan_PS1_Generic_8FEC_Trojan_BAT_Generic_5HELLOKITTYRansomware.Win.Generic.MVXMalware.Binary.exeRansomware.Win.HELLOKITTY.MVXFE_Ransomware_Win_HELLOKITTY_1FE_Ransomware_Win32_HELLOKITTY_1DEATHRANSOMFE_Loader_Win32_Generic_92Ransomware.Win.Generic.MVXMalware.Binary.exeBEACONFE_Loader_Win32_BLUESPINE_1Backdoor.BEACONMalware.Binary.exeWARPRISMFE_Loader_PS1_WARPRISM_1FEC_Loader_PS1_WARPRISM_1Backdoor.BEACONTrojan.GenericTrojan.Win.SYSTEMBCBackdoor.MeterpreterLoader.PS1.WARPRISM.MVXMalware.Binary.exeMalware.Binary.ps1FOXGRABBERFE_Tool_MSIL_FOXGRABBER_1FE_Trojan_MSIL_Generic_109FireEye EndPoint SecurityReal-Time (IOC)SOMBRAT (BACKDOOR)SUSPICIOUS POWERSHELL READ BASE64 DATA (METHODOLOGY)FIVEHANDS RANSOMWARE (FAMILY)DEATHRANSOM RANSOMWARE (FAMILY)HELLOKITTY RANSOMWARE (FAMILY)BEACON (FAMILY)Malware Protection (AV/MG)SOMBRAT Generic.mg. 87c78d62fd35bb25Generic.mg.6382d48fae675084Trojan.GenericKD.45750384Trojan.GenericKD.36367848Generic.PwShell.RefA.CB5E962AFIVEHANDSGeneric.mg.39ea2394a6e6c39cGeneric.mg.f568229e696c0e82Generic.mg.6c849920155f48d4Generic.mg.22d35005e926fe29Generic.mg.57824214710bc0cdGeneric.mg.87c0b190e3b4ab92Generic.mg.1b0b9e4cddcbcb02Generic.mg.46ecc24ef6d20f3eGeneric.mg.1a79b6d169aac719Generic.mg.a64d79eba40229aeGen:Variant.Zusy.375932Gen:Variant.Zusy.366866Trojan.GenericKD.46059492Trojan.GenericKD.46059131Trojan.GenericKD.45996121Trojan.GenericKD.45702783WARPRISM Generic.mg.a01a2ba3ae9f50a5Trojan.PowerShell.Agent.IJTrojan.Agent.EXDRTrojan.PowerShell.Ransom.ETrojan.Agent.EUKPTrojan.GenericKD.45856129Heur.BZC.PZQ.Boxter.829.B5AEB7A6Heur.BZC.PZQ.Boxter.829.B84D01A7Heur.BZC.PZQ.Boxter.829.AE76D25CTrojan.PowerShell.Ransom.FDropped:Heur.BZC.MNT.Boxter.826.0A2B3A87Heur.BZC.PZQ.Boxter.829.A15701BDDEATHRANSOMGeneric.mg.c50ab1df254c1855Trojan.Ransomware.GenericKD.35760206HELLOKITTYGeneric.mg.136bd70f7aa98f52Generic.mg.06ce6cd8bde75626Generic.mg.af568e8a6060812fGeneric.mg.d96adf82f061b1a6Generic.Malware.PfVPk!12.299C21F3Gen:Variant.Ransom.HelloKitty.1Generic.Malware.PfVPk!12.606CCA24Generic.Malware.PfVPk!12.1454636CBEACONGeneric.mg.74c688a22822b2abGeneric.mg.7d6e57cbc112ebd3Trojan.Agent.DDSNMITRE ATT&CKTacticDescriptionInitial AccessT1078 Valid AccountsExecutionT1047 Windows Management InstrumentationT1053.005 Scheduled Task / Job: Scheduled TaskT1059.001 Command and Scripting Interpreter: PowerShellT1106 Execution through APIDefense EvasionT1045 Software PackingT1055 Process InjectionT1140 Deobfuscate / Decode Files or InformationDiscoveryT1012 Query RegistryT1046 Network Service ScanningT1057 Process DiscoveryT1082 System Information DiscoveryT1124 System Time DiscoveryT1135 Network Share DiscoveryCollectionT1560.003 Archive Collected Data: Archive via Custom MethodImpactT1485 Data DestructionT1486 Data Encrypted for ImpactT1490 Inhibit System RecoveryCommand and ControlT1071.001 Application Layer Protocol: Web ProtocolsT1090.002 Proxy: External ProxyT1572  Protocol TunnelingT1573.002 Encrypted Channel: Asymmetric CryptographyExfiltrationT1041 Exfiltration over C2 ChannelAcknowledgementsThanks to Nick Richard for technical review, Genevieve Stark and Kimberly Goody for analytical contributions, and Jon Erickson, Jonathan Lepore, and Stephen Eckels for analysis incorporated into this blog post. Link to RSS feedPrepare for 2024's cybersecurity landscape.Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon. Download now  Have questions? Let's talk.Mandiant experts are ready to answer your questions. Contact Us  Follow us Footer Mandiant Advantage Platform Platform Overview Security Validation Attack Surface Management Threat Intelligence Digital Threat Monitoring Managed Defense Solutions Proactive Exposure Management Ransomware Industrial Controls & OT Cyber Risk Management Digital Risk Protection Insider Threats Cyber Security Skills Gap Election Security Government Cyber Security Manufacturing Cyber Threat Visibility Attack Surface Visibility Cyber Preparedness Detection and Response Financial Services Cyber Security Services Services Overview Incident Response Strategic Readiness Cyber Security Transformation Technical Assurance View all Services (48) Expertise on Demand Mandiant Academy Overview Education Formats Upcoming Courses On-Demand Courses Certifications ThreatSpace Cyber Range Free Course Sneak Peaks Resources Resource Center Blog Podcasts  Customer Stories Reports Webinars Insights eBooks Infographics White Papers Datasheets Company About Us Careers Events Media Center Partners Partners Overview Technology Partners Cyber Risk Partners Service Partners Channel Partners Partner Portal Connect with Mandiant Contact Us Report an Incident Customer Support Customer Success Media Inquiries  REPORTMandiant frontline observations provide insights into today’s top cyber defense topics.Learn about the 4 critical areas.  Get the Report  © Copyright 2024 Mandiant. All rights reserved.Bottom Website Privacy Policy Terms & Conditions Compliance Site Map  