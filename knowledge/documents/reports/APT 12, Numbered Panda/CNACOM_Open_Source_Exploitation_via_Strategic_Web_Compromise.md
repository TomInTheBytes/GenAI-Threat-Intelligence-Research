# Reference for threat actor for "APT 12, Numbered Panda"

**Title**: CNACOM Open Source Exploitation via Strategic Web Compromise

**Source**: https://www.zscaler.com/blogs/research/cnacom-open-source-exploitation-strategic-web-compromise

## Content
CNACOM Open Source Exploitation via Strategic Web CompromiseThis site uses JavaScript to provide a number of functions, to use this site please enable JavaScript in your browser.Concerned about VPN vulnerabilities? Learn how you can benefit from our VPN migration offer including 60 days free service.Talk to an expertCloseOpenSearchCXO REvolutionariesCareersPartnersSupportShowContact UsOptionsGet in touch1-408-533-0288Chat with usShowSign InOptionsZscaler Cloud Portal | AdminZscaler Cloud Portal One | AdminZscaler Cloud Portal Two | AdminZscaler Cloud Portal Three | AdminZscaler Cloud Portal Beta | Adminadmin.zscloud.netZscaler Private Access Sign-InHomeThe Zscaler ExperienceProducts & SolutionsPlatformResourcesCompanyRequest a demoopen searchopen navigationThe Zscaler ExperienceZscaler: A Leader in the 2023 Gartner® Magic Quadrant™ for Security Service Edge (SSE)Get the full reportYour world, securedExperience the transformative power of zero trust.The Zscaler DifferenceThe Zscaler DifferenceExperience the World’s Largest Security CloudCustomer Success StoriesAnalyst RecognitionMachine Learning and AI at ZscalerReduce Your Carbon FootprintZero Trust FundamentalsZero Trust FundamentalsWhat Is Zero Trust?What Is Security Service Edge (SSE)?What Is Secure Access Service Edge (SASE)?What Is Zero Trust Network Access (ZTNA)?What Is Secure Web Gateway (SWG)?What Is Cloud Access Security Broker (CASB)?What Is Cloud Native Application Protection Platform (CNAPP)?Zero Trust ResourcesProducts & SolutionsSecure Your UsersProvide users with seamless, secure, reliable access to applications and data.Secure Your WorkloadsBuild and run secure cloud apps, enable zero trust cloud connectivity, and protect workloads from data center to cloud.Secure Your IoT and OTProvide zero trust connectivity for IoT and OT devices and secure remote access to OT systems.ProductsProductsTransform your organization with 100% cloud native servicesSecure Internet Access (ZIA)Secure Private Access (ZPA)Digital Experience (ZDX)Data Protection (CASB/DLP)Posture ControlSolution AreasSolution AreasPropel your business with zero trust solutions that secure and connect your resourcesCyberthreat ProtectionData ProtectionZero Trust NetworkingBusiness AnalyticsVPN AlternativeZero Trust SASEAccelerate M&A IntegrationOptimize Digital ExperiencesZero Trust SD-WANZero Trust Cloud ConnectivityZero Trust for IoT/OTFind a Product or SolutionPartner IntegrationsIndustry and Market SolutionsPlatformZero Trust Exchange PlatformLearn how Zscaler delivers zero trust with a cloud native platform that is the world’s largest security cloudZero Trust Exchange PlatformTitle LinkTransform with Zero Trust ArchitectureTransform with Zero Trust ArchitecturePropel your transformation journeySecure Digital TransformationNetwork TransformationApplication TransformationSecurity TransformationSecure Your Business GoalsSecure Your Business GoalsAchieve your business and IT initiativesEnsure Secure Business ContinuityAccelerate M&A and DivestituresRecession-Proof Your EnterpriseSecure Your Hybrid WorkforceDownload Zscaler Client ConnectorResourcesLearn, connect, and get support.Explore tools and resources to accelerate your transformation and secure your worldLearn, connect, and get support.Title LinkAmplifying the voices of real-world digital and zero trust pioneersVisit nowResource CenterResource CenterStay up to date on best practicesResource LibraryBlogCustomer Success StoriesWebinarsZpediaEvents & TrainingsEvents & TrainingsFind programs, certifications, and eventsUpcoming EventsZenith LiveZscaler AcademyInteractive Zscaler Whiteboard WorkshopSecurity Research & ServicesSecurity Research & ServicesGet research and insights at your fingertipsThreatLabz AnalyticsToolsToolsTools designed for youSecurity PreviewSecurity and Risk AssessmentSecurity Advisory UpdatesDisclose a VulnerabilityExecutive Insights AppRansomware Protection ROI CalculatorCommunity & SupportCommunity & SupportConnect and find supportCustomer Success CenterZenith CommunityCXO REvolutionariesZscaler Help PortalExplore the latest Zscaler InnovationsIndustry & Market SolutionsIndustry & Market SolutionsSee solutions for your industry and countryPublic SectorHealthcareFinancial ServicesEducationSee allResource CenterResource CenterStay up to date on best practicesResource LibraryBlogCustomer Success StoriesWebinarsZpediaEvents & TrainingsEvents & TrainingsFind programs, certifications, and eventsUpcoming EventsZenith LiveZscaler AcademyInteractive Zscaler Whiteboard WorkshopSecurity Research & ServicesSecurity Research & ServicesGet research and insights at your fingertipsThreatLabz AnalyticsToolsToolsTools designed for youSecurity PreviewSecurity and Risk AssessmentSecurity Advisory UpdatesDisclose a VulnerabilityExecutive Insights AppRansomware Protection ROI CalculatorCommunity & SupportCommunity & SupportConnect and find supportCustomer Success CenterZenith CommunityCXO REvolutionariesZscaler Help PortalExplore the latest Zscaler InnovationsIndustry & Market SolutionsIndustry & Market SolutionsSee solutions for your industry and countryPublic SectorHealthcareFinancial ServicesEducationSee allCompanyAbout ZscalerDiscover how it began and where it’s goingPartnersMeet our partners and explore system integrators and technology alliancesNews & AnnouncementsStay up to date with the latest newsLeadership TeamMeet our management teamPartner IntegrationsExplore best-in-class partner integrations to help you accelerate digital transformationInvestor RelationsSee news, stock information, and quarterly reportsEnvironmental, Social & GovernanceLearn about our ESG approachCareersJoin our missionPress CenterFind everything you need to cover ZscalerComplianceUnderstand our adherence to rigorous standardsZenith VenturesUnderstand our adherence to rigorous standardsZscaler BlogGet the latest Zscaler blog updates in your inboxSubscribeSecurity ResearchCNACOM - Open Source Exploitation via Strategic Web CompromiseED MILESDecember 01, 2016 - 5 min read Security InsightsContentsArticleMore blogsCopy URLCopy URLIntroduction
Since a full proof of concept for CVE-2016-0189 vulnerability was published on GitHub, Zscaler ThreatLabZ has been closely tracking its proliferation. The first copying of the exploit code we spotted was from the Sundown exploit kit (EK), followed closely by Magnitude and a resurgent KaiXin EK. In addition to the commoditized EKs, this exploit code has been leveraged in numerous one-shot and gated web-exploitation campaigns, delivered through a mix of the usual malvertising networks and compromised websites.
This blog details CNACOM, a web-based campaign that appears to be related to a well-known nation-state actor more commonly associated with spear-phishing attacks.
Infection Cycle

Figure 1 - An overview of the campaign's infection flow, highlighting the targeted organizations
On November 7, we spotted a malicious injection on the registration page of a major Taiwanese public service website. An iframe was injected into the footer of the page, which then loaded a unique landing page containing the CVE-2016-0189 exploit code.
 

Figure 2 - An injected iframe with the name "abc" redirects visitors to the attack code
The landing page, hosted on an RHCloud virtual private server (VPS), begins with a nearly identical copy of the GitHub-published code, though the payload invocation appears to use a sandbox escape via CVE-2015-0116.
 

Figure 3 - A VBScript function named "abc" uses a combination of CVE-2016-0189 as well as what appears to be CVE-2015-0116 to gain code execution outside of the Internet Explorer (IE) sandbox
Following the exploit code, things get a lot more interesting. The user's external IP address is stored as a string and an ipToInt() function is defined, followed by a set of subroutines to collect details from the user machine. The code gathers the OS version, browser name, version, and language setting, Flash and Java versions, installed Office version, and finally the raw User-Agent string from the browser. This is all sent to the RHCloud host via a GET request. 

Figure 4 - The landing page collects many aspects of the user's platform, including MS Office version information
After the fingerprinting code, the user's IP address is checked against Taiwanese government network ranges. If the user is coming from one of the targeted networks and is using a version of Internet Explorer, exploitation will be attempted.

Figure 5 - The exploitation routine will be triggered for any Internet Explorer version, as long as the user's IP address is in one of the nine target networks
ThreatLabZ was able to follow the infection cycle and download a sample that appears to be a variant of the IXESHE AES malware. IXESHE is a family of backdoor malware known to be utilized by an attack group identified by various names including the IXESHE label, APT12, Numbered Panda, and DynCalc.

Figure 6 - Upper: among other changes seen, the new variant builds stack strings up to 4 bytes at a time. Lower: old variants do it byte-by-byte
Upon execution, the malware gathers the Windows username, hostname, local IP address, and Windows version. The hostname is fed to a PJW hash, or ElfHash function to generate a machine ID used in callbacks. The last step before initiating the C&C check-in is to achieve persistence by installing a run key in HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Messenger.

Figure 7 - Simplified decompiled code for the persistence mechanism shows the Run key utilized
This sample uses almost similar communication techniques as previous variants, with the addition of SSL. In our observations, we saw the server present a self-signed certificate with short, random-looking strings in the informational fields.

Figure 8 - A self signed certificate is used for the C&C server
Callback URLs


/CEL%d=%d.cgi?%s - check-in at startup (and after certain C&C reset/error conditions)


/DES%d=%d.cgi?%s - standard beacon, check for command


/RES%d=%d.cgi?%s - response to rsh command


/SDU%d=%d.cgi?%s - error response


/SUS%d=%d.cgi?%s - check-out after receiving shutdown message


As can be seen above, the callback URLs utilize the same general format: three capital letters denoting the response function or condition, an integer representing the PJW/ElfHash based host ID, an equal sign ("="), a random integer, the string ".cgi?", and a base64 response blob (which in some cases simply encodes another random integer).  The following regular expression matches this variant's URL path/query components: [CDRS][EDU][LSU]\d+=\d+\.cgi\?[a-zA-Z0-9=\+\/]+.

Figure 9 - A collapsed view of the decompiled C&C command processing code shows handling for multiple input commands and several response types
Unlike many historical IXESHE samples, it appears that this variant doesn't utilize campaign codes embedded in the malware itself. This may be due to a more centralized tracking system that only relies on the malware reporting a machine ID.
 
Conclusion
This analysis represents a snapshot of recent activity related to the CNACOM campaign. Additionally, we have identified an exploitation campaign active in August 2015 that appears to have utilized the HackingTeam Flash exploit for CVE-2015-5122, though the landing page at that time targeted a different set of Taiwanese government networks. Whether or not the threat actor behind this campaign is actually the group named APT12, the targeting of Taiwanese government networks and the similarity of this strain to historic IXESHE samples provide strong reasons for suspicion.
Zscaler ThreatlabZ will continue to monitor activity from this group ensuring protection against this threat.
Indicators of Compromise
 

Filename: cnacom.exe
Source: cnacom-organied.rhcloud\.com/cnacom.exe
MD5: ACFA9C664016BFE5DB92557E923744F0
Compile Time: 11/04/2016 11:56:27
Hardcoded User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:43.0) Gecko/20100101 Firefox/43.0
C&C: 74.200.214.226
 
 Thank you for readingWas this post useful?Yes, very!Not reallyExplore more Zscaler blogsAgniane Stealer: Dark Web’s Crypto ThreatRead postThe Impact of the SEC’s New Cybersecurity PoliciesRead postSecurity Advisory: Remote Code Execution Vulnerability (CVE-2023-3519)Read postThe TOITOIN Trojan: Analyzing a New Multi-Stage Attack Targeting LATAM RegionRead post01
                /
                02Go to next slideGo to previous slideGet the latest Zscaler blog updates in your inboxBy submitting the form, you are agreeing to our privacy policy. THE ZSCALER EXPERIENCELearn about:Your world, securedZero TrustSecure Access Service Edge (SASE)Security Service Edge (SSE)Zero Trust Network Access (ZTNA)Secure Web Gateway (SWG)Cloud Access Security Broker (CASB)Cloud Native Application Protection Platform (CNAPP)PRODUCTS & SOLUTIONSSecure Your UsersSecure Your WorkloadsSecure Your IoT and OTSecure Internet Access (ZIA)Data Protection (CASB/DLP)Digital Experience (ZDX)Posture ControlIndustry & Market SolutionsPartner IntegrationsZscaler Client ConnectorPLATFORMZero Trust Exchange PlatformSecure Digital TransformationNetwork TransformationApplication TransformationSecurity TransformationRESOURCESResource LibrarySecurity PreviewSecurity & Risk AssessmentThreatLabz Analytics & InsightsUpcoming EventsBlogZscaler AcademyCXO RevolutionariesZpediaRansomware Protection ROI CalculatorPOPULAR LINKSPricing & PlansAbout ZscalerLeadership TeamCareer OpportunitiesFind or Become a PartnerCustomer Success CenterInvestor RelationsPress CenterNews & AnnouncementsESGComplianceContact ZscalerHomeEnglishFrançaisDeutschItaliano日本Castellano - MexicoCastellano - EspañaPortugues - BrasilZscaler is universally recognized as the leader in zero trust. Leveraging the largest security cloud on the planet, Zscaler anticipates, secures, and simplifies the experience of doing business for the world's most established companies. EnglishFrançaisDeutschItaliano日本Castellano - MexicoCastellano - EspañaPortugues - BrasilVisit us on FacebookLinkedinFollow us on TwitterSubscribe our Youtube ChannelSitemapPrivacyLegalSecurity© 2024 Zscaler, Inc. All rights reserved. Zscaler™ and other trademarks listed at zscaler.com/legal/trademarks are either (i) registered trademarks or service marks or (ii) trademarks or service marks of Zscaler, Inc. in the United States and/or other countries. Any other trademarks are the properties of their respective owners.


