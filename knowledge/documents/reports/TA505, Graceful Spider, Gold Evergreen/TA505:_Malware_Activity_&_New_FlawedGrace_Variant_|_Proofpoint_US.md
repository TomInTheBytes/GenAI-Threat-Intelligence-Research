# Reference for threat actor for "TA505, Graceful Spider, Gold Evergreen"

**Title**: TA505: Malware Activity & New FlawedGrace Variant | Proofpoint US

**Source**: https://www.proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant

## Content































































TA505: Malware Activity & New FlawedGrace Variant | Proofpoint US









      Skip to main content
    







Products
Solutions
Partners
Resources
Company











English (Americas)
English (Europe, Middle East, Africa)
English (Asia-Pacific)
Español
Deutsch
Français
Italiano
Português
日本語
한국어



Login

Support Log-in
Digital Risk Portal
Email Fraud Defense
ET Intelligence
Proofpoint Essentials
Sendmail Support Log-in


Contact






Aegis Threat Protection PlatformDisarm BEC, phishing, ransomware, supply chain threats and more.
Sigma Information Protection PlatformDefend your data from careless, compromised and malicious users.
Identity Threat Defense PlatformPrevent identity risks, detect lateral movement and remediate identity threats in real time.
Intelligent Compliance PlatformReduce risk, control costs and improve data visibility to ensure compliance.
Premium ServicesLeverage proactive expertise, operational continuity and deeper insights from our skilled experts.





Email Security and Protection
Email Protection
Email Fraud Defense
Secure Email Relay
Threat Response Auto-Pull
Sendmail Open Source
Essentials for Small Business

Advanced Threat Protection
Targeted Attack Protection in Email
Threat Response
Emerging Threats Intelligence

Security Awareness Training
Assess
Change Behavior
Evaluate


Information Protection
Enterprise Data Loss Prevention (DLP)
Insider Threat Management
Intelligent Classification and Protection
Endpoint Data Loss Prevention (DLP)
Email Data Loss Prevention (DLP)
Email Encryption
Data Discover

Cloud Security
Isolation
Cloud App Security Broker
Web Security


Identity Threat Detection and Response
Spotlight
Shadow


Compliance and Archiving
Automate
Capture
Patrol
Track
Archive
Discover
Supervision


Premium Services
Managed Email Threat Protection
Managed Information Protection
Managed Security Awareness
Managed Abuse Mailbox
Recurring Consultative Services
Technical Account Managers
Threat Intelligence Services
People-Centric Security Program






  New threat protection solution bundles with flexible deployment options 
  AI-powered protection against BEC, ransomware, phishing, supplier risk and more with inline+API or MX-based deployment
Learn More






Solutions by Topic


Combat Email and Cloud ThreatsProtect your people from email and cloud threats with an intelligent and holistic approach.
Change User BehaviorHelp your employees identify, resist and report attacks before the damage is done.
Combat Data Loss and Insider RiskPrevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats.
Modernize Compliance and ArchivingManage risk and data retention needs with a modern compliance and archiving solution.
Protect Cloud AppsKeep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk.


Prevent Loss from RansomwareLearn about this growing threat and stop attacks by securing today’s top ransomware vector: email.
Secure Microsoft 365Implement the very best security and compliance solution for your Microsoft 365 collaboration suite.
Defend Your Remote Workforce with Cloud EdgeSecure access to corporate resources and ensure business continuity for your remote workers.
Authenticate Your EmailProtect your email deliverability with DMARC.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.




Solutions by Industry

Federal Government
State and Local Government
Higher Education
Financial Services
Healthcare
Mobile Operators
Internet Service Providers
Small and Medium Businesses






Partner Programs


Channel PartnersBecome a channel partner. Deliver Proofpoint solutions to your customers and grow your business.
Archive Extraction PartnersLearn about Proofpoint Extraction Partners.
Global System Integrator (GSI) and Managed Service Provider (MSP) PartnersLearn about our global consulting and services partners that deliver fully managed and integrated solutions.


Technology and Alliance PartnersLearn about our relationships with industry-leading firms to help protect your people, data and brand.
Social Media Protection PartnersLearn about the technology and alliance partners in our Social Media Protection Partner program.
Proofpoint Essentials Partner ProgramsSmall Business Solutions for channel partners and MSPs.




Partner Tools

Become a Channel Partner
Channel Partner Portal








Resource LibraryFind the information you're looking for in our library of videos, data sheets, white papers and more.
BlogKeep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
PodcastsLearn about the human side of cybersecurity. Episodes feature insights from experts and executives.
New Perimeters MagazineGet the latest cybersecurity insights in your hands – featuring valuable knowledge from our own industry experts.


Threat GlossaryLearn about the latest security threats and how to protect your people, data, and brand.
EventsConnect with us at events to learn how to protect your people and data from ever‑evolving threats.
Customer StoriesRead how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
WebinarsBrowse our webinar library to learn about the latest threats, trends and issues in cybersecurity.




Security Hubs

Get free research and resources to help you protect against threats, build a security culture, and stop ransomware in its tracks.

Threat Hub
CISO Hub
Cybersecurity Awareness Hub
Ransomware Hub
Insider Threat Management Hub









About ProofpointProofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.
CareersStand out and make a difference at one of the world's leading cybersecurity companies.


News CenterRead the latest press releases, news stories and media highlights about Proofpoint.
Privacy and TrustLearn about how we handle data and make commitments to privacy and other regulations.
Environmental, Social, and GovernanceLearn about our people-centric principles and how we implement them to positively impact our global community.




Support

Access the full range of Proofpoint support services.
Learn More











 




BlogThreat Insight
                                    Whatta TA: TA505 Ramps Up Activity, Delivers New FlawedGrace Variant
                              

 












Whatta TA: TA505 Ramps Up Activity, Delivers New FlawedGrace Variant





Share with your network!








 October 19, 2021


                Zydeca Cass, Axel F, Crista Giering, Matthew Mesa, Georgi Mladenov, and Brandon Murphy
  
        

 Key Takeaways 
The prominent TA505 has returned to distributing large volumes of malicious emails affecting most industries.
New tools include a KiXtart Loader, the MirrorBlast loader, an updated FlawedGrace variant, and updated malicious Excel attachments.
One of the region-specific campaigns targeted German-speaking countries, notably Germany and Austria.
The campaigns share many similarities with TA505 campaigns from 2019 and 2020.
Overview 
Since early September 2021, Proofpoint researchers are tracking renewed malware campaigns by the financially driven TA505. The campaigns, which are distributed across a wide range of industries, started with low volume email waves that ramped up in late September, resulting in tens to hundreds of thousands of emails. 
Many of the campaigns, especially the large volume ones, strongly resemble the historic TA505 activity from 2019 and 2020. The commonalities include similar domain naming conventions, email lures, Excel file lures, and the delivery of the FlawedGrace remote access trojan (RAT). The campaigns also contain some noteworthy, new developments, such as retooled intermediate loader stages scripted in Rebol and KiXtart, which are used instead of the previously popular Get2 downloader. The new downloaders perform similar functionality of reconnaissance and pulling in the next stages. Lastly, there is an updated version of FlawedGrace.
Evolving Campaigns
The initial campaigns observed by Proofpoint in September 2021 were comparatively small in volume, several thousand emails per wave, and delivered malicious Excel attachments. In late September and in early October 2021 this changed, and TA505 began sending higher email volumes, tens to hundreds of thousands, to more industries. Additionally, the actor began leveraging both URL and attachment-based email campaigns and diversified from targeting predominantly North America to also targeting German-speaking countries, including Germany and Austria.
September 2021 Campaigns
The early campaigns identified by Proofpoint in September 2021 were low volume compared to typical TA505 activity, with only several thousand messages per wave. TA505 used more specific lures that did not affect as many industries as the more recent October 2021 campaigns. Example lures included legal, media release, situation report, and health claim themes. These early campaigns also largely focused on targets in North America, such as United States and Canada. 
The emails contained an Excel attachment that, when opened and macros enabled, would lead to the download and running of an MSI file. The MSI file in turn would execute an embedded Rebol loader, dubbed by Proofpoint as MirrorBlast.
Figure 1. Email purporting to be from an insurance claims analyst, part of the September 28, 2021 campaign.
Figure 2. The insurance claim Excel attachment, part of the September 28, 2021 campaign.
October 2021 Campaigns 
In late September and throughout October 2021, Proofpoint observed a shift to familiar TA505 tactics, techniques, and procedures (TTPs) that are reminiscent of the actor’s 2019 and 2020 campaigns. An additional intermediary loader scripted in KiXtart was introduced, and the attack chain evolved to the following:
An email containing one of the below:
Excel attachment
HTML attachment that links to the download of an Excel file
URL linking to a landing page that redirects to the download of an Excel file
URL directly linking to an Excel file

The Excel file macros download and run an MSI file
The MSI file executes an embedded KiXtart loader
The KiXtart loader receives a command from the C&C server to download another MSI file that executes MirrorBlast
MirrorBlast then downloads additional Rebol script stagers
The follow-on Rebol stagers drop ReflectiveGnome
ReflectiveGnome in turn downloads more shellcode, that will then drop and detonate FlawedGrace
The email lures moved away from the detailed lures seen initially in this spate of campaigns. They became more generic, with subjects such as “SECUREFILE,” “SECURE DOCUMENT,” and “You’ve been sent a secure message.” Additionally, the themes and abused brands included COVID-19, DocuSign, insurance, invoices, and Microsoft.

Figure 3. October 13, 2021 German-language email using a OneDrive shared file lure.

Figure 4. October 13, 2021 landing page abusing Microsoft and OneDrive branding.

Figure 5. Excel file used in the October 13, 2021 campaign with a simple green lure.
Similarities to Historic TA505 Activity
There is much similarity between the new and historic TA505 campaigns, starting with the emails. 

Figure 6. The OneDrive shared file email lure used in August 21, 2020 (left) strongly resembles a similar email from October 7, 2021 (right). Note the additional use of a COVID-19 theme in the recent campaign. 
The landing pages in historic and current TA505 campaigns contain “IP Logger” links that likely enable TA505 to track the IP addresses of the machines downloading the malicious files. Additionally, TA505 is still mimicking file hosting services in the landing pages.

Figure 7. The landing page used in a November 21, 2019 campaign is shown on the left, while the landing page used in the October 7, 2021 campaign is shown on the right.
While the Excel macros VBA code in the recent TA505 campaigns is different, some of the Excel graphic lures are similar or identical to those previously used by TA505.

Figure 8. The Excel sheet lure spoofing Microsoft logos remained identical from September 2, 2020 (Left) to October 6, 2021 (Right).
Domain naming conventions: It is also notable that TA505 has historically used domains that mimic various file hosting service providers and structured them in formats with hyphen separated terms. The domains used in late September 2021 and onward follow this structure.
Code reuse: Proofpoint researchers found code reuse in parts of the delivery chain such as in multiple parts of the landing page (see an example mentioned here).
Excel Macros Analysis
For TA505’s 2021 campaigns to be successful, potential victims must enable macros after opening the malicious Excel files. The code responsible for downloading the next stage MSI file was typically lightly obfuscated with filler characters, string reversing or similar simple functions and hidden in the document Comments, Title, in a Cell or other locations.

Figure 9. Example Excel macros code.

Figure 10. The parameters Subject and Comments are stored in the workbook properties.

Figure 11. Deobfuscated downloader JScript. This pulls the next stage—an MSI file.
Intermediate Loaders 
TA505 now uses multiple intermediate loaders before the delivery of the FlawedGrace RAT. The new loader stages are coded in uncommon scripting languages—Rebol and KiXtart. They appear to serve the same purpose as Get2—a downloader that has been in use by TA505 since 2019 to deliver a variety of secondary payloads. The loaders perform minimal reconnaissance of an infected machine, such as collecting user domain and username information, and download further payloads.

Figure 12. Attack paths ultimately leading to FlawedGrace.
In the attack chain, the Excel macros download the first MSI file, which executes the first loader, encoded in KiXtart scripting language. The KiXtart interpreter then receives a command from the C&C server to download a follow-on MSI package. Of note, KiXtart loader is not always part of the attack chain. The second MSI package contains multiple files that may have different names, for example, AudioDriver.exe (the Rebol interpreter), AudioDriver.exe.lnk (command that informs .ico execution), and image.ico (the Rebol script). This Rebol script is the second new downloader in the chain, that Proofpoint dubbed MirrorBlast.

Figure 13. Example of MirrorBlast script, it may be slightly different in different campaigns.
MirrorBlast in turn downloads additional Rebol script stagers that execute simple downloaders, dubbed by Proofpoint as ReflectiveGnome. ReflectiveGnome in turn downloads more shellcode, that will then drop and detonate FlawedGrace.

Figure 14. Rebol script downloaded by MirrorBlast that drops ReflectiveGnome loader (dwm-x64.exe / dwm-x32.exe).

Figure 15. ReflectiveGnome loader which executes the next stage as a shellcode.

Figure 16. This shellcode drops and detonates an updated FlawedGrace.
Updated FlawedGrace RAT
Proofpoint researchers first observed FlawedGrace in November 2017. It is a full-featured RAT written in C++ that can receive the following commands from its C&C via a custom binary protocol on TCP port 443: 
target_remove
target_update
target_reboot
target_module_load
target_module_load_external
target_module_unload
target_download
target_upload
target_rdp
target_passwords
target_servers
target_script
destroy_os
desktop_stat
While Proofpoint researchers are still investigating the updates to this version of FlawedGrace, some notable changes include:
Encrypted strings
Obfuscated API calls
Configuration is now stored as an encrypted resource (initial/default config), then it is stored both in a mapped memory region (current configuration instance) and in the registry (persistence)
Attribution
Proofpoint attributes the campaigns discussed in this blog to TA505 with high confidence. Proofpoint's assessment that TA505 is responsible for this renewed activity is based on the aforementioned similarities between historic TA505 campaigns and this new activity, including, but not limited to, code similarities, domain naming patterns and the use of FlawedGrace, which has been almost exclusively linked to TA505 activity.
Outlook
TA505 is an established threat actor that is financially motivated and known for conducting malicious email campaigns on a previously unprecedented scale. The group regularly changes their TTPs and are considered trendsetters in the world of cybercrime. This threat actor does not limit its target set, and is, in fact, an equal opportunist with the geographies and verticals it chooses to attack. This combined with TA505’s ability to be flexible, focusing on what is the most lucrative and shifting its TTPs as necessary, make the actor a continued threat. 
Proofpoint researchers expect TA505 to continue to adjust its operations and methods always with an eye to financial gain. Using intermediate loaders in its attack chain is also likely to become a longer-term technique employed by the threat actor.
 
EmergingThreats Detection Rules
2034012 - ET TROJAN MirrorBlast Checkin (trojan.rules)
2034022 - ET TROJAN MirrorBlast CnC Activity M2 (trojan.rules)
2034023 - ET TROJAN MirrorBlast CnC Activity M3 (trojan.rules)
2034091 - ET TROJAN MirrorBlast KiXtart Downloader Client Request (trojan.rules)
2034110 - ET TROJAN MirrorBlast KiXtart Downloader Server Response (trojan.rules)
2034136 - ET TROJAN MirrorBlast KiXtart Downloader Client Request M2 (trojan.rules)
2034042 - ET TROJAN ReflectiveGnome Download Activity (trojan.rules)
EmergingThreats PRO Detection Rules
2850099 - ETPRO TROJAN FlawedGrace CnC Activity M2 (trojan.rules)
2850098 - ETPRO TROJAN FlawedGrace CnC Activity M1 (trojan.rules)
Indicators of Compromise

IOC


IOC Type


Description


hxxp://139.59.93.223/c[.]php


URL


MirrorBlast C&C


hxxp://menorukis[.]su


URL


MirrorBlast C&C


hxxp://fidufagios[.]com/


URL


MirrorBlast C&C


hxxp://feristoaul[.]com/


URL


MirrorBlast C&C


hxxp://172.105.178.119/install[.]msi


URL


MSI Download


hxxp://207.246.101.153/chrome[.]msi


URL


MSI Download


hxxp://207.246.101.153/setup[.]msi


URL


MSI Download


cdn-wfs-nspod[.]com


Domain


FlawedGrace C&C


hxxps://cdn03664-dl-fileshare[.]com/files/xls/Employee%20Update%20-%20Covid[.]xls


URL


Initial Download


hxxps://cdn-8846-sharepoint-office[.]com/CL09302021_00137[.]xls


URL


Initial Download


hxxps://cdn-8846-sharepoint-office[.]com/COVID19_list[.]xls


URL


Initial Download


hxxps://cdn-8846-sharepoint-office[.]com/FP01102021_001[.]xls


URL


Initial Download


hxxps://dzikic-my-sharepoint[.]com/file/Manulife_policy[.]xls


URL


Initial Download


hxxps://dzikics-my-sharepoint[.]com/file/Employee_Authorization_Form[.]xls


URL


Initial Download


hxxp://141.164.41[.]231/host64_sh[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://141.164.41[.]231/host32_pic[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://89.44.197[.]46/host64_sh[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://89.44.197[.]46/host32_pic[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://193.42.36[.]110/host64_sh[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://193.42.36[.]110/host32_pic[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://5.149.255[.]14/host64_sh[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://5.149.255[.]14/host32_pic[.]bin


URL


MirrorBlast Payload (FlawedGrace)


hxxp://155.138.205[.]35/?pool


URL


First Stage Kixtart Script Payload


hxxp://45.79.239[.]23/version.php?data=


URL


First Stage Kixtart Script C&C


hxxp://185.202.93[.]201:80/mlp[.]php


URL


First Stage Kixtart Script C&C


hxxp://185.183.96[.]147/?data=


URL


First Stage Kixtart Script C&C


hxxp://185.176.220[.]198/?data=


URL


First Stage Kixtart Script C&C


hxxp://155.138.205[.]35/


URL


Excel MSI Payload


hxxp://95.216.138[.]82/


URL


Excel MSI Payload


hxxp://194.180.174[.]6/


URL


Excel MSI Payload


hxxp://185.10.68[.]235/


URL


Excel MSI Payload


hxxp://185.225.19[.]246/


URL


Excel MSI Payload


hxxp://185.225.19[.]156/


URL


Kixtart Payload (MirrorBlast)


hxxp://192.36.27[.]92/10opd3r_load[.]msi


URL


Kixtart Payload (MirrorBlast)


hxxp://5.188.108[.]40/trehjugdr4et6u[.]msi


URL


Kixtart Payload (MirrorBlast)








Previous Blog Post


Next Blog Post







Subscribe to the Proofpoint Blog

























About


Overview
Why Proofpoint
Careers
Leadership Team
News Center
Nexus Platform
Privacy and Trust




Threat Center


Threat Hub
Cybersecurity Awareness Hub
Ransomware Hub
Threat Glossary
Threat Blog








Products


Email Security & Protection
Advanced Threat Protection
Security Awareness Training
Cloud Security
Archive & Compliance
Information Protection
Product Bundles




Resources


White Papers
Webinars
Data Sheets
Events
Customer Stories
Blog
Free Trial








Connect


+1-408-517-4710
Contact Us
Office Locations
Request a Demo




Support


Support Login
Support Services
IP Address Blocked?
















Facebook
Twitter
linkedin
Youtube





English (US)
English (UK)
English (AU)
Español
Deutsch
Français
Italiano
Português
日本語
한국어





© 2024. All rights reserved.
            Terms and conditions
Privacy Policy
Sitemap

 







 

















