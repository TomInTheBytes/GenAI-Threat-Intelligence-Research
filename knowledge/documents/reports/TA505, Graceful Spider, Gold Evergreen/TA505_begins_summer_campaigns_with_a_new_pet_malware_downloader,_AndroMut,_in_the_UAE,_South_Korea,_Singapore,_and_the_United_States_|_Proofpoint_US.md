# Reference for threat actor for "TA505, Graceful Spider, Gold Evergreen"

**Title**: TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States | Proofpoint US

**Source**: https://www.proofpoint.com/us/threat-insight/post/ta505-begins-summer-campaigns-new-pet-malware-downloader-andromut-uae-south

## Content
































































TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States | Proofpoint US









      Skip to main content
    







Products
Solutions
Partners
Resources
Company











English (Americas)
English (Europe, Middle East, Africa)
English (Asia-Pacific)
Español
Deutsch
Français
Italiano
Português
日本語
한국어



Login

Support Log-in
Digital Risk Portal
Email Fraud Defense
ET Intelligence
Proofpoint Essentials
Sendmail Support Log-in


Contact






Aegis Threat Protection PlatformDisarm BEC, phishing, ransomware, supply chain threats and more.
Sigma Information Protection PlatformDefend your data from careless, compromised and malicious users.
Identity Threat Defense PlatformPrevent identity risks, detect lateral movement and remediate identity threats in real time.
Intelligent Compliance PlatformReduce risk, control costs and improve data visibility to ensure compliance.
Premium ServicesLeverage proactive expertise, operational continuity and deeper insights from our skilled experts.





Email Security and Protection
Email Protection
Email Fraud Defense
Secure Email Relay
Threat Response Auto-Pull
Sendmail Open Source
Essentials for Small Business

Advanced Threat Protection
Targeted Attack Protection in Email
Threat Response
Emerging Threats Intelligence

Security Awareness Training
Assess
Change Behavior
Evaluate


Information Protection
Enterprise Data Loss Prevention (DLP)
Insider Threat Management
Intelligent Classification and Protection
Endpoint Data Loss Prevention (DLP)
Email Data Loss Prevention (DLP)
Email Encryption
Data Discover

Cloud Security
Isolation
Cloud App Security Broker
Web Security


Identity Threat Detection and Response
Spotlight
Shadow


Compliance and Archiving
Automate
Capture
Patrol
Track
Archive
Discover
Supervision


Premium Services
Managed Email Threat Protection
Managed Information Protection
Managed Security Awareness
Managed Abuse Mailbox
Recurring Consultative Services
Technical Account Managers
Threat Intelligence Services
People-Centric Security Program






  New threat protection solution bundles with flexible deployment options 
  AI-powered protection against BEC, ransomware, phishing, supplier risk and more with inline+API or MX-based deployment
Learn More






Solutions by Topic


Combat Email and Cloud ThreatsProtect your people from email and cloud threats with an intelligent and holistic approach.
Change User BehaviorHelp your employees identify, resist and report attacks before the damage is done.
Combat Data Loss and Insider RiskPrevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats.
Modernize Compliance and ArchivingManage risk and data retention needs with a modern compliance and archiving solution.
Protect Cloud AppsKeep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk.


Prevent Loss from RansomwareLearn about this growing threat and stop attacks by securing today’s top ransomware vector: email.
Secure Microsoft 365Implement the very best security and compliance solution for your Microsoft 365 collaboration suite.
Defend Your Remote Workforce with Cloud EdgeSecure access to corporate resources and ensure business continuity for your remote workers.
Authenticate Your EmailProtect your email deliverability with DMARC.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.




Solutions by Industry

Federal Government
State and Local Government
Higher Education
Financial Services
Healthcare
Mobile Operators
Internet Service Providers
Small and Medium Businesses






Partner Programs


Channel PartnersBecome a channel partner. Deliver Proofpoint solutions to your customers and grow your business.
Archive Extraction PartnersLearn about Proofpoint Extraction Partners.
Global System Integrator (GSI) and Managed Service Provider (MSP) PartnersLearn about our global consulting and services partners that deliver fully managed and integrated solutions.


Technology and Alliance PartnersLearn about our relationships with industry-leading firms to help protect your people, data and brand.
Social Media Protection PartnersLearn about the technology and alliance partners in our Social Media Protection Partner program.
Proofpoint Essentials Partner ProgramsSmall Business Solutions for channel partners and MSPs.




Partner Tools

Become a Channel Partner
Channel Partner Portal








Resource LibraryFind the information you're looking for in our library of videos, data sheets, white papers and more.
BlogKeep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
PodcastsLearn about the human side of cybersecurity. Episodes feature insights from experts and executives.
New Perimeters MagazineGet the latest cybersecurity insights in your hands – featuring valuable knowledge from our own industry experts.


Threat GlossaryLearn about the latest security threats and how to protect your people, data, and brand.
EventsConnect with us at events to learn how to protect your people and data from ever‑evolving threats.
Customer StoriesRead how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
WebinarsBrowse our webinar library to learn about the latest threats, trends and issues in cybersecurity.




Security Hubs

Get free research and resources to help you protect against threats, build a security culture, and stop ransomware in its tracks.

Threat Hub
CISO Hub
Cybersecurity Awareness Hub
Ransomware Hub
Insider Threat Management Hub









About ProofpointProofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Why ProofpointToday’s cyber attacks target people. Learn about our unique people-centric approach to protection.
CareersStand out and make a difference at one of the world's leading cybersecurity companies.


News CenterRead the latest press releases, news stories and media highlights about Proofpoint.
Privacy and TrustLearn about how we handle data and make commitments to privacy and other regulations.
Environmental, Social, and GovernanceLearn about our people-centric principles and how we implement them to positively impact our global community.




Support

Access the full range of Proofpoint support services.
Learn More











 




BlogThreat Insight
                                    TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States
                              

 












TA505 begins summer campaigns with a new pet malware downloader, AndroMut, in the UAE, South Korea, Singapore, and the United States





Share with your network!








 July 02, 2019


                Matthew Mesa and Dennis Schwarz with the Proofpoint Threat Insight Team
  
        

 Overview
Throughout 2018, Proofpoint researchers observed threat actors increasingly distributing downloaders, backdoors, information stealers, remote access trojans (RATs), and more as they abandoned ransomware as their primary payload. In November 2018, TA505, a prolific actor that has been at the forefront of this trend, began distributing a new backdoor we named “ServHelper”. ServHelper has two variants: one focused on remote desktop functions and a second that primarily functioned as a downloader.
In June 2019, TA505 appears to have introduced yet another new downloader malware, AndroMut, which has some similarities in code and behavior to Andromeda, a long-established malware family. Proofpoint research has observed AndroMut download malware referred to as “FlawedAmmyy.” FlawedAmmyy is a full-featured RAT that was first observed in early 2016 and is based on the leaked source code of a legitimate shareware tool, Ammyy.
Also Read: Leaked Ammyy Admin Source Code Turned into Malware
Also Read: Andromeda Under the Microscope (Avast)
Campaign Analysis
Proofpoint researchers observed two distinct campaigns by TA505 that used AndroMut to download FlawedAmmyy.
The first campaign used the following message details to target recipients in South Korea:
Sender Name:
백승기
Subject:
쌍용 인보이스 1234
URLs
See IOCs
 
Sender Name:
최성은
Subject:
송금증 $123.12
Attachment Names:
20.06.2019 송금증 123.12.doc
20.06.2019 송금증 123.12.xls
20.06.2019 송금증 123.12.htm
20.06.2019 송금증 123.12.html
 
Sender Name:
"Kim, DongHoon (Dongtan_Con)"
Subject:
견적서
Attachment Names:
Cml-123456-1.xls
The HTM or HTML attachments contained links to the download of an Office file. Depending on the specific case, the delivered Word or Excel file used macros to execute a Msiexec command that would download and execute either the FlawedAmmyy loader or AndroMut. In the cases that involved AndroMut, Proofpoint researchers observed it downloading FlawedAmmyy.

Figure 1: Example TA505 email used to deliver AndroMut

Figure 2: Example TA505 document used to deliver AndroMut
The second campaign targeted recipients at financial institutions in Singapore, UAE, and the USA. The message lures used the following details:
Sender:
Mir Imran Medhi
Subject:
Invoice & DOs
Attachments Names:
invoice-5601.doc
invoice.xls
 
Sender Name:
Ong Kai Chin
Subject:
Profoma Invoice_1234
Attachments Names:
invoice-1234.doc
 
Sender Name:
Rejeesh Aj
Subject:
request for holding cheque
Attachments Names:
request.doc
Rq20061901.doc
Again, depending on the specific case, the delivered Word or Excel file used macros to execute a Msiexec command that would download and execute either the FlawedAmmyy loader or AndroMut. In the cases that involved AndroMut, we observed it downloading FlawedAmmyy.

Figure 3: Example TA505 email with attachments used to deliver AndroMut
AndroMut Malware Analysis
AndroMut is a new downloader malware written in C++ that Proofpoint researchers began observing in the wild in June 2019. The “Andro” part of the name comes from some of the pieces which bear resemblance to another downloader malware known as Andromeda [1] and “Mut” is based off a mutex that the analyzed sample creates: “mutshellmy777”.
Windows API Calls
The malware resolves most of its Windows API calls at runtime by hash. The hashing algorithm is called “ror13AddHash32Dll” by FireEye [2] and it rotates right (ROR) each character of the DLL and API name by 13 then adds them together. Some example API hashes are:
lstrcpyW - 0xE33D73B4
CreateMutexW - 0x95898DFF
socket - 0xED83E9BA
String Decryption
AndroMut decrypts strings in one of two ways:
The encrypted string is base64-decoded then decrypted with AES-256 in ECB mode. Each string has its own key and they look like 32-byte hex strings (Figure 4).

Figure 4: Example of Type 1 Encrypted Strings
The encrypted string is stored as a stack string. Each string decrypts by performing a unique math problem -- we were unable to observe any compelling patterns in the mathematics. Figure 5 shows an example of the string “cmd /C” being decrypted. An equivalent Python snippet of the code is available on Github [3].

Figure 5: Example of Type 2 Encrypted String
Anti-Analysis
In addition to Windows API hashing and string encryption, AndroMut uses the following anti-analysis techniques:
Checks for sandboxing by looking for the following process names:
	cmdvirth.exe (COMODO)
SbieSvc.exe (Sandboxie)
VMSrvc.exe (Virtual PC)
xenservice.exe (Xen)

Checks for mouse movement
Checks for the Wine emulator by looking for the “HKEY_CURRENT_USER\SOFTWARE\Wine” subkey in the Registry
Checks for debuggers by looking for debugging flags set in the NtGlobalFlag field of its Process Environment Block (PEB)
Checks for debuggers by setting a “Puleg” mutex, setting the HANDLE_FLAG_PROTECT_FROM_CLOSE flag on the mutex handle, then trying to close the handle
Explicitly zeroing memory after using important data
Persistence
Depending on user privileges the malware creates persistence by either scheduling a task that executes a created LNK file in the Recycle Bin or via the “Registry run” method.
Configuration
AndroMut contains five configuration pieces and stores them as type 1 encrypted strings:
Command and control (C&C) host
C&C port
C&C URI
Encryption key used in C&C
JSON key used in C&C
Command and Control
The URL is constructed from the configuration and C&C communication is established using HTTP POST requests. An example response to such a request is depicted in Figure 6:

Figure 6: Example C&C response
Request and response data are both JSON objects that contain the configured JSON key (in the analyzed sample, the key was “w”). The key values can be decrypted by hex-decoding and decrypting with AES-256 in ECB using the configured C&C key (in the analyzed sample, the key was “736769476A5162373558736B71703962”).
An example plaintext request looks like:
{
     "data": {
           "arch": true,
           "cmd": 1,
           "os": "Win7",
           "rights": true,
           "tid": "<16 uppercase hex digits>"
     }
}
It is a JSON object that contains a data key which contains the following keys:
tid - Bot ID
os - Windows version
arch - “true” indicates x64
rights - “true” indicates admin privileges
cmd - Command response code
An example plaintext response looks like:
{
     "status": "200",
     "wmjf": "rtjlafogqsebkxuy"
}
The “status” key maps to different commands. The rest of the keys are command-specific arguments. AndroMut is able to execute the following commands:
100 - Remove self and exit
200 - Initial beacon response. Argument is not used and appears to be random padding
300 - Base64 decodes the “data” value, saves it the %TEMP% directory using the “name” value, then executes it with the CreateProcessW Windows API. See below for an example:
{
     "data": "TVqQAAMA...",
     "name": "okbrjzxp.tmp",
     "size": "797048",
     "status": "300",
     "type": "application/x-msdownload"
}
Other "status" codes include:
301 - Similar to “300” command, but executes the file using “cmd[.]exe [/]C”
302 - Similar to “300” command, but executes the file using the LoadLibraryEx Windows API
303 - Update self
Payloads
At the time of publication Proofpoint researchers have only seen AndroMut deliver the FlawedAmmyy Remote Access Trojan (RAT) [4] in the above TA505 campaigns.
Similarity to Other Malware
While Proofpoint researchers believe that AndroMut is a new malware family, it is worth mentioning in passing that some of its analysis felt familiar. Proofpoint has observed some low-confidence overlaps between it and two other malware downloaders: Andromeda [1] and QtLoader [5] [6]. The research into the latter malware also noted some similarities to Andromeda.
Conclusion
TA505 has helped shape the threat landscape for years, largely because of the massive volumes associated with their campaigns through the end of 2017 and into 2018. Over the last two years, Proofpoint researchers have observed TA505 and a number of other actors focus on downloaders, RATs, information stealers, and banking Trojans. With this new June 2019 push, commercial banking verticals in the United States, UAE, and Singapore appear to be the primary targets as part of TA505’s usual “follow the money” behavioral pattern. The new AndroMut downloader, when combined with the FlawedAmmy RAT as its payload appears to be TA505’s new pet for the summer of 2019.
References
[1] https://malpedia.caad.fkie.fraunhofer.de/details/win.andromeda
[2] https://github.com/fireeye/flare-ida/tree/master/shellcode_hashes
[3] https://github.com/EmergingThreats/threatresearch/tree/master/andromut
[4] https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware
[5] https://malpedia.caad.fkie.fraunhofer.de/details/win.qtbot
[6] https://twitter.com/sysopfb/status/921396006431969280
Indicators of Compromise (IOCs)

IOC


IOC Type


Description


hxxp://greenthumbsup[.]jp/20.06.2019_746.38.doc


URL


TA505 Document


hxxp://fakers[.]co[.]jp/20.06.2019_130.22.doc


URL


TA505 Document


hxxp://nagomi-753[.]jp/20.06.2019_800.77.doc


URL


TA505 Document


hxxp://nanepashemet[.]com/20.06.2019_781.37.xls


URL


TA505 Excel File


52f0aaff3654110e82586d21b07c8a3de23dc9efb3f4001daf412286282315c0


SHA256


TA505 Document


d0aaf465a2569abbdcbafc049be1c1a643572f4ca185058833310435bfa53358


SHA256


TA505 Document


eb3792fc83cd65823bc466e7253caf12064826b058230666d2ed51542ac59275


SHA256


TA505 Excel File


f21039af47e7660bf8ef002dfcdb0c0f779210482ee1778ab7e7f51e8233e35c


SHA256


TA505 Document


3e3eb26211459eb2d8b52a2429a52e7e12d2145d7733823d7415663537a0b6ca


SHA256


TA505 HTML


8621fa54946096ed38aee5cbcc068c0620416a05c17328a527673e808847850d


SHA256


TA505 Excel File


c4963dcf6b32459740f6a3d3b4d06d9dc06f15087ca01775956df36206543301


SHA256


TA505 Document


a905838db6e6617edd9d25baaaaee9c209381d456e809081977e27c3e0b15793


SHA256


TA505 Document


59af9102a921130fd1d120f6cee7fc7cdfc28292a7a4a8c24233126604aa9443


SHA256


TA505 Document


98b584b31457b21d0d48fcc78093439638e15dd1705e54182d9aa4ffad014c3a


SHA256


TA505 Excel File


bb5054f0ec4e6980f65fb9329a0b5acec1ed936053c3ef0938b5fa02a9daf7ee


SHA256


AndroMut


hxxp://kreewalk[.com:80/viewforum.php


URL


C&C


5eddc55c0c445baf2752d56229fa384b7e3f1c7e76b22f43e389c6a711aa713a


SHA256


FlawedAmmyy

 
ET and ETPRO Suricata/Snort Signatures
2836975          ETPRO TROJAN AndroMut Checkin






Previous Blog Post


Next Blog Post







Subscribe to the Proofpoint Blog

























About


Overview
Why Proofpoint
Careers
Leadership Team
News Center
Nexus Platform
Privacy and Trust




Threat Center


Threat Hub
Cybersecurity Awareness Hub
Ransomware Hub
Threat Glossary
Threat Blog








Products


Email Security & Protection
Advanced Threat Protection
Security Awareness Training
Cloud Security
Archive & Compliance
Information Protection
Product Bundles




Resources


White Papers
Webinars
Data Sheets
Events
Customer Stories
Blog
Free Trial








Connect


+1-408-517-4710
Contact Us
Office Locations
Request a Demo




Support


Support Login
Support Services
IP Address Blocked?
















Facebook
Twitter
linkedin
Youtube





English (US)
English (UK)
English (AU)
Español
Deutsch
Français
Italiano
Português
日本語
한국어





© 2024. All rights reserved.
            Terms and conditions
Privacy Policy
Sitemap

 







 

















