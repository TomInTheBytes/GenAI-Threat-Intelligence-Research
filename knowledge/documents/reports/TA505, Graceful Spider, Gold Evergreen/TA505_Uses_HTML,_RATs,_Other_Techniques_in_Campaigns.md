# Reference for threat actor for "TA505, Graceful Spider, Gold Evergreen"

**Title**: TA505 Uses HTML, RATs, Other Techniques in Campaigns

**Source**: https://blog.trendmicro.com/trendlabs-security-intelligence/shifting-tactics-breaking-down-ta505-groups-use-of-html-rats-and-other-techniques-in-latest-campaigns/

## Content























TA505 Uses HTML, RATs, Other Techniques in Campaigns



































Business



search
close










Solutions



By Challenge





By Challenge





By Challenge
Learn more








Understand, Prioritize & Mitigate Risks





Understand, Prioritize & Mitigate Risks
Improve your risk posture with attack surface management
Learn more








Protect Cloud-Native Apps





Protect Cloud-Native Apps
Security that enables business outcomes
Learn more








Protect Your Hybrid World





Protect Your Hybrid, Multi-Cloud World
Gain visibility and meet business needs with security
Learn more








Securing Your Borderless Workforce





Securing Your Borderless Workforce
Connect with confidence from anywhere, on any device
Learn more








Eliminate Network Blind Spots





Eliminate Network Blind Spots
Secure users and key operations throughout your environment
Learn more








See More. Respond Faster.





See More. Respond Faster.
Move faster than your adversaries with powerful purpose-built XDR, attack surface risk management, and zero trust capabilities
Learn more








Extend Your Team





Extend Your Team. Respond to Threats Agilely
Maximize effectiveness with proactive risk reduction and managed services
Learn more








Operationalizing Zero Trust





Operationalizing Zero Trust
Understand your attack surface, assess your risk in real time, and adjust policies across network, workloads, and devices from a single console
Learn more










By Role





By Role





By Role
Learn more








CISO





CISO
Drive business value with measurable cybersecurity outcomes
Learn more








SOC Manager





SOC Manager
See more, act faster
Learn more








Infrastructure Manager





Infrastructure Manager
Evolve your security to mitigate threats quickly and effectively
Learn more








Cloud Builder and Developer





Cloud Builder and Developer
Ensure code runs only as intended
Learn more








Cloud Security Ops





Cloud Security Ops
Gain visibility and control with security designed for cloud environments
Learn more










By Industry





By Industry





By Industry
Learn more








Healthcare





Healthcare
Protect patient data, devices, and networks while meeting regulations
Learn more








Manufacturing





Manufacturing
Protecting your factory environments – from traditional devices to state-of-the-art infrastructures
Learn more








Oil & Gas





Oil & Gas
ICS/OT Security for the oil and gas utility industry
Learn more








Electric Utility





Electric Utility
ICS/OT Security for the electric utility
Learn more








Federal





Federal
Learn more








Automotive





Automotive
Learn more








5G Networks





5G Networks
Learn more










Small & Midsized Business Security





Small & Midsized Business Security
Stop threats with comprehensive, set-it-and-forget-it protection
Learn more










Platform



Vision One Platform





Vision One Platform





Trend Vision One
Our Unified Platform
Bridge threat protection and cyber risk management
Learn more









AI Companion





Trend Vision One Companion
Your generative AI cybersecurity assistant
Learn more










Attack Surface Management





Attack Surface Management
Stop breaches before they happen
Learn more









XDR (Extended Detection & Response)





XDR (Extended Detection & Response)
Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform
Learn more









Cloud Security





Cloud Security





Trend Vision One™
Cloud Security Overview
The most trusted cloud security platform for developers, security teams, and businesses
Learn more








Attack Surface Risk Management for Cloud





Attack Surface Risk Management for Cloud
Cloud asset discovery, vulnerability prioritization, Cloud Security Posture Management, and Attack Surface Management all in one
Learn more








XDR for Cloud





XDR for Cloud
Extend visibility to the cloud and streamline SOC investigations
Learn more









Workload Security





Workload Security
Secure your data center, cloud, and containers without compromising performance by leveraging a cloud security platform with CNAPP capabilities
Learn more









Container Security





Container Security
Simplify security for your cloud-native applications with advanced container image scanning, policy-based admission control, and container runtime protection
Learn more









File Storage Security





File Storage Security
Security for cloud file/object storage services leveraging cloud-native application architectures
Learn more











Endpoint Security





Endpoint Security





Endpoint Security Overview
Defend the endpoint through every stage of an attack
Learn more








XDR for Endpoint





XDR for Endpoint
Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform
Learn more









Workload Security





Workload Security
Optimized prevention, detection, and response for endpoints, servers, and cloud workloads
Learn more








Industrial Endpoint Security





Industrial Endpoint Security
Learn more








Mobile Security





Mobile Security
On-premises and cloud protection against malware, malicious applications, and other mobile threats
Learn more











Network Security





Network Security





Network Security Overview
Expand the power of XDR with network detection and response
Learn more








XDR for Network





XDR for Network
Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform
Learn more









Network Intrusion Prevention (IPS)





Network Intrusion Prevention (IPS)
Protect against known, unknown, and undisclosed vulnerabilities in your network
Learn more








Breach Detection System (BDS)





Breach Detection System (BDS)
Detect and respond to targeted attacks moving inbound, outbound, and laterally
Learn more








Secure Service Edge (SSE)





Secure Service Edge (SSE)
Redefine trust and secure digital transformation with continuous risk assessments
Learn more









Industrial Network Security





Industrial Network Security
Learn more








5G Network Security





5G Network Security
Learn more










Email Security





Email Security





Email Security
Stop phishing, malware, ransomware, fraud, and targeted attacks from infiltrating your enterprise
Learn more








Email and Collaboration Security





Trend Vision One™
Email and Collaboration Security
Stop phishing, ransomware, and targeted attacks on any email service including Microsoft 365 and Google Workspace
Learn more











OT Security





OT Security





OT Security
Learn about solutions for ICS / OT security.
Learn more








XDR for OT





XDR for OT
Stop adversaries faster with a broader perspective and better context to hunt, detect, investigate, and respond to threats from a single platform
Learn more









Industrial Network Security





Industrial Network Security
Industrial Network Security








Industrial Endpoint Security





Industrial Endpoint Security
Learn more










Threat Intelligence





Threat Intelligence
Keep ahead of the latest threats and protect your critical data with ongoing threat prevention and analysis
Learn more








All Products, Services, and Trials





All Products, Services, and Trials
Learn more











Research



Research





Research





Research
Learn more








Research, News, and Perspectives





Research, News, and Perspectives
Learn more








Research and Analysis





Research and Analysis
Learn more








Security News





Security News
Learn more








Zero Day Initiatives (ZDI)





Zero Day Initiatives (ZDI)
Learn more












Services



Our Services





Our Services





Our Services
Learn more








Service Packages





Service Packages
Augment security teams with 24/7/365 managed detection, response, and support
Learn more








Managed XDR





Managed XDR
Augment threat detection with expertly managed detection and response (MDR) for email, endpoints, servers, cloud workloads, and networks
Learn more








Incident Response





Incident Response





Incident Response
Our trusted experts are on call whether you're experiencing a breach or looking to proactively improve your IR plans
Learn more








Insurance Carriers and Law Firms





Insurance Carriers and Law Firms
Stop breaches with the best response and detection technology on the market and reduce clients’ downtime and claim costs
Learn more










Support Services





Support Services
Learn more












Partners



Partner Program





Partner Program





Partner Program Overview
Grow your business and protect your customers with the best-in-class complete, multilayered security
Learn more








Managed Security Service Provider





Managed Security Service Provider
Deliver modern security operations services with our industry-leading XDR
Learn more








Managed Service Provider





Managed Service Provider
Partner with a leading expert in cybersecurity, leverage proven solutions designed for MSPs
Learn more








Cloud Service Provider





Cloud Service Provider
Add market-leading security to your cloud service offerings – no matter which platform you use
Learn more








Professional Services





Professional Services
Increase revenue with industry-leading security
Learn more








Resellers





Resellers
Discover the possibilities
Learn more








Marketplace





Marketplace
Learn more








System Integrators





System Integrators
Learn more










Alliance Partners





Alliance Partners





Alliance Overview
We work with the best to help you optimize performance and value
Learn more








Technology Alliance Partners





Technology Alliance Partners
Learn more








Our Alliance Partners





Our Alliance Partners
Learn more










Partner Tools





Partner Tools





Partner Tools
Learn more








Partner Login





Partner Login
Login








Education and Certification





Education and Certification
Learn more








Partner Successes





Partner Successes
Learn more








Distributors





Distributors
Learn more








Find a Partner





Find a Partner
Learn more












Company



Why Trend Micro





Why Trend Micro





Why Trend Micro
Learn more








Customer Success Stories





Customer Success Stories
Learn more








The Human Connection





The Human Connection
Learn more








Industry Accolades





Industry Accolades
Learn more








Strategic Alliances





Strategic Alliances
Learn more








Compare Trend Micro





Compare Trend Micro
Learn more










About Us





About Us





About Us
Learn more








Trust Center





Trust Center
Learn more








History





History
Learn more








Diversity, Equity and Inclusion





Diversity, Equity and Inclusion
Learn more








Corporate Social Responsibility





Corporate Social Responsibility
Learn more








Leadership





Leadership
Learn more








Security Experts





Security Experts
Learn more








Internet Safety and Cybersecurity Education





Internet Safety and Cybersecurity Education
Learn more








Legal





Legal
Learn more








Investors





Investors
Learn more








Formula E Racing





Formula E Racing
Learn more










Latest News





Latest News





Latest News
Learn more








Newsroom





Newsroom
Learn more








Events





Events
Learn more








Careers





Careers
Learn more








Webinars





Webinars
Learn more














Back





Back





Back





Back







		Free Trials
	



		Contact Us
	






Looking for home solutions?

Under Attack?




2 Alerts





Back




Unread
All








Webinar: The SmartScreen Vulnerability

close



The facts, and why our customers are safe  >






Webinar: The SmartScreen Vulnerability

close



In-depth insights and protection strategies  >










Support




			Business Support Portal
		



			Business Community
		



			Virus and Threat Help
		



			Education and Certification
		



			Contact Support
		



			Find a Support Partner
		





Resources




			Cyber Risk Index/Assessment
		



			CISO Resource Center
		



			DevOps Resource Center
		



			What Is?
		



			Threat Encyclopedia
		



			Cloud Health Assessment
		



			Cyber Insurance
		



			Glossary of Terms
		



			Webinars
		





Log In




			Support
		



			Partner Portal
		



			Cloud One
		



			Product Activation and Management
		



			Referral Affililate
		







Back











arrow_back

search













close






Content has been added to your Folio


				Go to Folio (0)
			
close











APT & Targeted Attacks
TA505 Uses HTML, RATs, Other Techniques in Campaigns
In TA505 group's latest campaign, they started using HTML attachments to deliver malicious .XLS files that lead to downloader and backdoor FlawedAmmyy, mostly to target users in South Korea.
By: Hara Hiroaki, Loseway Lu
		
			June 12, 2019
Read time:  ( words)
	















Save to Folio






 Subscribe












TA505 is a prolific cybercriminal group known for its attacks against multiple financial institutions and retail companies using malicious spam campaigns and different malware. We have been following TA505 closely and detected various related activities for the past two months. In the group's latest campaign, they started using HTML attachments to deliver malicious .XLS files that lead to downloader and backdoor FlawedAmmyy, mostly to target users in South Korea.

Figure 1. TA505’s latest infection chain
This blog post covers three main points involving TA505: their recent activity in specific regions, shifting tactics and payloads, and suspicious activity possibly associated with the group. We also touch on the latest TA505 developments, including an email stealer, their use of legitimate software and MSI Installer, and more.
Recent activity in Latin America and East Asia
As previously mentioned, TA505, first named by Proofpoint, is known for targeting financial enterprises. Since last December, TA505 has been very active and has been using legitimate or compromised RATs (remote access trojans) such as FlawedAmmyy, FlawedGrace, and Remote Manipulator System (RMS).
While monitoring their activities, we found that the group is still updating their tactics, techniques, and procedures (TTPs). In April, TA505 targeted Latin American countries Chile and Mexico, and even Italy using either FlawedAmmyy RAT or RMS RAT as payload. By the end of April, we learned that the group started to go after targets in East Asian countries such as China, South Korea, and Taiwan using FlawedAmmyy RAT as its payload.
TA505 has also recently used LOLbins and legitimate Windows OS processes to perform malicious activities and deliver a payload without being detected. As the entry point of an attack, it delivers a sophisticated email containing a malicious Excel or Word file. The group notably abuses Excel 4.0 macro — a particularly old macro likely used to evade typical macro detection.

Figure 2. Korean language (left), simplified Chinese language (right) Microsoft Office instructions on how to enable macro

Figure 3. Excel 4.0 macro
This said macro executes a command to download the first stage payload using msiexec.exe, a Microsoft Installer tool that can download and run a Windows Installer file. The first stage payload is an MSI Installer that was created using an EXE to MSI converter.

Figure 4. MSI Installer payload that used EXE to MSI converter
The actual malicious payload is in the MSI Installer package. The payload can vary in each campaign, but it typically uses the FlawedAmmyy downloader, ServHelper, or RMS RAT launcher.
Payload as FlawedAmmyy downloader
The MSI Installer itself contains a FlawedAmmyy downloader, which is always signed.

Figure 5. FlawedAmmyy downloader

Figure 6. Digitally signed FlawedAmmyy downloader
The downloader will check if the infected machine is running in the Active Directory (AD) network. It then runs the “net group /domain” command and checks if “workgroup” is contained in the output result. (If it does not exist, it means that the PC is running in AD.) After performing the check, it downloads the RC4-encrypted FlawedAmmyy RAT, decrypts it, and executes it as the final payload.
We recently observed an instance where the FlawedAmmyy downloader was not digitally signed (FlawedAmmyy RAT payload is still signed, however). It could be a blip — perhaps a one-off — but it's still notable.
Payload as ServHelper
ServHelper is classified as a backdoor, but it can also work as a downloader for FlawedGrace. If the MSI Installer package contains ServHelper as a payload, it will come with an NSIS (Nullsoft Scriptable Install System) installer.

Figure 7. NSIS Installer
NSIS is a legitimate tool that manages the installation for Windows, but some hacking groups also abuse it. TA505, for instance, abuses NSIS to install ServHelper. This NSIS installer has two files: (nsExec.dll and repotaj.dll) and [NSIS].nsi. The latter is a configuration file that handles files to install.

Figure 8. NSIS Installer sections
In this case, repotaj.dll, which is ServHelper, will be extracted to %TEMP% and execute with the “feast” parameter as its export function. Once ServHelper is executed, it runs a PowerShell script to get information from the infected machine.
Payload as RMS RAT
TA505 also uses RMS, a legitimate RAT, in their campaigns. If the MSI Installer package contains RMS RAT as its payload, it will include a self-extracting RAR.

Figure 9. SFXRAR
This SFXRAR extracts three files to %TEMP% and executes one of the files, where exit.exe is a launcher for i.cmd; i.cmd renames kernel.dll to uninstall.exe, then executes it with parameters.

Figure 10. Three files extracted from SFXRAR

Figure 11. Executed parameters
As indicated in the parameter above, kernel.dll/uninstall.exe is also SFXRAR, but password-protected. It will extract the following files (Figure 12) and execute exit.exe, where the said executable is also a launcher of i.cmd that registers winserv.exe (the actual RMS RAT) and executes it. The password used to extract from the RAR file will be passed by the parameter “-p”, which is set in i.cmd.

Figure 12. Extracted files

Figure 13. RMS RAT is added to the startup registry and executed
Updates on TA505's tactics, techniques and procedures
Since the tail end of April through early June, we observed TA505 changing its tactics, techniques, and procedures (TTPs) in a variety of ways. The following is a quick rundown of the group's varying methods.
Using Amadey to distribute EmailStealer
On April 24, we detected an attack that used Amadey as its first stage payload. Amadey is a known downloader for another payload (FlawedAmmyy downloader) and EmailStealer, which steals email accounts or SMTP credentials from infected PCs.
In this particular attack, we discovered that the C&C server of EmailStealer had an open directory, allowing us to view the information that EmailStealer stole. We presume the information, primarily comprised of lists of email addresses, will be used in future attacks.
Using VBA macro
TA505 has been using Excel 4.0 macro for a while, but we recently observed the group using the usual VBA (Visual Basic for Applications) macro along with Excel 4.0 macro. However, they still hide the command and malicious URL in “UserForm” and not in VBA code.

Figure 14. Malicious command and URL hidden in UserForm
Avoiding the use of msiexec.exe
As previously mentioned, TA505 abuses msiexec.exe to install its first stage payload, but we recently observed the group just directly downloading the first stage payload binary and executing it. Like the VBA macro code, the group just executes the downloaded file 234.exe by cmd.exe. This is possibly because endpoint security solutions easily detect msiexec.exe.
Using HTML as an attack entry point
TA505 has been using Excel file, Word document, or .WIZ files as its attack entry point. However, as mentioned earlier, the group has also started to attach an HTML link in emails to trick users into opening the Excel file.

Figure 15. Attached HTML
Opening this HTML link will redirect the user to a malicious URL that hosts the malicious Excel file. The Excel file still has the same style of VBA macro, which was described in the previous section. This could mean that the group is trying to change the entry point's file type to bypass macro detection.
In early June, for instance, we saw HTML in emails that used a friendly tone so recipients would download the Excel file. Some recent cases we observed even had the Excel file directly attached to the emails.

Figure 16. HTML shows a message before Excel download (Translation from Korean: Downloading ... ... will be taken to the download page after a while .... If you wait a while and continue to see this message, please click on <a href="<MALICIOUS_URL>"> link </a>! Thank you.)
Suspicious activity involving TA505
While analyzing TA505's activities, we encountered strange attacks that were very similar to TA505’s TTPs but with some differences. This section discusses a particular attack that, like the usual TA505 attack, distributes RMS RAT via Excel and SFXRAR. But it also contains Kronos, a known banking trojan; and SmokeLoader, which is another payload downloader. While the attack shows characteristics that are similar those of TA505's attacks, we suspect that this could be a forged attack. As for the reason why we are dubious about this attack, another report has also since surfaced discussing that some threat actor was using similar tools to TA505’s.
In this attack, the basic TTPs and tools used seem similar, but we found five interesting points that set them apart:
Using .rar or .zip as attachment
The TA505 group usually attaches a malicious file without any compression. But this attack sent an email with a .rar or .zip attachment. However, this may not be a significant difference.
Using a similar image on Excel but with different macro and attribution
The following image on Excel appears similar to the one TA505 has been using.

Figure 17. Display on Excel for this suspicious attack
But there are a few differences in this Excel file. For one thing, it has a different style of VBA macro. TA505 has been using Excel 4.0 macro and VBA macro without heavy obfuscation, but this particular Excel file was heavily obfuscated and had a different style.

Figure 18. VBA macro with heavy obfuscation
Another factor is its different codepage. Malicious Excel files that TA505 distributed had information harvesting capabilities. For example, the codepage of Excel has always been “1251” Cyrillic (Windows), but the code page of this particular attack was “1252” Western European (Windows).

Figure 19. Information of Excel file used in this suspicious attack

Figure 20. Information of the usual Excel file distributed by TA505
Lacking the use of fast flux infrastructure
TA505 uses fast flux, a DNS technique used to mask botnets by quickly shifting among compromised hosts, which allows cybercriminals to delay or evade detection. The domains the group has been using to distribute payloads were usually resolved across a lot of IPs.
But in this attack, the domains used to distribute the payload only had one IP. It should be noted, however, that TA505 may have used different infrastructure for this instance, or another attacker may have performed malicious activities under the guise of TA505.
Using Kronos and SmokeLoader (v2019)
TA505 previously used Amadey to distribute the FlawedAmmyy downloader before, so the use of Kronos and SmokeLoader can’t be considered strong evidence of false attribution.
Using a different infrastructure to distribute spam
The strongest evidence that this attack might not come from TA505 is that this attack operator used a different spam infrastructure. Our daily monitoring of TA505's activities show that the group sends spam from specific IPs; this suspicious attack used different sender IPs. We couldn’t find any of the IPs used in previous attacks.
We can’t say for sure if this particular attack comes from TA505, another threat actor, an imitator, or perhaps just TA505 using another infrastructure. This reiterates the tricky business of attribution in cybersecurity, which calls for careful inspection. While it's easy to attribute similar incidents to certain threat actors, groups, or even countries, attribution should ultimately be based on technically provable information. After all, attributions can be used to operationalize appropriate incident response and remediation.
Defending against TA505's malicious activities
TA505 has been responsible for many large-scale attacks since at least 2014, using malicious email campaigns to distribute various banking trojans, ransomware, RATs, and backdoors. They had also targeted retail brands and even different financial companies across the world. TA505 has been focused on delivering downloaders, information stealers, and other malware — threats that can remain in affected systems if not prevented or remediated. With the group's use of email as an entry point for malicious activities, the threat has become more serious for unwitting users and organizations. Here are some best practices:

Regularly update systems and applications.
Incorporate multilayered security mechanisms such as firewalls and intrusion detection and prevention systems.
For system administrators, secure the email gateway to prevent it from becoming an attack entry point and proactively monitor possible attack vectors.

To defend against spam and threats from the TA505 group, businesses can consider Trend Micro™ endpoint solutions such as Trend Micro Smart Protection Suites and Worry-Free™ Business Security. Both solutions can protect users and businesses from threats by detecting malicious files and spammed messages as well as blocking all related malicious URLs. Trend Micro Deep Discovery™ has an email inspection layer that can protect enterprises by detecting malicious attachments and URLs.
Trend Micro™ Hosted Email Security is a no-maintenance cloud solution that delivers continuously updated protection to stop spam, malware, spear phishing, ransomware, and advanced targeted attacks before they reach the network. It protects Microsoft Exchange, Microsoft Office 365, Google Apps, and other hosted and on-premises email solutions.
The list of indicators of compromise (IoCs) related to this threat can be found in this appendix.







Tags

Malware
|
APT & Targeted Attacks
|
Endpoints
|
Research





	
		Authors
	





Hara Hiroaki
Customer Technology Specialist




Loseway Lu
Threat Researcher





		Contact Us
	



		Subscribe
	






Related Articles



					CVE-2024-21412: Water Hydra Targets Traders With Microsoft Defender SmartScreen Zero-Day
				



					SmartScreen Vulnerability: CVE-2024-21412 Facts and Fixes
				



					Global Cybersecurity Trends: AI, Geopolitical Risks, and Zero Trust
				






				See all articles
			




























Try our services free for 30 days






		Start your free trial today
	






















































Resources

Blog
Newsroom
Threat Reports
DevOps Resource Center
CISO Resource Center
Find a Partner






Support

Business Support Portal
Contact Us
Downloads
Free Trials








About Trend

About Us
Careers
Locations
Upcoming Events
Trust Center














Select a country / region




			expand_more


close

The Americas


United States


Brasil


Canada


México




Middle East & Africa


South Africa


Middle East and North Africa




Europe


België (Belgium)


Česká Republika


Danmark


Deutschland, Österreich Schweiz


España


France


Ireland


Italia


Nederland


Norge (Norway)


Polska (Poland)


Suomi (Finland)


Sverige (Sweden)


Türkiye (Turkey)


United Kingdom




Asia & Pacific


Australia


Центральная Азия (Central Asia)


Hong Kong (English)


香港 (中文) (Hong Kong) 


भारत गणराज्य (India)


Indonesia


日本 (Japan)


대한민국 (South Korea)


Malaysia


Монголия (Mongolia) and рузия (Georgia)


New Zealand


Philippines


Singapore


台灣 (Taiwan)


 ประเทศไทย (Thailand)


Việt Nam

















Privacy | Legal | Accessibility | Site map





Copyright ©2024 Trend Micro Incorporated. All rights reserved

























sXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk






